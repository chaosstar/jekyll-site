arrows(c(x), c(y), c(x+dt*z1/((lens2)+.1)), c(y+dt*z2/((lens2)+.1)),length=.04, col=col);
lens
lens2 <- lens/max(lens, na.rm=TRUE);
lens2
dt
maxx <- max(abs(z1));
maxy <- max(abs(z2));
maxx
x <- matrix(seq(xlims[1],xlims[2], length=resol), byrow=T, resol,resol);
y <- matrix(seq(ylims[1],ylims[2], length=resol),byrow=F, resol, resol);
x
y
npts <- resol*resol;
xspace <- abs(diff(xlims))/(resol*5);
yspace <- abs(diff(ylims))/(resol*5);
npts
xspace <- abs(diff(xlims))/(resol*5);
yspace <- abs(diff(ylims))/(resol*5);
xspace
yspace
z <- fun(x,y);
z1 <- matrix(z[1:npts], resol, resol);
z1
z2 <- matrix(z[(npts+1):(2*npts)], resol, resol);
z2
maxx <- max(abs(z1));
maxx
maxy
dt <- min( abs(diff(xlims))/maxx, abs(diff(ylims))/maxy)/resol;
dt
lens <- sqrt(z1^2 + z2^2);
lens2 <- lens/max(lens, na.rm=TRUE);
arrows(c(x), c(y), c(x+dt*z1/((lens2)+.1)), c(y+dt*z2/((lens2)+.1)),length=.04, col=col);
source('~/code/ARE277/pplane.r')
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=0.125, K=20, q=0.25, a=0.5),c(0,25),c(0,30),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=0.125, K=20, q=0.25, a=0.5),c(0,25),c(0,30),20, add=TRUE)
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=0.125, K=20, q=0.25, a=0.5),c(0,25),c(0,30),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=0.125, K=20, q=0.25, a=0.5),c(0,25),c(0,30),10, add=TRUE)
fun <- fishsys(c=2, O=1, p=4, r=1.1, d=0.125, K=20, q=0.25, a=0.5)
x <- matrix(seq(xlims[1],xlims[2], length=resol), byrow=T, resol,resol);
y <- matrix(seq(ylims[1],ylims[2], length=resol),byrow=F, resol, resol);
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=0.125, K=20, q=0.25, a=0.5),c(0,25),c(0,30),20, add=TRUE)
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=0.125, K=20, q=0.25, a=0.5),c(0,25),c(0,30),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=0.125, K=20, q=0.25, a=0.5),c(0,25),c(0,30),20, add=TRUE)
x <- matrix(seq(xlims[1],xlims[2], length=resol), byrow=T, resol,resol);
y <- matrix(seq(ylims[1],ylims[2], length=resol),byrow=F, resol, resol);
npts <- resol*resol;
xspace <- abs(diff(xlims))/(resol*5);
yspace <- abs(diff(ylims))/(resol*5);
x <- x + matrix(runif(npts, -xspace, xspace),resol,resol);
y <- y + matrix(runif(npts, -yspace, yspace),resol,resol);
z <- fun(x,y);
z1 <- matrix(z[1:npts], resol, resol);
z2 <- matrix(z[(npts+1):(2*npts)], resol, resol);
maxx <- max(abs(z1));
maxy <- max(abs(z2));
dt <- min( abs(diff(xlims))/maxx, abs(diff(ylims))/maxy)/resol;
lens <- sqrt(z1^2 + z2^2);
lens2 <- lens/max(lens, na.rm=TRUE);
arrows(c(x), c(y), c(x+dt*z1/((lens2)+.1)), c(y+dt*z2/((lens2)+.1)),length=.04, col=col);
}
maxx
z1
z2 <- matrix(z[(npts+1):(2*npts)], resol, resol);
maxx <- max(abs(z1), na.rm=TRUE);
maxy <- max(abs(z2), na.rm=TRUE);
dt <- min( abs(diff(xlims))/maxx, abs(diff(ylims))/maxy)/resol;
dt
lens <- sqrt(z1^2 + z2^2);
lens2 <- lens/max(lens, na.rm=TRUE);
arrows(c(x), c(y), c(x+dt*z1/((lens2)+.1)), c(y+dt*z2/((lens2)+.1)),length=.04, col=col);
phasearrows <- function(fun,xlims,ylims,resol=20, col='grey', add=F) {
if (add==F) {
plot(1,xlim=xlims, ylim=ylims, type='n');
}
x <- matrix(seq(xlims[1],xlims[2], length=resol), byrow=T, resol,resol);
y <- matrix(seq(ylims[1],ylims[2], length=resol),byrow=F, resol, resol);
npts <- resol*resol;
xspace <- abs(diff(xlims))/(resol*5);
yspace <- abs(diff(ylims))/(resol*5);
x <- x + matrix(runif(npts, -xspace, xspace),resol,resol);
y <- y + matrix(runif(npts, -yspace, yspace),resol,resol);
z <- fun(x,y);
z1 <- matrix(z[1:npts], resol, resol);
z2 <- matrix(z[(npts+1):(2*npts)], resol, resol);
maxx <- max(abs(z1), na.rm=TRUE);
maxy <- max(abs(z2), na.rm=TRUE);
dt <- min( abs(diff(xlims))/maxx, abs(diff(ylims))/maxy)/resol;
lens <- sqrt(z1^2 + z2^2);
lens2 <- lens/max(lens, na.rm=TRUE);
arrows(c(x), c(y), c(x+dt*z1/((lens2)+.1)), c(y+dt*z2/((lens2)+.1)),length=.04, col=col);
}
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=0.125, K=20, q=0.25, a=0.5),c(0,25),c(0,30),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=0.125, K=20, q=0.25, a=0.5),c(0,25),c(0,30),20, add=TRUE)
phasearrows <- function(fun,xlims,ylims,resol=20, col='grey30', add=F) {
if (add==F) {
plot(1,xlim=xlims, ylim=ylims, type='n');
}
x <- matrix(seq(xlims[1],xlims[2], length=resol), byrow=T, resol,resol);
y <- matrix(seq(ylims[1],ylims[2], length=resol),byrow=F, resol, resol);
npts <- resol*resol;
xspace <- abs(diff(xlims))/(resol*5);
yspace <- abs(diff(ylims))/(resol*5);
x <- x + matrix(runif(npts, -xspace, xspace),resol,resol);
y <- y + matrix(runif(npts, -yspace, yspace),resol,resol);
z <- fun(x,y);
z1 <- matrix(z[1:npts], resol, resol);
z2 <- matrix(z[(npts+1):(2*npts)], resol, resol);
maxx <- max(abs(z1), na.rm=TRUE);
maxy <- max(abs(z2), na.rm=TRUE);
dt <- min( abs(diff(xlims))/maxx, abs(diff(ylims))/maxy)/resol;
lens <- sqrt(z1^2 + z2^2);
lens2 <- lens/max(lens, na.rm=TRUE);
arrows(c(x), c(y), c(x+dt*z1/((lens2)+.1)), c(y+dt*z2/((lens2)+.1)),length=.04, col=col);
}
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=0.125, K=20, q=0.25, a=0.5),c(0,25),c(0,30),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=0.125, K=20, q=0.25, a=0.5),c(0,25),c(0,30),20, add=TRUE)
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=0.125, K=20, q=0.25, a=0.5),c(0,25),c(0,10),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=0.125, K=20, q=0.25, a=0.5),c(0,25),c(0,10),20, add=TRUE)
draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=0.125, K=20, q=0.25, a=0.5), tEnd=200, tCut=1000, loc.num=4)
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=0.125, K=20, q=0.25, a=0.5), tEnd=200, tCut=1000, loc.num=4)
str(traj)
plot(traj[[1]]$time, traj[[1]]$y)
?locator
# modification of phasetraj() in pplane.r
draw.traj <- function(func, Pars, tStart=0, tEnd=1, tCut=10, loc.num=1, color = "red") {
traj <- list()
print(paste("Click", loc.num, "initial values"))
x0 <- locator(loc.num, "p", pch=16, col="red")
for (i in 1:loc.num) {
out <- as.data.frame(ode(func=func, y=c(x=x0$x[i], y=x0$y[i]), parms=Pars, times = seq(tStart, tEnd, length = tCut)))
lines(out$x, out$y, col = color)
traj[[i]] <- out
}
return(traj)
}
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=0.125, K=20, q=0.25, a=0.5),c(0,25),c(0,10),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=0.125, K=20, q=0.25, a=0.5),c(0,25),c(0,10),20, add=TRUE)
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=0.125, K=20, q=0.25, a=0.5), tEnd=200, tCut=1000, loc.num=4)
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=0.0005, K=20, q=0.25, a=0.5),c(0,25),c(0,10),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=0.0005, K=20, q=0.25, a=0.5),c(0,25),c(0,10),20, add=TRUE)
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=0.0005, K=20, q=0.25, a=0.5), tEnd=200, tCut=1000, loc.num=4)
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=0.0005, K=20, q=0.25, a=0.5),c(0,25),c(0,10),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=0.0005, K=20, q=0.25, a=0.5),c(0,25),c(0,10),20, add=TRUE)
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=0.0005, K=20, q=0.25, a=0.5), tEnd=1000, tCut=1000, loc.num=4)
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=0.0005, K=20, q=0.25, a=0.5),c(0,25),c(0,10),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=0.0005, K=20, q=0.25, a=0.5),c(0,25),c(0,10),20, add=TRUE)
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=0.0005, K=20, q=0.25, a=0.5), tEnd=1000, tCut=1000, loc.num=4)
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=0.0005, K=20, q=0.25, a=2),c(0,25),c(0,10),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=0.0005, K=20, q=0.25, a=2),c(0,25),c(0,10),20, add=TRUE)
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=0.0005, K=20, q=0.25, a=2), tEnd=1000, tCut=1000, loc.num=4)
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=0.0005, K=20, q=0.25, a=2),c(0,25),c(0,30),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=0.0005, K=20, q=0.25, a=2),c(0,25),c(0,30),20, add=TRUE)
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=0.0005, K=20, q=0.25, a=2),c(0,25),c(0,30),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=0.0005, K=20, q=0.25, a=2),c(0,25),c(0,30),20, add=TRUE)
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=0.0005, K=20, q=0.25, a=2), tEnd=1000, tCut=1000, loc.num=4)
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),20, add=TRUE)
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2), tEnd=1000, tCut=1000, loc.num=4)
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=.1, K=20, q=0.25, a=2),c(0,25),c(0,30),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=.1, K=20, q=0.25, a=2),c(0,25),c(0,30),20, add=TRUE)
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=.1, K=20, q=0.25, a=2), tEnd=1000, tCut=1000, loc.num=4)
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=.1, K=20, q=0.25, a=2),c(0,25),c(0,30),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=.1, K=20, q=0.25, a=2),c(0,25),c(0,30),20, add=TRUE)
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=.1, K=20, q=0.25, a=2), tEnd=100, tCut=1000, loc.num=4)
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),20, add=TRUE)
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2), tEnd=100, tCut=1000, loc.num=4)
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),20, add=TRUE)
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2), tEnd=10, tCut=1000, loc.num=4)
draw.traj <- function(func, Pars, tStart=0, tEnd=1, tCut=10, loc.num=1, color = "red") {
traj <- list()
print(paste("Click", loc.num, "initial values"))
x0 <- locator(loc.num, "p", pch=16, col="red")
for (i in 1:loc.num) {
x0 <- locator(1, "p", pch=16, col="red")
out <- as.data.frame(ode(func=func, y=c(x=x0$x, y=x0$y), parms=Pars, times = seq(tStart, tEnd, length = tCut)))
lines(out$x, out$y, col = color)
traj[[i]] <- out
}
return(traj)
}
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),20, add=TRUE)
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2), tEnd=10, tCut=1000, loc.num=4)
draw.traj <- function(func, Pars, tStart=0, tEnd=1, tCut=10, loc.num=1, color = "red") {
traj <- list()
print(paste("Click", loc.num, "initial values"))
for (i in 1:loc.num) {
x0 <- locator(1, "p", pch=16, col="red")
out <- as.data.frame(ode(func=func, y=c(x=x0$x, y=x0$y), parms=Pars, times = seq(tStart, tEnd, length = tCut)))
lines(out$x, out$y, col = color)
traj[[i]] <- out
}
return(traj)
}
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),20, add=TRUE)
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2), tEnd=10, tCut=1000, loc.num=4)
for (i in 1:loc.num) {
x0 <- locator(1, "p", pch=16, col="red")
out <- as.data.frame(ode(func=func, y=c(x=x0$x, y=x0$y), parms=Pars, times = seq(tStart, tEnd, length = tCut)))
lines(out$x, out$y, col = color)
traj[[i]] <- out
}
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),20, add=TRUE)
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2), tEnd=10, tCut=1000, loc.num=4)
?locator
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),20, add=TRUE)
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2), tEnd=10, tCut=1000, loc.num=4)
x0 <- locator(1, "p", pch=16, col="red")
x0
x0 <- locator(2, "p", pch=16, col="red")
x0
x0 <- locator(2, "p", pch=16, col="red")
x0
?stop
draw.traj <- function(func, Pars, tStart=0, tEnd=1, tCut=10, loc.num=1, color = "red") {
traj <- list()
print(paste("Click", loc.num, "initial values"))
for (i in 1:loc.num) {
x0 <- locator(1, "p", pch=16, col="red")
if(x0 == NULL) stop()
out <- as.data.frame(ode(func=func, y=c(x=x0$x, y=x0$y), parms=Pars, times = seq(tStart, tEnd, length = tCut)))
lines(out$x, out$y, col = color)
traj[[i]] <- out
}
return(traj)
}
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),20, add=TRUE)
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2), tEnd=10, tCut=1000, loc.num=4)
?stop
while
?while
?while
draw.traj <- function(func, Pars, tStart=0, tEnd=1, tCut=10, loc.num=1, color = "red") {
traj <- list()
print(paste("Click", loc.num, "initial values"))
x0 <- locator(1, "p", pch=16, col="red")
for (x0 != NULL) {
if(x0 == NULL) stop()
out <- as.data.frame(ode(func=func, y=c(x=x0$x, y=x0$y), parms=Pars, times = seq(tStart, tEnd, length = tCut)))
lines(out$x, out$y, col = color)
traj[[i]] <- out
x0 <- locator(1, "p", pch=16, col="red")
draw.traj <- function(func, Pars, tStart=0, tEnd=1, tCut=10, loc.num=1, color = "red") {
traj <- list()
print(paste("Click", loc.num, "initial values"))
x0 <- locator(1, "p", pch=16, col="red")
while (x0 != NULL) {
out <- as.data.frame(ode(func=func, y=c(x=x0$x, y=x0$y), parms=Pars, times = seq(tStart, tEnd, length = tCut)))
lines(out$x, out$y, col = color)
traj[[i]] <- out
x0 <- locator(1, "p", pch=16, col="red")
}
return(traj)
}
draw.traj <- function(func, Pars, tStart=0, tEnd=1, tCut=10, loc.num=1, color = "red") {
traj <- list()
print(paste("Click", loc.num, "initial values"))
x0 <- locator(1, "p", pch=16, col="red")
while(x0 != NULL){
out <- as.data.frame(ode(func=func, y=c(x=x0$x, y=x0$y), parms=Pars, times = seq(tStart, tEnd, length = tCut)))
lines(out$x, out$y, col = color)
traj[[i]] <- out
x0 <- locator(1, "p", pch=16, col="red")
}
return(traj)
}
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2), tEnd=10, tCut=1000, loc.num=4)
draw.traj <- function(func, Pars, tStart=0, tEnd=1, tCut=10, loc.num=1, color = "red") {
traj <- list()
print(paste("Click", loc.num, "initial values"))
x0 = 0
while(x0 != NULL){
x0 <- locator(1, "p", pch=16, col="red")
out <- as.data.frame(ode(func=func, y=c(x=x0$x, y=x0$y), parms=Pars, times = seq(tStart, tEnd, length = tCut)))
lines(out$x, out$y, col = color)
traj[[i]] <- out
}
return(traj)
}
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),20, add=TRUE)
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2), tEnd=10, tCut=1000, loc.num=4)
?while
x0
x0 != NULL
!is.null(x0)
draw.traj <- function(func, Pars, tStart=0, tEnd=1, tCut=10, loc.num=1, color = "red") {
traj <- list()
print(paste("Click", loc.num, "initial values"))
x0 <- locator(1, "p", pch=16, col="red")
while(!is.null(x0)){
out <- as.data.frame(ode(func=func, y=c(x=x0$x, y=x0$y), parms=Pars, times = seq(tStart, tEnd, length = tCut)))
lines(out$x, out$y, col = color)
traj[[i]] <- out
x0 <- locator(1, "p", pch=16, col="red")
}
return(traj)
}
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2), tEnd=10, tCut=1000, loc.num=4)
draw.traj <- function(func, Pars, tStart=0, tEnd=1, tCut=10, loc.num=1, color = "red") {
traj <- list()
print(paste("Click", loc.num, "initial values"))
x0 <- locator(1, "p", pch=16, col="red")
i <- 1
while(!is.null(x0)){
out <- as.data.frame(ode(func=func, y=c(x=x0$x, y=x0$y), parms=Pars, times = seq(tStart, tEnd, length = tCut)))
lines(out$x, out$y, col = color)
traj[[i]] <- out
x0 <- locator(1, "p", pch=16, col="red")
i <- i + 1
}
return(traj)
}
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2), tEnd=10, tCut=1000, loc.num=4)
?rk
phasetraj <- function(fun,tdur=1,tstart=0,tend=tstart+tdur,color='orange'){
x0 <- locator(n=1);
traj <- rk(fun,c(x0$x, x0$y),tstart,tend);
points(x0$x,x0$y);
lines(traj$x[,1], traj$x[,2], col=color);
}
phasetraj(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2), tend=10)
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),20, add=TRUE)
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),40)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),20, add=TRUE)
?countour
?contour
showcontours <- function(fun,xlims, ylims, resol=50,add=F, colors=c('blue', 'blue')) {
x <- matrix(seq(xlims[1],xlims[2], length=resol), byrow=F, resol,resol);
y <- matrix(seq(ylims[1],ylims[2], length=resol),byrow=T, resol, resol);
npts = resol*resol;
z <- fun(x,y);
z1 <- matrix(z[1:npts], resol, resol);
z2 <- matrix(z[(npts+1):(2*npts)], resol, resol);
contour(x[,1],y[1,],z1, add=add, col=colors[1], drawlabels=FALSE, lwd=2);
contour(x[,1],y[1,],z2, add=T, col=colors[2], drawlabels=FALSE, lwd=2);
}
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),40)
nullclines <- function(fun,xlims, ylims, resol=50, add=F,colors=c('blue', 'blue')) {
x <- matrix(seq(xlims[1],xlims[2], length=resol), byrow=F, resol,resol);
y <- matrix(seq(ylims[1],ylims[2], length=resol),byrow=T, resol, resol);
npts = resol*resol;
z <- fun(x,y);
z1 <- matrix(z[1:npts], resol, resol);
z2 <- matrix(z[(npts+1):(2*npts)], resol, resol);
contour(x[,1],y[1,],z1,levels=c(0), add=add, col=colors[1], drawlabels=FALSE, lwd=2);
contour(x[,1],y[1,],z2,levels=c(0), add=T, col=colors[2], drawlabels=FALSE, lwd=2);
}
showcontours <- function(fun,xlims, ylims, resol=50,add=F, colors=c('blue', 'blue')) {
x <- matrix(seq(xlims[1],xlims[2], length=resol), byrow=F, resol,resol);
y <- matrix(seq(ylims[1],ylims[2], length=resol),byrow=T, resol, resol);
npts = resol*resol;
z <- fun(x,y);
z1 <- matrix(z[1:npts], resol, resol);
z2 <- matrix(z[(npts+1):(2*npts)], resol, resol);
contour(x[,1],y[1,],z1, add=add, col=colors[1]);
contour(x[,1],y[1,],z2, add=T, col=colors[2]);
}
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),40)
?root
?uniroot
fun
fun(1)
fun(2)
fun(1)[1]
predatorprey()
predatorprey(1,2)
predatorprey(1,2)[1]
predatorprey(x=1,y=1)
predatorprey
predatorprey()
predatorprey(1)
predatorprey(2)
predatorprey(x=2,y=1)
fun(x,y)
fun
z <- predatorprey(x,y)
z(1,2)
x
y
z <- predatorprey(1,2)
z
z(1,2)
z <- predatoryprey()
z <- predatorprey()
z
z(1,2)
z(1,2.3)
predatorprey(1,2)
z(1,2)[1]
z()[1]
x <- z()[1]
z <- predatorprey()[1]
xfun <- function(x,y) fun(x,y)[1]
fun <- predatorprey
xfun <- function(x,y) fun(x,y)[1]
xfun(x,y)
xfun(1,2)
xfun <- function(x,y) { a<- fun(x,y); return(a[1])}
xfun
xfun(1,2)
fun(x,y)
z <- fun(x,y);
xfun <- function(x,y) { a <- z(x,y); return(a[1])}
fun
z
xfun
xfun(1,2)
?arrows
nullclines2 <- function(fun,xlims, ylims, resol=50,add=F, colors=c('blue', 'blue')) {
xs <- seq(xlims[1],xlims[2], length=resol);
ys <- seq(ylims[1],ylims[2], length=resol);
z <- fun(x,y);
xvals = rep(0, length=resol)
yvals = rep(0, length=resol)
xfun <- function(y,x) { a <- z(x,y); return(a[1])}
yfun <- function(x,y) { a <- z(x,y); return(a[2])}
for(i in 1:resol) {
xvals[i] <- uniroot(xfun,x=xs[i], ylims)
yvals[i] <- uniroot(yfun,y=ys[i], xlims)
}
if(add=F) {
plot(xs, xvals, type="l", col=colors[1])
} else {
lines(xs, xvals, col=colors[1])
}
lines(ys, yvals, col=colors[2])
}
nullclines2 <- function(fun,xlims, ylims, resol=50,add=F, colors=c('blue', 'blue')) {
xs <- seq(xlims[1],xlims[2], length=resol);
ys <- seq(ylims[1],ylims[2], length=resol);
z <- fun(x,y);
xvals = rep(0, length=resol)
yvals = rep(0, length=resol)
xfun <- function(y,x) { a <- z(x,y); return(a[1])}
yfun <- function(x,y) { a <- z(x,y); return(a[2])}
for(i in 1:resol) {
xvals[i] <- uniroot(xfun,x=xs[i], ylims)
yvals[i] <- uniroot(yfun,y=ys[i], xlims)
}
if(add==F) {
plot(1,xlim=xlims, ylim=ylims, type='n')
}
lines(xs, xvals, col=colors[1])
lines(ys, yvals, col=colors[2])
}
nullclines2(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),40)
nullclines2 <- function(fun,xlims, ylims, resol=50,add=F, colors=c('blue', 'blue')) {
xs <- seq(xlims[1],xlims[2], length=resol);
ys <- seq(ylims[1],ylims[2], length=resol);
z <- fun(x,y);
xvals = rep(0, length=resol)
yvals = rep(0, length=resol)
xfun <- function(y,x) { a <- z(x,y); return(a[1])}
yfun <- function(x,y) { a <- z(x,y); return(a[2])}
for(i in 1:resol) {
xvals[i] <- uniroot(xfun,x=xs[i], ylims)$root
yvals[i] <- uniroot(yfun,y=ys[i], xlims)$root
}
if(add==F) {
plot(1,xlim=xlims, ylim=ylims, type='n')
}
lines(xs, xvals, col=colors[1])
lines(ys, yvals, col=colors[2])
}
nullclines2(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),40)
fun <- fishsys
xlims
ylims
add
add=F
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),20, add=TRUE)
resol=40
xs <- seq(xlims[1],xlims[2], length=resol);
ys <- seq(ylims[1],ylims[2], length=resol);
z <- fun(x,y);
xvals = rep(0, length=resol)
yvals = rep(0, length=resol)
xfun <- function(y,x) { a <- z(x,y); return(a[1])}
yfun <- function(x,y) { a <- z(x,y); return(a[2])}
xs
ys
xvals
xfun
z
xfun(0,0)
xfun(0,30)
xfun(1,30)
xfun(1,0)
nullclines2(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0.01,25),c(0.01,30),40)
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0.01,25),c(0.01,30),40)
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0.01,25),c(0.01,30),2000)
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0.01,25),c(0.01,30),200)
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0.01,25),c(0.01,30),250)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),20, add=TRUE)
traj <- draw.traj(func=fishsysDES, Pars=c(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2), tEnd=10, tCut=1000, loc.num=4)
nullclines(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0.01,25),c(0.01,30),250)
phasearrows(fishsys(c=2, O=1, p=4, r=1.1, d=1, K=20, q=0.25, a=2),c(0,25),c(0,30),20, add=TRUE)
require(knitr)
knit('bvpex.md')
setwd("~/Dropbox/Public/jekyll-site")
require(knitr)
knit('bvpex.md')
knit('bvpex.md')
