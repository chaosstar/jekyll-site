<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
 
 <title>Noam Ross - R</title>
 <link href="http://www.noamross.net/blog/R.xml" rel="self"/>
 <link href="http://www.noamross.net"/>
 <updated>2012-11-05T20:03:34-08:00</updated>
 <id>http://www.noamross.net</id>
 <author>
   <name>Noam Ross</name>
   <email>noam.ross@gmail.com</email>
 </author>

 
 <entry>
   <title>Ryan Peek on Customizing Your R Setup</title>
   <link href="http://www.noamross.net/blog/2012/11/2/rprofile.html"/>
   <updated>2012-11-02T11:37:00-07:00</updated>
   <id>hhttp://www.noamross.net/blog/2012/11/2/rprofile</id>
   <content type="html">&lt;head&gt;
  &lt;style type=&quot;text/css&quot;  media=&quot;all&quot;&gt;
    table tbody {border-top:2px; border-bottom:2px;}
    table thead {border-bottom:1px;}
  &lt;/style&gt;
&lt;/head&gt; &lt;p&gt;&lt;a href=&quot;http://watershed.ucdavis.edu/people/ryan-peek&quot;&gt;Ryan Peek&lt;/a&gt; showed us how to use an &lt;code&gt;.Rprofile&lt;/code&gt; file to customize your R setup. Here are his instructions and script:&lt;/p&gt;
&lt;h2 id=&quot;for-windows&quot;&gt;For Windows&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;To change profile for R, go here:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;C:\Program Files\R\R-2.15.1\etc&lt;/code&gt; (or whatever version you are using)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Edit the “Rprofile.site” file&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Restart R&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;for-macs&quot;&gt;For Macs&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Create your Rprofile file. -use TextEdit or another editor to create a file called Rprofile.txt&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;In a terminal window, type:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&amp;gt;&amp;gt; cp Rprofile.txt .Rprofile&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;(which copies the visible Rprofile.txt to the invisible .Rprofile)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;You can check this by doing &lt;code&gt;&amp;gt;ls -la&lt;/code&gt; again to see it in the directory listing.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Restart R&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Note that you can save &lt;code&gt;.Rprofile&lt;/code&gt; in your home directory, or, if you are using R Studio, in a &lt;em&gt;project&lt;/em&gt; directory. In the latter case, the profile will only be loaded when you load that project.&lt;/p&gt;
&lt;h3 id=&quot;things-to-put-in-the-.rprofile-file&quot;&gt;Things to put in the &lt;code&gt;.Rprofile&lt;/code&gt; file:&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Set a local CRAN Mirror:&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;kw&quot;&gt;local&lt;/span&gt;({r &amp;lt;- &lt;span class=&quot;kw&quot;&gt;getOption&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;repos&amp;quot;&lt;/span&gt;)
       r[&lt;span class=&quot;st&quot;&gt;&amp;quot;CRAN&amp;quot;&lt;/span&gt;] &amp;lt;- &lt;span class=&quot;st&quot;&gt;&amp;quot;http://cran.cnr.berkeley.edu/&amp;quot;&lt;/span&gt;
       &lt;span class=&quot;kw&quot;&gt;options&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;repos=&lt;/span&gt;r)})&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Set machine-specific options:&lt;/em&gt;&lt;/strong&gt; If you use Dropbox or something similar to sync R files across computers, you can use &lt;code&gt;Sys.info()&lt;/code&gt; to set options specifically for your machine. This code sets the root path differently for different machines:&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;if(&lt;span class=&quot;kw&quot;&gt;Sys.info&lt;/span&gt;()[&lt;span class=&quot;dv&quot;&gt;4&lt;/span&gt;]==&lt;span class=&quot;st&quot;&gt;&amp;quot;Work-PC&amp;quot;&lt;/span&gt;) {
  root&amp;lt;-&lt;span class=&quot;st&quot;&gt;&amp;quot;C://Users//Ryan//Desktop//Dropbox//R//&amp;quot;&lt;/span&gt;
} else if(&lt;span class=&quot;kw&quot;&gt;Sys.info&lt;/span&gt;()[&lt;span class=&quot;dv&quot;&gt;4&lt;/span&gt;]==&lt;span class=&quot;st&quot;&gt;&amp;quot;Mac.local&amp;quot;&lt;/span&gt;) {
  root&amp;lt;-&lt;span class=&quot;st&quot;&gt;&amp;quot;/Users/Ryan/Dropbox/R/&amp;quot;&lt;/span&gt;
} else {
  root&amp;lt;-&lt;span class=&quot;st&quot;&gt;&amp;quot;C://Users//rapeek//Dropbox//R//&amp;quot;&lt;/span&gt;
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Set a welcome message and load a file of other useful functions:&lt;/em&gt;&lt;/strong&gt; Anything in the &lt;code&gt;.First&lt;/code&gt; function is run on startup&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;.First &amp;lt;- function(){
    &lt;span class=&quot;kw&quot;&gt;cat&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;Welcome to R!&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;,&lt;span class=&quot;dt&quot;&gt;sep=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;)
    &lt;span class=&quot;kw&quot;&gt;cat&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;---------------&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;\n\n&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;,&lt;span class=&quot;dt&quot;&gt;sep=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;)
    
    if(&lt;span class=&quot;kw&quot;&gt;file.exists&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;~/RbasicFunctions_example.r&amp;quot;&lt;/span&gt;)){
        &lt;span class=&quot;kw&quot;&gt;source&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;~/RbasicFunctions_example.r&amp;quot;&lt;/span&gt;)
        &lt;span class=&quot;kw&quot;&gt;cat&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;RbasicFunctions_example.r was loaded, providing the following functions:&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;\n\n&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;,&lt;span class=&quot;dt&quot;&gt;sep=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;)
        &lt;span class=&quot;kw&quot;&gt;cat&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;use  &amp;#39;print.functions()&amp;#39;  to view&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;,&lt;span class=&quot;dt&quot;&gt;sep=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;)
    }
}&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;helper-functions&quot;&gt;Helper functions&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://gist.github.com/4003343&quot;&gt;Here’s Ryan’s file&lt;/a&gt;, called above as &lt;code&gt;RbasicFunctions_example.r&lt;/code&gt;, which has his helper functions. Running &lt;code&gt;print.functions()&lt;/code&gt; will display a list of these with short explanations:&lt;/p&gt;
&lt;script src=&quot;https://gist.github.com/4003343.js?file=RbasicFunctions_example.r&quot;&gt;&lt;/script&gt;

&lt;p&gt;A lot of other useful options for R profile files are found in &lt;a href=&quot;http://stackoverflow.com/questions/1189759/expert-r-users-whats-in-your-rprofile&quot;&gt;this Stack Overflow discussion&lt;/a&gt;&lt;/p&gt;</content>
 </entry>
 
 <entry>
   <title>Chris Hamm on using plot.new() for better combined plots</title>
   <link href="http://www.noamross.net/blog/2012/10/26/plotnew.html"/>
   <updated>2012-10-26T10:41:35-07:00</updated>
   <id>hhttp://www.noamross.net/blog/2012/10/26/plotnew</id>
   <content type="html">&lt;head&gt;
  &lt;style type=&quot;text/css&quot;  media=&quot;all&quot;&gt;
    table tbody {border-top:2px; border-bottom:2px;}
    table thead {border-bottom:1px;}
  &lt;/style&gt;
&lt;/head&gt; &lt;p&gt;At DRUG today, &lt;a href=&quot;https://www.msu.edu/~chamm/Welcome.html&quot;&gt;Chris Hamm&lt;/a&gt; (&lt;script type=&quot;text/javascript&quot;&gt;
&lt;!--
h='&amp;#x75;&amp;#x63;&amp;#100;&amp;#x61;&amp;#118;&amp;#x69;&amp;#x73;&amp;#46;&amp;#x65;&amp;#100;&amp;#x75;';a='&amp;#64;';n='&amp;#x63;&amp;#x61;&amp;#104;&amp;#x61;&amp;#x6d;&amp;#x6d;';e=n+a+h;
document.write('&lt;a h'+'ref'+'=&quot;ma'+'ilto'+':'+e+'&quot;&gt;'+'email'+'&lt;\/'+'a'+'&gt;');
// --&gt;
&lt;/script&gt;&lt;noscript&gt;&amp;#x65;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#32;&amp;#40;&amp;#x63;&amp;#x61;&amp;#104;&amp;#x61;&amp;#x6d;&amp;#x6d;&amp;#32;&amp;#x61;&amp;#116;&amp;#32;&amp;#x75;&amp;#x63;&amp;#100;&amp;#x61;&amp;#118;&amp;#x69;&amp;#x73;&amp;#32;&amp;#100;&amp;#x6f;&amp;#116;&amp;#32;&amp;#x65;&amp;#100;&amp;#x75;&amp;#x29;&lt;/noscript&gt;) showed us an easier way to combine multiple figures into one plot using &lt;code&gt;plot.new&lt;/code&gt;, rather than &lt;code&gt;par(mfrow=...)&lt;/code&gt; Here’s his script:&lt;/p&gt;
&lt;html&gt;
&lt;head&gt;
&lt;style type=&quot;text/css&quot;&gt;.knitr.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
    font-weight: bold;
    color: #FF0000;
}, 
.warning {
    font-weight: bold;
} 
.message {
    font-style: italic;
} 
.source, .output, .warning, .error, .message {
    padding: 0em 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f7f7f7;
}
.rimage.left {
  text-align: left;
}
.rimage.right {
  text-align: right;
}
.rimage.center {
  text-align: center;
}

.source {
  color: #333333;
}
.background {
  color: #F7F7F7;
}

.number {
  color: #000000;
}

.functioncall {
  color: #800054;
  font-weight: bolder;
}

.string {
  color: #9999FF;
}

.keyword {
  font-weight: bolder;
  color: black;
}

.argument {
  color: #B04005;
}

.comment {
  color: #2E9957;
}

.roxygencomment {
  color: #707AB3;
}

.formalargs {
  color: #B04005;
}

.eqformalargs {
  color: #B04005;
}

.assignement {
  font-weight: bolder;
  color: #000000;
}

.package {
  color: #96B525;
}

.slot {
  font-style: italic;
}

.symbol {
  color: #000000;
}

.prompt {
  color: #333333;
}
&lt;/style&gt;
  &lt;title&gt;
A Report Generated by knitr
&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;div class=&quot;chunk&quot;&gt;&lt;div class=&quot;rcode&quot;&gt;&lt;div class=&quot;source&quot;&gt;&lt;pre class=&quot;knitr r&quot;&gt;# &lt;span class=&quot;functioncall&quot;&gt;plot.new&lt;/span&gt;() cahamm@ucdavis.edu

&lt;span class=&quot;comment&quot;&gt;#I discovered this plotting method when trying to add an inset figure&lt;/span&gt;
&lt;span class=&quot;comment&quot;&gt;# to a plot&lt;/span&gt;

&lt;span class=&quot;comment&quot;&gt;# plot.new is part of the traditional graphics. This function starts a new plot with the&lt;/span&gt;
&lt;span class=&quot;comment&quot;&gt;# scale of the x- and y- axes to (0,1) This allows you to specify the location of each
&lt;span class=&quot;comment&quot;&gt;# pane or inset and provides a high level of customizability for R graphics&lt;/span&gt;

&lt;span class=&quot;comment&quot;&gt;############### Plotting multiple panes, the old way&lt;/span&gt;
&lt;span class=&quot;functioncall&quot;&gt;par&lt;/span&gt;(mfrow = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(3, 1))

&lt;span class=&quot;functioncall&quot;&gt;plot&lt;/span&gt;(P2B1$TMP, ylab = &lt;span class=&quot;string&quot;&gt;&quot;Degrees C&quot;&lt;/span&gt;, xlab = &lt;span class=&quot;string&quot;&gt;&quot;3 January - 13 March, 2011&quot;&lt;/span&gt;, type = &lt;span class=&quot;string&quot;&gt;&quot;l&quot;&lt;/span&gt;, lty = 1, 
    ylim = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(-25, 15), xaxt = &lt;span class=&quot;string&quot;&gt;&quot;n&quot;&lt;/span&gt;, lwd = 2)
&lt;span class=&quot;functioncall&quot;&gt;lines&lt;/span&gt;(P2T1$TMP, type = &lt;span class=&quot;string&quot;&gt;&quot;l&quot;&lt;/span&gt;, lty = 2, col = &lt;span class=&quot;string&quot;&gt;&quot;red&quot;&lt;/span&gt;, lwd = 2)
# line at &lt;span class=&quot;functioncall&quot;&gt;DD50&lt;/span&gt; (10C = 50F)
&lt;span class=&quot;functioncall&quot;&gt;legend&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;topleft&quot;&lt;/span&gt;, legend = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;Ground Level&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;1m Height&quot;&lt;/span&gt;), col = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;black&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;red&quot;&lt;/span&gt;), lty = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(1, 
    2), lwd = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(2, 2), bty = &lt;span class=&quot;string&quot;&gt;&quot;n&quot;&lt;/span&gt;)

&lt;span class=&quot;functioncall&quot;&gt;plot&lt;/span&gt;(P2B2$TMP, ylab = &lt;span class=&quot;string&quot;&gt;&quot;Degrees C&quot;&lt;/span&gt;, xlab = &lt;span class=&quot;string&quot;&gt;&quot;13 March - 7 May, 2011&quot;&lt;/span&gt;, type = &lt;span class=&quot;string&quot;&gt;&quot;l&quot;&lt;/span&gt;, lty = 1, lwd = 2, 
    ylim = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(-10, 35), xaxt = &lt;span class=&quot;string&quot;&gt;&quot;n&quot;&lt;/span&gt;)
&lt;span class=&quot;functioncall&quot;&gt;lines&lt;/span&gt;(P2T2$TMP, col = &lt;span class=&quot;string&quot;&gt;&quot;red&quot;&lt;/span&gt;, lwd = 2, lty = 2)

&lt;span class=&quot;functioncall&quot;&gt;plot&lt;/span&gt;(P2B3$TMP, ylab = &lt;span class=&quot;string&quot;&gt;&quot;Degrees C&quot;&lt;/span&gt;, xlab = &lt;span class=&quot;string&quot;&gt;&quot;7 May - 16 July, 2011&quot;&lt;/span&gt;, type = &lt;span class=&quot;string&quot;&gt;&quot;l&quot;&lt;/span&gt;, ylim = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(0, 
    38), xaxt = &lt;span class=&quot;string&quot;&gt;&quot;n&quot;&lt;/span&gt;, lwd = 2)
&lt;span class=&quot;functioncall&quot;&gt;lines&lt;/span&gt;(P2T3$TMP, col = &lt;span class=&quot;string&quot;&gt;&quot;red&quot;&lt;/span&gt;, lwd = 2, lty = 2)
&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;rimage center&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/figure.plot.new/plot-new-T-Rhtmlauto-report1.png&quot;  class=&quot;plot&quot; /&gt;
&lt;/div&gt;&lt;div class=&quot;rcode&quot;&gt;
&lt;div class=&quot;source&quot;&gt;&lt;pre class=&quot;knitr r&quot;&gt;
&lt;span class=&quot;comment&quot;&gt;#### Using the new way&lt;/span&gt;
&lt;span class=&quot;functioncall&quot;&gt;par&lt;/span&gt;(mar = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(1, 5, 0, 0))  #set up the margins &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; the overall plot
&lt;span class=&quot;functioncall&quot;&gt;quartz&lt;/span&gt;(height = 8, width = 8)
&lt;span class=&quot;functioncall&quot;&gt;par&lt;/span&gt;(fig = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(0, 1, 0.65, 1), new = T)  #now tell it where you want the new plot, reads x1 x2, y1 &lt;span class=&quot;functioncall&quot;&gt;y2&lt;/span&gt; (left and right bounds, top and bottom bounds)
&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;warning&quot;&gt;&lt;pre class=&quot;knitr r&quot;&gt;## Warning: calling par(new=TRUE) with no plot
&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;source&quot;&gt;&lt;pre class=&quot;knitr r&quot;&gt;&lt;span class=&quot;functioncall&quot;&gt;par&lt;/span&gt;(mar = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(3, 6, 1, 1))  #set the margins &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; the new plot
&lt;span class=&quot;functioncall&quot;&gt;plot.new&lt;/span&gt;()
&lt;span class=&quot;functioncall&quot;&gt;plot&lt;/span&gt;(P2B1$TMP, ylab = &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;, xlab = &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;, type = &lt;span class=&quot;string&quot;&gt;&quot;l&quot;&lt;/span&gt;, lty = 1, ylim = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(-25, 15), xaxt = &lt;span class=&quot;string&quot;&gt;&quot;n&quot;&lt;/span&gt;, lwd = 3, 
    las = 1, bty = &lt;span class=&quot;string&quot;&gt;&quot;l&quot;&lt;/span&gt;, cex.axis = 1.5)
&lt;span class=&quot;functioncall&quot;&gt;mtext&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;3 January - 13 March, 2011&quot;&lt;/span&gt;, side = 1, line = 0.5, adj = 0.5, cex = 1.5)
&lt;span class=&quot;functioncall&quot;&gt;lines&lt;/span&gt;(P2T1$TMP, type = &lt;span class=&quot;string&quot;&gt;&quot;l&quot;&lt;/span&gt;, lty = 4, col = &lt;span class=&quot;string&quot;&gt;&quot;red&quot;&lt;/span&gt;, lwd = 2)
&lt;span class=&quot;functioncall&quot;&gt;legend&lt;/span&gt;(x = 0, y = 19, legend = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;1m Height&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;Ground Level&quot;&lt;/span&gt;), col = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;red&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;black&quot;&lt;/span&gt;), lty = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(4, 
    1), lwd = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(3, 2), bty = &lt;span class=&quot;string&quot;&gt;&quot;n&quot;&lt;/span&gt;)

&lt;span class=&quot;functioncall&quot;&gt;par&lt;/span&gt;(fig = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(0, 1, 0.35, 0.7), new = T)
&lt;span class=&quot;functioncall&quot;&gt;par&lt;/span&gt;(mar = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(3, 6, 1, 1))
&lt;span class=&quot;functioncall&quot;&gt;plot.new&lt;/span&gt;()
&lt;span class=&quot;functioncall&quot;&gt;plot&lt;/span&gt;(P2B2$TMP, ylab = (&lt;span class=&quot;functioncall&quot;&gt;expression&lt;/span&gt;(&lt;span class=&quot;functioncall&quot;&gt;paste&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;functioncall&quot;&gt;Temperature&lt;/span&gt; (&quot;&lt;/span&gt;, degree, &lt;span class=&quot;string&quot;&gt;&quot;C)&quot;&lt;/span&gt;))), xlab = &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;, type = &lt;span class=&quot;string&quot;&gt;&quot;l&quot;&lt;/span&gt;, 
    lty = 1, lwd = 3, ylim = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(-10, 35), xaxt = &lt;span class=&quot;string&quot;&gt;&quot;n&quot;&lt;/span&gt;, bty = &lt;span class=&quot;string&quot;&gt;&quot;l&quot;&lt;/span&gt;, las = 1, cex.axis = 1.5, cex.lab = 1.5)
&lt;span class=&quot;functioncall&quot;&gt;lines&lt;/span&gt;(P2T2$TMP, col = &lt;span class=&quot;string&quot;&gt;&quot;red&quot;&lt;/span&gt;, lwd = 2, lty = 4)
&lt;span class=&quot;functioncall&quot;&gt;mtext&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;13 March - 7 May, 2011&quot;&lt;/span&gt;, side = 1, line = 0.5, adj = 0.5, cex = 1.5)

&lt;span class=&quot;functioncall&quot;&gt;par&lt;/span&gt;(fig = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(0, 1, 0, 0.35), new = T)
&lt;span class=&quot;functioncall&quot;&gt;par&lt;/span&gt;(mar = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(3, 6, 1, 1))
&lt;span class=&quot;functioncall&quot;&gt;plot.new&lt;/span&gt;()
&lt;span class=&quot;functioncall&quot;&gt;plot&lt;/span&gt;(P2B3$TMP, ylab = &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;, xlab = &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;, type = &lt;span class=&quot;string&quot;&gt;&quot;l&quot;&lt;/span&gt;, lty = 1, ylim = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(0, 38), xaxt = &lt;span class=&quot;string&quot;&gt;&quot;n&quot;&lt;/span&gt;, lwd = 3, 
    las = 1, bty = &lt;span class=&quot;string&quot;&gt;&quot;l&quot;&lt;/span&gt;, cex.axis = 1.5)
&lt;span class=&quot;functioncall&quot;&gt;lines&lt;/span&gt;(P2T3$TMP, col = &lt;span class=&quot;string&quot;&gt;&quot;red&quot;&lt;/span&gt;, lwd = 2, lty = 4)
&lt;span class=&quot;functioncall&quot;&gt;mtext&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;7 May - 16 July, 2011&quot;&lt;/span&gt;, side = 1, line = 0.5, adj = 0.5, cex = 1.5)
&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;rimage center&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/figure.plot.new/plot-new-T-Rhtmlauto-report2.png&quot;  class=&quot;plot&quot; /&gt;
&lt;/div&gt;&lt;div class=&quot;rcode&quot;&gt;
&lt;div class=&quot;source&quot;&gt;&lt;pre class=&quot;knitr r&quot;&gt;
&lt;span class=&quot;comment&quot;&gt;############# Puting it all together&lt;/span&gt;
&lt;span class=&quot;functioncall&quot;&gt;library&lt;/span&gt;(MASS)
&lt;span class=&quot;functioncall&quot;&gt;library&lt;/span&gt;(MCMCpack)
&lt;span class=&quot;functioncall&quot;&gt;library&lt;/span&gt;(compositions)
&lt;span class=&quot;functioncall&quot;&gt;library&lt;/span&gt;(grDevices)

w &amp;lt;- &lt;span class=&quot;functioncall&quot;&gt;rdirichlet&lt;/span&gt;(50000, &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(5, 0.5, 2))
&lt;span class=&quot;functioncall&quot;&gt;colnames&lt;/span&gt;(w) &amp;lt;- &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;A&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;B&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;C&quot;&lt;/span&gt;)
ind1 &amp;lt;- &lt;span class=&quot;functioncall&quot;&gt;rmultinom&lt;/span&gt;(1, 40, w[1, ])
ind2 &amp;lt;- &lt;span class=&quot;functioncall&quot;&gt;rmultinom&lt;/span&gt;(1, 22, w[2, ])



&lt;span class=&quot;functioncall&quot;&gt;quartz&lt;/span&gt;(width = 6.8, height = 4.5)
&lt;span class=&quot;functioncall&quot;&gt;par&lt;/span&gt;(fig = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(0.4, 0.6, 0.75, 0.95), mar = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(0, 0, 0, 0))
&lt;span class=&quot;functioncall&quot;&gt;plot.rcomp&lt;/span&gt;(w, col = &lt;span class=&quot;functioncall&quot;&gt;rgb&lt;/span&gt;(1, 0, 0, 0.1), pch = &lt;span class=&quot;string&quot;&gt;&quot;.&quot;&lt;/span&gt;, labels = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;A&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;B&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;C&quot;&lt;/span&gt;))

&lt;span class=&quot;comment&quot;&gt;# Individual count data&lt;/span&gt;
&lt;span class=&quot;functioncall&quot;&gt;par&lt;/span&gt;(fig = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(0, 1, 0.1, 0.3), new = &lt;span class=&quot;keyword&quot;&gt;TRUE&lt;/span&gt;)
# &lt;span class=&quot;functioncall&quot;&gt;plot.window&lt;/span&gt;(xlim=&lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(0,1),ylim=&lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(0,0.75))
&lt;span class=&quot;functioncall&quot;&gt;plot.new&lt;/span&gt;()
# &lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.2,0.2,&lt;span class=&quot;string&quot;&gt;'x'&lt;/span&gt;,font=3,family=&lt;span class=&quot;string&quot;&gt;'Arial'&lt;/span&gt;,cex=2)
&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.1, 0.6, &lt;span class=&quot;functioncall&quot;&gt;expression&lt;/span&gt;(&lt;span class=&quot;functioncall&quot;&gt;italic&lt;/span&gt;(x[&lt;span class=&quot;functioncall&quot;&gt;paste&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;1A&quot;&lt;/span&gt;)]) == 36), pos = 4)
&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.1, 0.4, &lt;span class=&quot;functioncall&quot;&gt;expression&lt;/span&gt;(&lt;span class=&quot;functioncall&quot;&gt;italic&lt;/span&gt;(x[&lt;span class=&quot;functioncall&quot;&gt;paste&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;1B&quot;&lt;/span&gt;)]) == 1), pos = 4)
&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.1, 0.2, &lt;span class=&quot;functioncall&quot;&gt;expression&lt;/span&gt;(&lt;span class=&quot;functioncall&quot;&gt;italic&lt;/span&gt;(x[&lt;span class=&quot;functioncall&quot;&gt;paste&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;1C&quot;&lt;/span&gt;)]) == 3), pos = 4)

&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.4, 0.6, &lt;span class=&quot;functioncall&quot;&gt;expression&lt;/span&gt;(&lt;span class=&quot;functioncall&quot;&gt;italic&lt;/span&gt;(x[&lt;span class=&quot;functioncall&quot;&gt;paste&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;2A&quot;&lt;/span&gt;)]) == 15), pos = 4)
&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.4, 0.4, &lt;span class=&quot;functioncall&quot;&gt;expression&lt;/span&gt;(&lt;span class=&quot;functioncall&quot;&gt;italic&lt;/span&gt;(x[&lt;span class=&quot;functioncall&quot;&gt;paste&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;2B&quot;&lt;/span&gt;)]) == 3), pos = 4)
&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.4, 0.2, &lt;span class=&quot;functioncall&quot;&gt;expression&lt;/span&gt;(&lt;span class=&quot;functioncall&quot;&gt;italic&lt;/span&gt;(x[&lt;span class=&quot;functioncall&quot;&gt;paste&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;2C&quot;&lt;/span&gt;)]) == 11), pos = 4)

&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.74, 0.6, &lt;span class=&quot;functioncall&quot;&gt;expression&lt;/span&gt;(&lt;span class=&quot;functioncall&quot;&gt;italic&lt;/span&gt;(x[&lt;span class=&quot;functioncall&quot;&gt;paste&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;iA&quot;&lt;/span&gt;)]) == 13), pos = 4)
&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.74, 0.4, &lt;span class=&quot;functioncall&quot;&gt;expression&lt;/span&gt;(&lt;span class=&quot;functioncall&quot;&gt;italic&lt;/span&gt;(x[&lt;span class=&quot;functioncall&quot;&gt;paste&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;iB&quot;&lt;/span&gt;)]) == 4), pos = 4)
&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.74, 0.2, &lt;span class=&quot;functioncall&quot;&gt;expression&lt;/span&gt;(&lt;span class=&quot;functioncall&quot;&gt;italic&lt;/span&gt;(x[&lt;span class=&quot;functioncall&quot;&gt;paste&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;iC&quot;&lt;/span&gt;)]) == 5), pos = 4)


&lt;span class=&quot;comment&quot;&gt;# individual probs given count data&lt;/span&gt;
Px1 &amp;lt;- &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(36, 1, 3)/40
Px2 &amp;lt;- &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(15, 3, 11)/29
Px3 &amp;lt;- &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(13, 4, 5)/22

&lt;span class=&quot;functioncall&quot;&gt;par&lt;/span&gt;(fig = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(0.15, 0.25, 0.4, 0.6), new = &lt;span class=&quot;keyword&quot;&gt;TRUE&lt;/span&gt;)
&lt;span class=&quot;functioncall&quot;&gt;plot.new&lt;/span&gt;()
&lt;span class=&quot;functioncall&quot;&gt;barplot&lt;/span&gt;(Px1, names.arg = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot; &quot;&lt;/span&gt;), ylim = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(0, 1), col = &lt;span class=&quot;string&quot;&gt;&quot;red&quot;&lt;/span&gt;, cex.axis = 0.5, cex.names = 0.75, 
    las = 1)
&lt;span class=&quot;functioncall&quot;&gt;mtext&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;A  B  C&quot;&lt;/span&gt;, side = 1)
&lt;span class=&quot;functioncall&quot;&gt;abline&lt;/span&gt;(h = 0, lwd = 2)

&lt;span class=&quot;functioncall&quot;&gt;par&lt;/span&gt;(fig = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(0.43, 0.53, 0.4, 0.6), new = &lt;span class=&quot;keyword&quot;&gt;TRUE&lt;/span&gt;)
&lt;span class=&quot;functioncall&quot;&gt;plot.new&lt;/span&gt;()
&lt;span class=&quot;functioncall&quot;&gt;barplot&lt;/span&gt;(Px2, names.arg = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot; &quot;&lt;/span&gt;), ylim = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(0, 1), col = &lt;span class=&quot;string&quot;&gt;&quot;red&quot;&lt;/span&gt;, cex.axis = 0.5, cex.names = 0.75, 
    las = 1)
&lt;span class=&quot;functioncall&quot;&gt;mtext&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;A  B  C&quot;&lt;/span&gt;, side = 1)
&lt;span class=&quot;functioncall&quot;&gt;abline&lt;/span&gt;(h = 0, lwd = 2)

&lt;span class=&quot;functioncall&quot;&gt;par&lt;/span&gt;(fig = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(0.74, 0.84, 0.4, 0.6), new = &lt;span class=&quot;keyword&quot;&gt;TRUE&lt;/span&gt;)
# &lt;span class=&quot;functioncall&quot;&gt;par&lt;/span&gt;(fig=&lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(0.71,0.81,0.4,0.6),new=&lt;span class=&quot;keyword&quot;&gt;TRUE&lt;/span&gt;)
&lt;span class=&quot;functioncall&quot;&gt;plot.new&lt;/span&gt;()
&lt;span class=&quot;functioncall&quot;&gt;barplot&lt;/span&gt;(Px3, names.arg = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot; &quot;&lt;/span&gt;), ylim = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(0, 1), col = &lt;span class=&quot;string&quot;&gt;&quot;red&quot;&lt;/span&gt;, cex.axis = 0.5, cex.names = 0.75, 
    las = 1)
&lt;span class=&quot;functioncall&quot;&gt;mtext&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;A  B  C&quot;&lt;/span&gt;, side = 1)
&lt;span class=&quot;functioncall&quot;&gt;abline&lt;/span&gt;(h = 0, lwd = 2)

&lt;span class=&quot;functioncall&quot;&gt;par&lt;/span&gt;(fig = &lt;span class=&quot;functioncall&quot;&gt;c&lt;/span&gt;(0, 1, 0, 1), new = &lt;span class=&quot;keyword&quot;&gt;TRUE&lt;/span&gt;)
&lt;span class=&quot;functioncall&quot;&gt;plot.new&lt;/span&gt;()
&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.62, 0.51, &lt;span class=&quot;functioncall&quot;&gt;expression&lt;/span&gt;(...), pos = 2, cex = 2)
&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.08, 0.5, &lt;span class=&quot;functioncall&quot;&gt;expression&lt;/span&gt;(&lt;span class=&quot;functioncall&quot;&gt;italic&lt;/span&gt;(Px[&lt;span class=&quot;functioncall&quot;&gt;paste&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;1j&quot;&lt;/span&gt;, sep = &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;)]) == &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;), pos = 2, cex = 1)
&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.38, 0.5, &lt;span class=&quot;functioncall&quot;&gt;expression&lt;/span&gt;(&lt;span class=&quot;functioncall&quot;&gt;italic&lt;/span&gt;(Px[&lt;span class=&quot;functioncall&quot;&gt;paste&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;2j&quot;&lt;/span&gt;, sep = &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;)]) == &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;), pos = 2, cex = 1)
&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.71, 0.5, &lt;span class=&quot;functioncall&quot;&gt;expression&lt;/span&gt;(&lt;span class=&quot;functioncall&quot;&gt;italic&lt;/span&gt;(Px[&lt;span class=&quot;functioncall&quot;&gt;paste&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;ij&quot;&lt;/span&gt;, sep = &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;)]) == &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;), pos = 2, cex = 1)
# &lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.68,0.5,&lt;span class=&quot;functioncall&quot;&gt;expression&lt;/span&gt;(&lt;span class=&quot;functioncall&quot;&gt;italic&lt;/span&gt;(Px[&lt;span class=&quot;functioncall&quot;&gt;paste&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;'ij'&lt;/span&gt;,sep=&lt;span class=&quot;string&quot;&gt;''&lt;/span&gt;)])==&lt;span class=&quot;string&quot;&gt;''&lt;/span&gt;),pos=2,cex=1)

&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.04, 0.22, &lt;span class=&quot;string&quot;&gt;&quot;Individual\ncounts&quot;&lt;/span&gt;, pos = 1, cex = 1)
&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(-0.05, 0.65, &lt;span class=&quot;string&quot;&gt;&quot;Individual probabilities&quot;&lt;/span&gt;, pos = 4, cex = 1)
&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.04, 0.87, &lt;span class=&quot;string&quot;&gt;&quot;Population&quot;&lt;/span&gt;, pos = 1, cex = 1)

&lt;span class=&quot;functioncall&quot;&gt;arrows&lt;/span&gt;(0.16, 0.23, 0.16, 0.33, angle = 20, length = 0.15, lwd = 2)
&lt;span class=&quot;functioncall&quot;&gt;arrows&lt;/span&gt;(0.46, 0.23, 0.46, 0.33, angle = 20, length = 0.15, lwd = 2)
&lt;span class=&quot;functioncall&quot;&gt;arrows&lt;/span&gt;(0.795, 0.23, 0.795, 0.33, angle = 20, length = 0.15, lwd = 2)

&lt;span class=&quot;functioncall&quot;&gt;arrows&lt;/span&gt;(0.53, 0.75, 0.7, 0.63, angle = 20, length = 0.15, lwd = 2, code = 3)
&lt;span class=&quot;functioncall&quot;&gt;arrows&lt;/span&gt;(0.47, 0.75, 0.3, 0.63, angle = 20, length = 0.15, lwd = 2, code = 3)
&lt;span class=&quot;functioncall&quot;&gt;arrows&lt;/span&gt;(0.5, 0.75, 0.5, 0.63, angle = 20, length = 0.15, lwd = 2, code = 3)

&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.72, 0.89, &lt;span class=&quot;functioncall&quot;&gt;expression&lt;/span&gt;(&lt;span class=&quot;functioncall&quot;&gt;italic&lt;/span&gt;(alpha[&lt;span class=&quot;string&quot;&gt;&quot;A&quot;&lt;/span&gt;]) == &lt;span class=&quot;string&quot;&gt;&quot;5.0&quot;&lt;/span&gt;), pos = 1, cex = 1)
&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.72, 0.85, &lt;span class=&quot;functioncall&quot;&gt;expression&lt;/span&gt;(&lt;span class=&quot;functioncall&quot;&gt;italic&lt;/span&gt;(alpha[&lt;span class=&quot;string&quot;&gt;&quot;B&quot;&lt;/span&gt;]) == &lt;span class=&quot;string&quot;&gt;&quot;0.5&quot;&lt;/span&gt;), pos = 1, cex = 1)
&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.72, 0.81, &lt;span class=&quot;functioncall&quot;&gt;expression&lt;/span&gt;(&lt;span class=&quot;functioncall&quot;&gt;italic&lt;/span&gt;(alpha[&lt;span class=&quot;string&quot;&gt;&quot;C&quot;&lt;/span&gt;]) == &lt;span class=&quot;string&quot;&gt;&quot;2.0&quot;&lt;/span&gt;), pos = 1, cex = 1)

&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.92, 0.65, &lt;span class=&quot;string&quot;&gt;&quot;Multinomial&quot;&lt;/span&gt;)
&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.94, 0.87, &lt;span class=&quot;string&quot;&gt;&quot;Dirichlet&quot;&lt;/span&gt;)

&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.083, 0.95, &lt;span class=&quot;functioncall&quot;&gt;expression&lt;/span&gt;(&lt;span class=&quot;functioncall&quot;&gt;underline&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;Hierarchical level&quot;&lt;/span&gt;)), cex = 1.2)
&lt;span class=&quot;functioncall&quot;&gt;text&lt;/span&gt;(0.89, 0.95, &lt;span class=&quot;functioncall&quot;&gt;expression&lt;/span&gt;(&lt;span class=&quot;functioncall&quot;&gt;underline&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;Modeled distribution&quot;&lt;/span&gt;)), cex = 1.2)
&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;rimage center&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/figure.plot.new/plot-new-T-Rhtmlauto-report3.png&quot;  class=&quot;plot&quot; /&gt;
&lt;/div&gt;&lt;div class=&quot;rcode&quot;&gt;
&lt;div class=&quot;source&quot;&gt;&lt;pre class=&quot;knitr r&quot;&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;

&lt;/body&gt;
&lt;/html&gt;</content>
 </entry>
 
 <entry>
   <title>Stella Copeland's Intro to Mixed Models in R</title>
   <link href="http://www.noamross.net/blog/2012/10/19/stella-copeland-on-mixed-models.html"/>
   <updated>2012-10-19T10:26:56-07:00</updated>
   <id>hhttp://www.noamross.net/blog/2012/10/19/stella-copeland-on-mixed-models</id>
   <content type="html">&lt;head&gt;
  &lt;style type=&quot;text/css&quot;  media=&quot;all&quot;&gt;
    table tbody {border-top:2px; border-bottom:2px;}
    table thead {border-bottom:1px;}
  &lt;/style&gt;
&lt;/head&gt; &lt;p&gt;In D-RUG today, &lt;a href=&quot;http://www.des.ucdavis.edu/faculty/Harrison/people/stella/copeland.html&quot;&gt;Stella Copeland&lt;/a&gt; gave a quick introduction to mixed models in R. Here’s the script that she presented:&lt;/p&gt;
&lt;script src=&quot;https://gist.github.com/3919839.js?file=Mixed models R code - 10192012&quot;&gt;&lt;/script&gt;

&lt;p&gt;Get the data file for this script &lt;a href=&quot;https://gist.github.com/3919839#file_mixed_model_ex_data&quot;&gt;here&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Stella also recommends &lt;a href=&quot;http://dx.doi.org/10.1016/j.tree.2008.10.008&quot;&gt;this paper&lt;/a&gt; by &lt;a href=&quot;http://www.math.mcmaster.ca/~bolker/&quot;&gt;Ben Bolker&lt;/a&gt; as a quick introduction to the topic.&lt;/p&gt;</content>
 </entry>
 
 <entry>
   <title>A quick introduction to ggplot()</title>
   <link href="http://www.noamross.net/blog/2012/10/5/ggplot-introduction.html"/>
   <updated>2012-10-05T12:05:10-07:00</updated>
   <id>hhttp://www.noamross.net/blog/2012/10/5/ggplot-introduction</id>
   <content type="html">&lt;head&gt;
  &lt;style type=&quot;text/css&quot;  media=&quot;all&quot;&gt;
    table tbody {border-top:2px; border-bottom:2px;}
    table thead {border-bottom:1px;}
  &lt;/style&gt;
&lt;/head&gt; &lt;p&gt;&lt;em&gt;I gave a short talk today to the [Davis R Users’ Group] about ggplot. This what I presented. Additional resources &lt;a href=&quot;#some-resources&quot;&gt;at the bottom of this post&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ggplot&lt;/code&gt; is an R package for data exploration and producing plots. It produces fantastic-looking graphics and allows one to slice and dice one’s data in many different ways.&lt;/p&gt;
&lt;h3 id=&quot;comparing-with-base-graphics&quot;&gt;Comparing with base graphics&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;(This example from &lt;a href=&quot;http://stackoverflow.com/questions/11679019/recreating-a-ggplot2-geom-point-using-base-graphics&quot;&gt;Stack Overflow&lt;/a&gt;)&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;First, get the package:&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;kw&quot;&gt;install.packages&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;ggplot2&amp;quot;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;kw&quot;&gt;library&lt;/span&gt;(ggplot2)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let’s say we wanted to plot some two-variable data, changing color and shape by the sub-category of data. Here’s a data set:&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;data.df &amp;lt;- &lt;span class=&quot;kw&quot;&gt;data.frame&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;Plant =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Plant1&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;Plant1&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;Plant1&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;Plant2&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;Plant2&amp;quot;&lt;/span&gt;, 
    &lt;span class=&quot;st&quot;&gt;&amp;quot;Plant2&amp;quot;&lt;/span&gt;), &lt;span class=&quot;dt&quot;&gt;Type =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;), &lt;span class=&quot;dt&quot;&gt;Axis1 =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;fl&quot;&gt;0.2&lt;/span&gt;, -&lt;span class=&quot;fl&quot;&gt;0.4&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;0.8&lt;/span&gt;, -&lt;span class=&quot;fl&quot;&gt;0.2&lt;/span&gt;, -&lt;span class=&quot;fl&quot;&gt;0.7&lt;/span&gt;, 
    &lt;span class=&quot;fl&quot;&gt;0.1&lt;/span&gt;), &lt;span class=&quot;dt&quot;&gt;Axis2 =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;fl&quot;&gt;0.5&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;0.3&lt;/span&gt;, -&lt;span class=&quot;fl&quot;&gt;0.1&lt;/span&gt;, -&lt;span class=&quot;fl&quot;&gt;0.3&lt;/span&gt;, -&lt;span class=&quot;fl&quot;&gt;0.1&lt;/span&gt;, -&lt;span class=&quot;fl&quot;&gt;0.8&lt;/span&gt;))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Using normal R graphics, we might do this:&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;color_foo &amp;lt;- &lt;span class=&quot;kw&quot;&gt;colorRampPalette&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;lightblue&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;darkblue&amp;quot;&lt;/span&gt;))
colors &amp;lt;- &lt;span class=&quot;kw&quot;&gt;color_foo&lt;/span&gt;(&lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;)

&lt;span class=&quot;kw&quot;&gt;plot&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;range&lt;/span&gt;(data.df[, &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;]), &lt;span class=&quot;kw&quot;&gt;range&lt;/span&gt;(data.df[, &lt;span class=&quot;dv&quot;&gt;4&lt;/span&gt;]), &lt;span class=&quot;dt&quot;&gt;xlab =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Axis 1&amp;quot;&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;ylab =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Axis 2&amp;quot;&lt;/span&gt;, 
    &lt;span class=&quot;dt&quot;&gt;type =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;n&amp;quot;&lt;/span&gt;)
&lt;span class=&quot;kw&quot;&gt;points&lt;/span&gt;(data.df$Axis1, data.df$Axis2, &lt;span class=&quot;dt&quot;&gt;pch =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;)[data.df$Plant], &lt;span class=&quot;dt&quot;&gt;col =&lt;/span&gt; colors[data.df$Type])
&lt;span class=&quot;kw&quot;&gt;legend&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;topright&amp;quot;&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;legend =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Plant1&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;Plant2&amp;quot;&lt;/span&gt;), &lt;span class=&quot;dt&quot;&gt;pch =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;:&lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;)
&lt;span class=&quot;kw&quot;&gt;legend&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;bottomright&amp;quot;&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;legend =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Type1&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;Type2&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;Type3&amp;quot;&lt;/span&gt;), &lt;span class=&quot;dt&quot;&gt;pch =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;20&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;col =&lt;/span&gt; colors)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/ggplotfigs/unnamed-chunk-4.png&quot; alt=&quot;plot of chunk unnamed-chunk-4&quot; /&gt;&lt;p class=&quot;caption&quot;&gt;plot of chunk unnamed-chunk-4&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;With &lt;code&gt;ggplot&lt;/code&gt;, you just do this:&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;kw&quot;&gt;ggplot&lt;/span&gt;(data.df, &lt;span class=&quot;kw&quot;&gt;aes&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;x =&lt;/span&gt; Axis1, &lt;span class=&quot;dt&quot;&gt;y =&lt;/span&gt; Axis2, &lt;span class=&quot;dt&quot;&gt;shape =&lt;/span&gt; Plant, &lt;span class=&quot;dt&quot;&gt;color =&lt;/span&gt; Type)) + &lt;span class=&quot;kw&quot;&gt;geom_point&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;size =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;5&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/ggplotfigs/unnamed-chunk-5.png&quot; alt=&quot;plot of chunk unnamed-chunk-5&quot; /&gt;&lt;p class=&quot;caption&quot;&gt;plot of chunk unnamed-chunk-5&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;And it looks much better!&lt;/p&gt;
&lt;p&gt;But &lt;code&gt;ggplot()&lt;/code&gt; really shines when you have a lot of data. Here’s an example of some fish survey data that I produced with it:&lt;/p&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/cohortplot.png&quot; alt=&quot;Sacramento splittail surveyed in Suisun Marsh, 1979-2011, data from Peter Moyle and Teejay O’Rear&quot; /&gt;&lt;p class=&quot;caption&quot;&gt;Sacramento splittail surveyed in Suisun Marsh, 1979-2011, data from Peter Moyle and Teejay O’Rear&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&quot;tutorial&quot;&gt;Tutorial&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;ggplot&lt;/code&gt; is best used on data in data frame form. Let’s look at a data set already in R, this about the sleep habits of different animal species&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;kw&quot;&gt;head&lt;/span&gt;(msleep)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;##                         name      genus  vore        order conservation
## 1                    Cheetah   Acinonyx carni    Carnivora           lc
## 2                 Owl monkey      Aotus  omni     Primates         &amp;lt;NA&amp;gt;
## 3            Mountain beaver Aplodontia herbi     Rodentia           nt
## 4 Greater short-tailed shrew    Blarina  omni Soricomorpha           lc
## 5                        Cow        Bos herbi Artiodactyla domesticated
## 6           Three-toed sloth   Bradypus herbi       Pilosa         &amp;lt;NA&amp;gt;
##   sleep_total sleep_rem sleep_cycle awake brainwt  bodywt
## 1        12.1        NA          NA  11.9      NA  50.000
## 2        17.0       1.8          NA   7.0 0.01550   0.480
## 3        14.4       2.4          NA   9.6      NA   1.350
## 4        14.9       2.3      0.1333   9.1 0.00029   0.019
## 5         4.0       0.7      0.6667  20.0 0.42300 600.000
## 6        14.4       2.2      0.7667   9.6      NA   3.850&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now, lets start with a basic plot. Let’s create a scatterplot of body weight against total hours sleep:&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;a &amp;lt;- &lt;span class=&quot;kw&quot;&gt;ggplot&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; msleep, &lt;span class=&quot;kw&quot;&gt;aes&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;x =&lt;/span&gt; bodywt, &lt;span class=&quot;dt&quot;&gt;y =&lt;/span&gt; sleep_total))
a &amp;lt;- a + &lt;span class=&quot;kw&quot;&gt;geom_point&lt;/span&gt;()
a &amp;lt;- a + &lt;span class=&quot;kw&quot;&gt;xlab&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Body Weight&amp;quot;&lt;/span&gt;) + &lt;span class=&quot;kw&quot;&gt;ylab&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Total Hours Sleep&amp;quot;&lt;/span&gt;) + &lt;span class=&quot;kw&quot;&gt;ggtitle&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Some Sleep Data&amp;quot;&lt;/span&gt;)
a&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/ggplotfigs/unnamed-chunk-7.png&quot; alt=&quot;plot of chunk unnamed-chunk-7&quot; /&gt;&lt;p class=&quot;caption&quot;&gt;plot of chunk unnamed-chunk-7&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Let’s parse what we just did. The &lt;code&gt;ggplot()&lt;/code&gt; command creates a plot object. In it we assigned a data set. &lt;code&gt;aes()&lt;/code&gt; creates what Hadley Wickham calls an &lt;em&gt;aesthetic&lt;/em&gt;: a mapping of variables to various parts of the plot.&lt;/p&gt;
&lt;p&gt;We then add components to the plot. &lt;code&gt;geom_point()&lt;/code&gt; adds a layer of points, using the base aesthetic mapping. The third line adds labels. Typing the variable name &lt;code&gt;a&lt;/code&gt; displays the plot. Alternately, one can use the command &lt;code&gt;ggsave()&lt;/code&gt; to save the plot as a file, as in&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;kw&quot;&gt;ggsave&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;sleepplot.png&amp;quot;&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;plot =&lt;/span&gt; a, &lt;span class=&quot;dt&quot;&gt;width =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;height =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;4&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now, one of the great things we can do with &lt;code&gt;ggplot&lt;/code&gt; is slice the data different ways. For instance, we can plot another variable against color:&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;a &amp;lt;- &lt;span class=&quot;kw&quot;&gt;ggplot&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; msleep, &lt;span class=&quot;kw&quot;&gt;aes&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;x =&lt;/span&gt; bodywt, &lt;span class=&quot;dt&quot;&gt;y =&lt;/span&gt; sleep_total, &lt;span class=&quot;dt&quot;&gt;col =&lt;/span&gt; vore))
a &amp;lt;- a + &lt;span class=&quot;kw&quot;&gt;geom_point&lt;/span&gt;()
a &amp;lt;- a + &lt;span class=&quot;kw&quot;&gt;xlab&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Body Weight&amp;quot;&lt;/span&gt;) + &lt;span class=&quot;kw&quot;&gt;ylab&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Total Hours Sleep&amp;quot;&lt;/span&gt;) + &lt;span class=&quot;kw&quot;&gt;ggtitle&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Some Sleep Data&amp;quot;&lt;/span&gt;)
a&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/ggplotfigs/unnamed-chunk-9.png&quot; alt=&quot;plot of chunk unnamed-chunk-9&quot; /&gt;&lt;p class=&quot;caption&quot;&gt;plot of chunk unnamed-chunk-9&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;You can also use map &lt;em&gt;size&lt;/em&gt; and &lt;em&gt;alpha&lt;/em&gt; (transparency) to variables.&lt;/p&gt;
&lt;p&gt;We can transform variables directly in the &lt;code&gt;ggplot&lt;/code&gt; call, as well:&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;a &amp;lt;- &lt;span class=&quot;kw&quot;&gt;ggplot&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; msleep, &lt;span class=&quot;kw&quot;&gt;aes&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;x =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;log&lt;/span&gt;(bodywt), &lt;span class=&quot;dt&quot;&gt;y =&lt;/span&gt; sleep_rem/sleep_total, &lt;span class=&quot;dt&quot;&gt;col =&lt;/span&gt; vore))
a &amp;lt;- a + &lt;span class=&quot;kw&quot;&gt;geom_point&lt;/span&gt;()
a &amp;lt;- a + &lt;span class=&quot;kw&quot;&gt;xlab&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Log Body Weight&amp;quot;&lt;/span&gt;) + &lt;span class=&quot;kw&quot;&gt;ylab&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Fraction of Sleep that is REM&amp;quot;&lt;/span&gt;) + &lt;span class=&quot;kw&quot;&gt;ggtitle&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Some Sleep Data&amp;quot;&lt;/span&gt;) + 
    &lt;span class=&quot;kw&quot;&gt;scale_color_discrete&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;name =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Trophic Level&amp;quot;&lt;/span&gt;)
a&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/ggplotfigs/unnamed-chunk-10.png&quot; alt=&quot;plot of chunk unnamed-chunk-10&quot; /&gt;&lt;p class=&quot;caption&quot;&gt;plot of chunk unnamed-chunk-10&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Within the &lt;code&gt;geom&lt;/code&gt; calls, we can change plotting options&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;a &amp;lt;- &lt;span class=&quot;kw&quot;&gt;ggplot&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; msleep, &lt;span class=&quot;kw&quot;&gt;aes&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;x =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;log&lt;/span&gt;(bodywt), &lt;span class=&quot;dt&quot;&gt;y =&lt;/span&gt; sleep_rem/sleep_total, &lt;span class=&quot;dt&quot;&gt;col =&lt;/span&gt; vore))
a &amp;lt;- a + &lt;span class=&quot;kw&quot;&gt;geom_point&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;size =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;5&lt;/span&gt;)
a &amp;lt;- a + &lt;span class=&quot;kw&quot;&gt;xlab&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Log Body Weight&amp;quot;&lt;/span&gt;) + &lt;span class=&quot;kw&quot;&gt;ylab&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Fraction of Sleep that is REM&amp;quot;&lt;/span&gt;) + &lt;span class=&quot;kw&quot;&gt;ggtitle&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Some Sleep Data&amp;quot;&lt;/span&gt;) + 
    &lt;span class=&quot;kw&quot;&gt;scale_color_discrete&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;name =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Trophic Level&amp;quot;&lt;/span&gt;)
a&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/ggplotfigs/unnamed-chunk-11.png&quot; alt=&quot;plot of chunk unnamed-chunk-11&quot; /&gt;&lt;p class=&quot;caption&quot;&gt;plot of chunk unnamed-chunk-11&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Another way to split up the way we look at data is with &lt;em&gt;facets&lt;/em&gt;. These break up the plot into multiple plots. If you are splitting the plot up by one variable, use &lt;code&gt;facet_wrap&lt;/code&gt;. If you are using two variables, use &lt;code&gt;facet_grid&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;a &amp;lt;- &lt;span class=&quot;kw&quot;&gt;ggplot&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; msleep, &lt;span class=&quot;kw&quot;&gt;aes&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;x =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;log&lt;/span&gt;(bodywt), &lt;span class=&quot;dt&quot;&gt;y =&lt;/span&gt; sleep_rem/sleep_total))
a &amp;lt;- a + &lt;span class=&quot;kw&quot;&gt;geom_point&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;size =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;5&lt;/span&gt;)
a &amp;lt;- a + &lt;span class=&quot;kw&quot;&gt;facet_wrap&lt;/span&gt;(~vore)
a &amp;lt;- a + &lt;span class=&quot;kw&quot;&gt;xlab&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Log Body Weight&amp;quot;&lt;/span&gt;) + &lt;span class=&quot;kw&quot;&gt;ylab&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Fraction of Sleep that is REM&amp;quot;&lt;/span&gt;) + &lt;span class=&quot;kw&quot;&gt;ggtitle&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Some Sleep Data&amp;quot;&lt;/span&gt;)
a&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/ggplotfigs/unnamed-chunk-12.png&quot; alt=&quot;plot of chunk unnamed-chunk-12&quot; /&gt;&lt;p class=&quot;caption&quot;&gt;plot of chunk unnamed-chunk-12&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;a &amp;lt;- &lt;span class=&quot;kw&quot;&gt;ggplot&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; msleep, &lt;span class=&quot;kw&quot;&gt;aes&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;x =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;log&lt;/span&gt;(bodywt), &lt;span class=&quot;dt&quot;&gt;y =&lt;/span&gt; sleep_rem/sleep_total))
a &amp;lt;- a + &lt;span class=&quot;kw&quot;&gt;geom_point&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;size =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;)
a &amp;lt;- a + &lt;span class=&quot;kw&quot;&gt;facet_grid&lt;/span&gt;(conservation ~ vore)
a &amp;lt;- a + &lt;span class=&quot;kw&quot;&gt;xlab&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Log Body Weight&amp;quot;&lt;/span&gt;) + &lt;span class=&quot;kw&quot;&gt;ylab&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Fraction of Sleep that is REM&amp;quot;&lt;/span&gt;) + &lt;span class=&quot;kw&quot;&gt;ggtitle&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Some Sleep Data&amp;quot;&lt;/span&gt;)
a&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/ggplotfigs/unnamed-chunk-13.png&quot; alt=&quot;plot of chunk unnamed-chunk-13&quot; /&gt;&lt;p class=&quot;caption&quot;&gt;plot of chunk unnamed-chunk-13&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Let’s use a different data set to so line plots:&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;kw&quot;&gt;head&lt;/span&gt;(economics)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;##         date   pce    pop psavert uempmed unemploy
## 1 1967-06-30 507.8 198712     9.8     4.5     2944
## 2 1967-07-31 510.9 198911     9.8     4.7     2945
## 3 1967-08-31 516.7 199113     9.0     4.6     2958
## 4 1967-09-30 513.3 199311     9.8     4.9     3143
## 5 1967-10-31 518.5 199498     9.7     4.7     3066
## 6 1967-11-30 526.2 199657     9.4     4.8     3018&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;a &amp;lt;- &lt;span class=&quot;kw&quot;&gt;ggplot&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; economics, &lt;span class=&quot;kw&quot;&gt;aes&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;x =&lt;/span&gt; date, &lt;span class=&quot;dt&quot;&gt;y =&lt;/span&gt; unemploy))
a &amp;lt;- a + &lt;span class=&quot;kw&quot;&gt;geom_line&lt;/span&gt;()
a&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/ggplotfigs/unnamed-chunk-14.png&quot; alt=&quot;plot of chunk unnamed-chunk-14&quot; /&gt;&lt;p class=&quot;caption&quot;&gt;plot of chunk unnamed-chunk-14&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;We can add statistical transformations to this series, for instance:&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;a &amp;lt;- &lt;span class=&quot;kw&quot;&gt;ggplot&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; economics, &lt;span class=&quot;kw&quot;&gt;aes&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;x =&lt;/span&gt; date, &lt;span class=&quot;dt&quot;&gt;y =&lt;/span&gt; unemploy))
a &amp;lt;- a + &lt;span class=&quot;kw&quot;&gt;geom_line&lt;/span&gt;()
a &amp;lt;- a + &lt;span class=&quot;kw&quot;&gt;geom_smooth&lt;/span&gt;()
a&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;## geom_smooth: method=&amp;quot;auto&amp;quot; and size of largest group is &amp;lt;1000, so using
## loess. Use &amp;#39;method = x&amp;#39; to change the smoothing method.&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/ggplotfigs/unnamed-chunk-15.png&quot; alt=&quot;plot of chunk unnamed-chunk-15&quot; /&gt;&lt;p class=&quot;caption&quot;&gt;plot of chunk unnamed-chunk-15&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&quot;some-resources&quot;&gt;Some resources:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://ggplot2.org/&quot;&gt;The main ggplot website, including documentation and excerpts from the book&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;Note that that the full book is not available at that website. However you can get it online via the UCD library &lt;a href=&quot;http://dx.doi.org/10.1007/978-0-387-98141-3&quot;&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;The &lt;a href=&quot;http://learnr.wordpress.com/&quot;&gt;Learn R&lt;/a&gt; blog has some great examples.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://sape.inf.usi.ch/quick-reference/ggplot2&quot;&gt;A quick reference website that’s easier to understand than the documentation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.echen.me/2012/01/17/quick-introduction-to-ggplot2/&quot;&gt;A quick intro on a blog&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/hadley/ggplot2/wiki/-opts()-List&quot;&gt;A key to the many obscure display options&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;The latest version of ggplot has an updated “themes” system by which you can modify many aspects of the cart just by adding &lt;code&gt;+ theme_x()&lt;/code&gt;. Details &lt;a href=&quot;http://sape.inf.usi.ch/quick-reference/ggplot2/themes&quot;&gt;here&lt;/a&gt; and updates in the new version &lt;a href=&quot;https://github.com/wch/ggplot2/wiki/New-theme-system&quot;&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Some &lt;a href=&quot;https://github.com/jrnold/ggthemes&quot;&gt;nice themes&lt;/a&gt; and an &lt;a href=&quot;http://stackoverflow.com/questions/12675147/how-can-we-make-xkcd-style-graphs-in-r&quot;&gt;XKCD theme!&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content>
 </entry>
 
 <entry>
   <title>An R Users' Group in Davis</title>
   <link href="http://www.noamross.net/blog/2012/9/24/a-new-r-users--group.html"/>
   <updated>2012-09-24T11:05:27-07:00</updated>
   <id>hhttp://www.noamross.net/blog/2012/9/24/a-new-r-users--group</id>
   <content type="html">&lt;head&gt;
  &lt;style type=&quot;text/css&quot;  media=&quot;all&quot;&gt;
    table tbody {border-top:2px; border-bottom:2px;}
    table thead {border-bottom:1px;}
  &lt;/style&gt;
&lt;/head&gt; &lt;p&gt;I’m excited to share that we’ve started a new R users’ group at UC Davis! Right now our main purpose is to run weekly 2-hour work/hack sessions where R users can get together to work through problems together. More info &lt;a href=&quot;http://www.noamross.net/davis-r-users-group.html&quot;&gt;here&lt;/a&gt;&lt;/p&gt;</content>
 </entry>
 
 <entry>
   <title>Exploring Pollen Data</title>
   <link href="http://www.noamross.net/blog/2012/4/2/exploring-pollen-data-knit.html"/>
   <updated>2012-04-02T15:06:18-07:00</updated>
   <id>hhttp://www.noamross.net/blog/2012/4/2/exploring-pollen-data-knit</id>
   <content type="html">&lt;head&gt;
  &lt;style type=&quot;text/css&quot;  media=&quot;all&quot;&gt;
    table tbody {border-top:2px; border-bottom:2px;}
    table thead {border-bottom:1px;}
  &lt;/style&gt;
&lt;/head&gt; &lt;p&gt;I wrote a &lt;a href=&quot;https://github.com/noamross/Pollen/commit/a7ebd4a9f46466da4c420b9437c73f8b185be56b#pollendatafuntions.R&quot;&gt;few functions&lt;/a&gt; to grab data and from the &lt;a href=&quot;http://www.ncdc.noaa.gov/paleo/gpd.html&quot;&gt;Global Pollen Database&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;kw&quot;&gt;source&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;~/code/_Pollen/pollendatafuntions.R&amp;quot;&lt;/span&gt;)
## Loading required package: stratigraph
## Loading required package: grid
## Loading required package: graphics
## Loading required package: stats
billys &amp;lt;- &lt;span class=&quot;kw&quot;&gt;getpctAP&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;billys&amp;quot;&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;plot =&lt;/span&gt; &lt;span class=&quot;ot&quot;&gt;TRUE&lt;/span&gt;)
## Number of taxa:  105 
## Number of levels:  77 &lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/a.png&quot; alt=&quot;Arboreal Pollen over time at Billy’s Lake&quot; /&gt;&lt;p class=&quot;caption&quot;&gt;Arboreal Pollen over time at Billy’s Lake&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Clearly, there’s are trends at different time scales. The trouble with using S-Maps on this is that there are uneven sampling intervals. One option is to use linear interpolation to approximate even intervals:&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;billyslin &amp;lt;- &lt;span class=&quot;kw&quot;&gt;linpctAP&lt;/span&gt;(billys, &lt;span class=&quot;dt&quot;&gt;ts =&lt;/span&gt; &lt;span class=&quot;ot&quot;&gt;FALSE&lt;/span&gt;)
billys &amp;lt;- &lt;span class=&quot;kw&quot;&gt;getpctAP&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;billys&amp;quot;&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;plot =&lt;/span&gt; &lt;span class=&quot;ot&quot;&gt;TRUE&lt;/span&gt;)
## Number of taxa:  105 
## Number of levels:  77 
&lt;span class=&quot;kw&quot;&gt;lines&lt;/span&gt;(billyslin[, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;], billyslin[, &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;], &lt;span class=&quot;dt&quot;&gt;col =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;)
&lt;span class=&quot;kw&quot;&gt;points&lt;/span&gt;(billyslin[, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;], billyslin[, &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;], &lt;span class=&quot;dt&quot;&gt;col =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;, 
    &lt;span class=&quot;dt&quot;&gt;pch =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;16&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/b.png&quot; alt=&quot;With linearly interpolated evenly spaced samples&quot; /&gt;&lt;p class=&quot;caption&quot;&gt;With linearly interpolated evenly spaced samples&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;This means introducing a new source of error into whatever model is ultimately used. What interval should be used to generate this? Here I created an equal number of points as are in the original data set. However, the sampling density is greater at more recent dates. S-Maps can handle missing data, but there need to be a good chunk of consecutive points.&lt;/p&gt;
&lt;p&gt;The other option is start thinking about how to generalize S-Maps for data sampled at unequal intervals.&lt;/p&gt;</content>
 </entry>
 
 
</feed>