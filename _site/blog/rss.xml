<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
 
 <title>Noam Ross</title>
 <link href="http://www.noamross.net/blog/rss.xml" rel="self"/>
 <link href="http://www.noamross.net"/>
 <updated>2013-03-14T14:10:08-07:00</updated>
 <id>http://www.noamross.net</id>
 <author>
   <name>Noam Ross</name>
   <email>noam.ross@gmail.com</email>
 </author>

 
 <entry>
   <title>Model Selection and Multi-Model Inference</title>
   <link href="http://www.noamross.net/blog/2013/2/20/model-selection-drug.html"/>
   <updated>2013-02-20T17:14:43-08:00</updated>
   <id>hhttp://www.noamross.net/blog/2013/2/20/model-selection-drug</id>
   <content type="html">&lt;head&gt;
  &lt;style type=&quot;text/css&quot;  media=&quot;all&quot;&gt;
    table tbody {border-top:2px; border-bottom:2px;}
    table thead {border-bottom:1px;}
  &lt;/style&gt;
&lt;/head&gt; &lt;p&gt;&lt;em&gt;At &lt;a href=&quot;http://www.noamross.net/davis-r-users-group.html&quot;&gt;D-RUG&lt;/a&gt; this week &lt;a href=&quot;rosehartman@gmail.com&quot;&gt;Rosemary Hartman&lt;/a&gt; presented a really useful case study in model selection, based on her work on frog habitat. Here is her code run through ‘knitr’. Original code and data are posted &lt;a href=&quot;https://gist.github.com/noamross/5001172&quot;&gt;here&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;(yes, I am just doing this for the flying monkey)&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Editor’s note: we’re giving away flying monkey dolls from our sponsor, &lt;a href=&quot;revolutionanalytics.com&quot;&gt;Revolution Analytics&lt;/a&gt;, to all our D-RUG presenters.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;So, let’s say you want to find out where things are and why they are there. But there are a lot of reasons someone might be somewhere&lt;/p&gt;
&lt;p&gt;Let’s say these things are fishermen, And we aren’t sure what the reasons are yet.&lt;/p&gt;
&lt;p&gt;Start by making some good guesses. Maybe they all go to the big lakes. Maybe they all go to the lakes that CDFW stocks with fish. Maybe they go to the lakes with lots of frogs (not likely, but hey, why not try?) Once you have all your guesses, you need to figure out which one is right. There are two basic methods to use (or two that I have been exploring)&lt;/p&gt;
&lt;p&gt;Method #1: The kitchen sink&lt;/p&gt;
&lt;p&gt;load package “glmulti”&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;kw&quot;&gt;library&lt;/span&gt;(glmulti)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;load the data&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;lakes.df2 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;read.csv&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;lakes.df2.csv&amp;quot;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;create a model that has all the predictor variables you would like to test&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;global.model &amp;lt;-&lt;span class=&quot;st&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(fish~&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;co&quot;&gt;# number of fishermen&lt;/span&gt;
&lt;span class=&quot;st&quot;&gt;                       &lt;/span&gt;stocked+&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;co&quot;&gt;# CDFW fish stocking y/n&lt;/span&gt;
&lt;span class=&quot;st&quot;&gt;                       &lt;/span&gt;cows+&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;co&quot;&gt;# cattle grazing in area y/n&lt;/span&gt;
&lt;span class=&quot;st&quot;&gt;                       &lt;/span&gt;herp.rich+&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;co&quot;&gt;# amphibian species richness&lt;/span&gt;
&lt;span class=&quot;st&quot;&gt;                       &lt;/span&gt;fish.rich+&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;co&quot;&gt;# fish species richness&lt;/span&gt;
&lt;span class=&quot;st&quot;&gt;                       &lt;/span&gt;visitors+&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;co&quot;&gt;# total number of visitors&lt;/span&gt;
&lt;span class=&quot;st&quot;&gt;                       &lt;/span&gt;logsize, &lt;span class=&quot;co&quot;&gt;# log of the area&lt;/span&gt;
                     &lt;span class=&quot;dt&quot;&gt;data=&lt;/span&gt;lakes.df2) &lt;span class=&quot;co&quot;&gt;# data frame we got this from&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now we will use the “glmulti” function to find the best model; this goes through every possible model and finds the best one.&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;fish.model &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glmulti&lt;/span&gt;(global.model, &lt;span class=&quot;co&quot;&gt;# use the model with built as a starting point&lt;/span&gt;
                      &lt;span class=&quot;dt&quot;&gt;level =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;,  &lt;span class=&quot;co&quot;&gt;#  just look at main effects&lt;/span&gt;
                      &lt;span class=&quot;dt&quot;&gt;crit=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;aicc&amp;quot;&lt;/span&gt;) &lt;span class=&quot;co&quot;&gt;# use AICc because it works better than AIC for small sample sizes&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;## Initialization...
## TASK: Exhaustive screening of candidate set.
## Fitting...
## 
## After 50 models:
## Best model: fish~1+cows+herp.rich+visitors+logsize
## Crit= 201.820969266156
## Mean crit= 355.848076682524&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/unnamed-chunk-4.png&quot; /&gt;
&lt;/div&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;## Completed.&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;
&lt;span class=&quot;kw&quot;&gt;summary&lt;/span&gt;(fish.model)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;## $name
## [1] &amp;quot;glmulti.analysis&amp;quot;
## 
## $method
## [1] &amp;quot;h&amp;quot;
## 
## $fitting
## [1] &amp;quot;glm&amp;quot;
## 
## $crit
## [1] &amp;quot;aicc&amp;quot;
## 
## $level
## [1] 1
## 
## $marginality
## [1] FALSE
## 
## $confsetsize
## [1] 100
## 
## $bestic
## [1] 201.8
## 
## $icvalues
##  [1] 201.8 203.4 204.7 205.0 206.4 206.5 206.5 208.3 225.4 227.7 230.6
## [12] 231.2 232.7 233.2 233.5 235.1 236.0 236.4 238.2 238.3 238.4 238.8
## [23] 240.7 240.9 258.2 259.3 260.2 261.0 261.1 261.7 262.0 262.6 265.1
## [34] 267.6 268.1 270.5 276.0 277.4 278.3 279.8 310.2 311.5 313.6 314.0
## [45] 315.4 316.2 319.0 319.7 500.6 502.0 502.5 503.0 503.8 504.8 511.3
## [56] 513.2 599.7 601.4 610.5 614.9 615.3 624.1 629.2 638.6
## 
## $bestmodel
## [1] &amp;quot;fish ~ 1 + cows + herp.rich + visitors + logsize&amp;quot;
## 
## $modelweights
##  [1] 4.485e-01 2.024e-01 1.075e-01 9.285e-02 4.464e-02 4.343e-02 4.310e-02
##  [8] 1.767e-02 3.399e-06 1.065e-06 2.477e-07 1.895e-07 8.849e-08 6.754e-08
## [15] 6.011e-08 2.630e-08 1.704e-08 1.404e-08 5.716e-09 5.287e-09 4.990e-09
## [22] 4.134e-09 1.618e-09 1.436e-09 2.540e-13 1.465e-13 9.334e-14 6.306e-14
## [29] 5.969e-14 4.361e-14 3.790e-14 2.885e-14 8.119e-15 2.304e-15 1.837e-15
## [36] 5.540e-16 3.542e-17 1.739e-17 1.096e-17 5.151e-18 1.300e-24 7.003e-25
## [43] 2.397e-25 1.957e-25 9.964e-26 6.413e-26 1.594e-26 1.123e-26 5.852e-66
## [50] 2.976e-66 2.260e-66 1.801e-66 1.220e-66 7.203e-67 2.847e-68 1.069e-68
## [57] 1.836e-87 7.713e-88 8.222e-90 9.195e-91 7.394e-91 9.070e-93 7.028e-94
## [64] 6.396e-96
## 
## $includeobjects
## [1] TRUE&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;That showed us the best model, now lets look at some of the others&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;kw&quot;&gt;weightable&lt;/span&gt;(fish.model)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;##                                                                     model
## 1                        fish ~ 1 + cows + herp.rich + visitors + logsize
## 2            fish ~ 1 + cows + herp.rich + fish.rich + visitors + logsize
## 3              fish ~ 1 + stocked + cows + herp.rich + visitors + logsize
## 4                                    fish ~ 1 + cows + visitors + logsize
## 5                        fish ~ 1 + cows + fish.rich + visitors + logsize
## 6                          fish ~ 1 + stocked + cows + visitors + logsize
## 7  fish ~ 1 + stocked + cows + herp.rich + fish.rich + visitors + logsize
## 8              fish ~ 1 + stocked + cows + fish.rich + visitors + logsize
## 9                         fish ~ 1 + stocked + cows + herp.rich + logsize
## 10            fish ~ 1 + stocked + cows + herp.rich + fish.rich + logsize
## 11                                  fish ~ 1 + cows + herp.rich + logsize
## 12                                    fish ~ 1 + stocked + cows + logsize
## 13                                              fish ~ 1 + cows + logsize
## 14                      fish ~ 1 + cows + herp.rich + fish.rich + logsize
## 15                        fish ~ 1 + stocked + cows + fish.rich + logsize
## 16                                  fish ~ 1 + cows + fish.rich + logsize
## 17                              fish ~ 1 + herp.rich + visitors + logsize
## 18                                          fish ~ 1 + visitors + logsize
## 19                  fish ~ 1 + herp.rich + fish.rich + visitors + logsize
## 20                              fish ~ 1 + fish.rich + visitors + logsize
## 21                    fish ~ 1 + stocked + herp.rich + visitors + logsize
## 22                                fish ~ 1 + stocked + visitors + logsize
## 23        fish ~ 1 + stocked + herp.rich + fish.rich + visitors + logsize
## 24                    fish ~ 1 + stocked + fish.rich + visitors + logsize
## 25                     fish ~ 1 + cows + herp.rich + fish.rich + visitors
## 26                                 fish ~ 1 + cows + herp.rich + visitors
## 27           fish ~ 1 + stocked + cows + herp.rich + fish.rich + visitors
## 28                                 fish ~ 1 + cows + fish.rich + visitors
## 29                       fish ~ 1 + stocked + cows + herp.rich + visitors
## 30                                             fish ~ 1 + cows + visitors
## 31                       fish ~ 1 + stocked + cows + fish.rich + visitors
## 32                                   fish ~ 1 + stocked + cows + visitors
## 33                               fish ~ 1 + stocked + herp.rich + logsize
## 34                   fish ~ 1 + stocked + herp.rich + fish.rich + logsize
## 35                                           fish ~ 1 + stocked + logsize
## 36                               fish ~ 1 + stocked + fish.rich + logsize
## 37                                                     fish ~ 1 + logsize
## 38                                         fish ~ 1 + herp.rich + logsize
## 39                                         fish ~ 1 + fish.rich + logsize
## 40                             fish ~ 1 + herp.rich + fish.rich + logsize
## 41                      fish ~ 1 + stocked + cows + herp.rich + fish.rich
## 42                                  fish ~ 1 + stocked + cows + fish.rich
## 43                                            fish ~ 1 + cows + fish.rich
## 44                                fish ~ 1 + cows + herp.rich + fish.rich
## 45                                  fish ~ 1 + stocked + cows + herp.rich
## 46                                              fish ~ 1 + stocked + cows
## 47                                                        fish ~ 1 + cows
## 48                                            fish ~ 1 + cows + herp.rich
## 49                            fish ~ 1 + herp.rich + fish.rich + visitors
## 50                  fish ~ 1 + stocked + herp.rich + fish.rich + visitors
## 51                                        fish ~ 1 + herp.rich + visitors
## 52                                        fish ~ 1 + fish.rich + visitors
## 53                              fish ~ 1 + stocked + herp.rich + visitors
## 54                              fish ~ 1 + stocked + fish.rich + visitors
## 55                                                    fish ~ 1 + visitors
## 56                                          fish ~ 1 + stocked + visitors
## 57                             fish ~ 1 + stocked + herp.rich + fish.rich
## 58                                         fish ~ 1 + stocked + fish.rich
## 59                                         fish ~ 1 + stocked + herp.rich
## 60                                                   fish ~ 1 + fish.rich
## 61                                       fish ~ 1 + herp.rich + fish.rich
## 62                                                     fish ~ 1 + stocked
## 63                                                   fish ~ 1 + herp.rich
## 64                                                               fish ~ 1
##     aicc   weights
## 1  201.8 4.485e-01
## 2  203.4 2.024e-01
## 3  204.7 1.075e-01
## 4  205.0 9.285e-02
## 5  206.4 4.464e-02
## 6  206.5 4.343e-02
## 7  206.5 4.310e-02
## 8  208.3 1.767e-02
## 9  225.4 3.399e-06
## 10 227.7 1.065e-06
## 11 230.6 2.477e-07
## 12 231.2 1.895e-07
## 13 232.7 8.849e-08
## 14 233.2 6.754e-08
## 15 233.5 6.011e-08
## 16 235.1 2.630e-08
## 17 236.0 1.704e-08
## 18 236.4 1.404e-08
## 19 238.2 5.716e-09
## 20 238.3 5.287e-09
## 21 238.4 4.990e-09
## 22 238.8 4.134e-09
## 23 240.7 1.618e-09
## 24 240.9 1.436e-09
## 25 258.2 2.540e-13
## 26 259.3 1.465e-13
## 27 260.2 9.334e-14
## 28 261.0 6.306e-14
## 29 261.1 5.969e-14
## 30 261.7 4.361e-14
## 31 262.0 3.790e-14
## 32 262.6 2.885e-14
## 33 265.1 8.119e-15
## 34 267.6 2.304e-15
## 35 268.1 1.837e-15
## 36 270.5 5.540e-16
## 37 276.0 3.542e-17
## 38 277.4 1.739e-17
## 39 278.3 1.096e-17
## 40 279.8 5.151e-18
## 41 310.2 1.300e-24
## 42 311.5 7.003e-25
## 43 313.6 2.397e-25
## 44 314.0 1.957e-25
## 45 315.4 9.964e-26
## 46 316.2 6.413e-26
## 47 319.0 1.594e-26
## 48 319.7 1.123e-26
## 49 500.6 5.852e-66
## 50 502.0 2.976e-66
## 51 502.5 2.260e-66
## 52 503.0 1.801e-66
## 53 503.8 1.220e-66
## 54 504.8 7.203e-67
## 55 511.3 2.847e-68
## 56 513.2 1.069e-68
## 57 599.7 1.836e-87
## 58 601.4 7.713e-88
## 59 610.5 8.222e-90
## 60 614.9 9.195e-91
## 61 615.3 7.394e-91
## 62 624.1 9.070e-93
## 63 629.2 7.028e-94
## 64 638.6 6.396e-96&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So this is the best model&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;f &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(fish ~&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt; +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;cows +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;herp.rich +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;visitors +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;logsize, &lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; lakes.df2)
&lt;span class=&quot;kw&quot;&gt;summary&lt;/span&gt;(f)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;## 
## Call:
## glm(formula = fish ~ 1 + cows + herp.rich + visitors + logsize, 
##     data = lakes.df2)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -4.744  -1.350  -0.243   0.986  10.483  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&amp;gt;|t|)    
## (Intercept)  -0.5262     0.8914   -0.59    0.559    
## cowsy        -1.5214     1.2088   -1.26    0.217    
## herp.rich     0.7614     0.3219    2.37    0.024 *  
## visitors      0.1799     0.0277    6.49  1.8e-07 ***
## logsize       1.0498     1.1590    0.91    0.371    
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1 
## 
## (Dispersion parameter for gaussian family taken to be 7.225)
## 
##     Null deviance: 791.60  on 39  degrees of freedom
## Residual deviance: 252.87  on 35  degrees of freedom
##   (79 observations deleted due to missingness)
## AIC: 199.3
## 
## Number of Fisher Scoring iterations: 2&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I hate trying to interpret models based on tables of coeficients. Let’s look at some graphs&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;kw&quot;&gt;library&lt;/span&gt;(visreg)
&lt;span class=&quot;kw&quot;&gt;visreg&lt;/span&gt;(f)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/unnamed-chunk-71.png&quot; /&gt; &lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/unnamed-chunk-72.png&quot; /&gt; &lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/unnamed-chunk-73.png&quot; /&gt; &lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/unnamed-chunk-74.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;But according to theory, models with AIC within two points of each other are basically equal. So what about the other models? Should we totally throw them out? Looking at the table of aicc weights, there is a pretty big jump between model 8 and model 9. So lets try averaging the top 8 models if we want to use this to make predictions, evaluate variable importance, etc.&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;kw&quot;&gt;library&lt;/span&gt;(MuMIn)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;run the top 8 models&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;f2 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(fish ~&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt; +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;cows +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;herp.rich +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;fish.rich +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;visitors +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;logsize, &lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; lakes.df2)
f3 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(fish ~&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt; +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;stocked +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;cows +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;herp.rich +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;visitors +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;logsize, &lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; lakes.df2)
f4 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(fish ~&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt; +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;cows +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;visitors +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;logsize, &lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; lakes.df2)
f5 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(fish ~&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt; +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;cows +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;fish.rich +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;visitors +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;logsize, &lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; lakes.df2)
f6 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(fish ~&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt; +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;stocked +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;cows +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;visitors +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;logsize, &lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; lakes.df2)
f7 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(fish ~&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt; +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;stocked +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;cows +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;herp.rich +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;fish.rich +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;visitors +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;logsize, 
    &lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; lakes.df2)
f8 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(fish ~&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt; +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;stocked +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;cows +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;fish.rich +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;visitors +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;logsize, &lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; lakes.df2)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;average the models together&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;f.ave &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;model.avg&lt;/span&gt;(f, f2, f3, f4, f5, f6, f7, f8)
&lt;span class=&quot;kw&quot;&gt;summary&lt;/span&gt;(f.ave)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;## 
## Call:
## model.avg.default(object = f, f2, f3, f4, f5, f6, f7, f8)
## 
## Component models:
##        df logLik  AICc Delta Weight
## 1346    6 -93.64 201.8  0.00   0.45
## 12346   7 -92.96 203.4  1.59   0.20
## 13456   7 -93.59 204.7  2.86   0.11
## 146     5 -96.60 205.0  3.15   0.09
## 1246    6 -95.95 206.4  4.61   0.04
## 1456    6 -95.97 206.5  4.67   0.04
## 123456  8 -92.93 206.5  4.68   0.04
## 12456   7 -95.39 208.3  6.47   0.02
## 
## Term codes:
##      cows fish.rich herp.rich   logsize   stocked  visitors 
##         1         2         3         4         5         6 
## 
## Model-averaged coefficients: 
##             Estimate Std. Error Adjusted SE z value Pr(&amp;gt;|z|)    
## (Intercept)  -0.5422     1.2363      1.2673    0.43    0.669    
## cowsy        -1.3751     1.2596      1.3019    1.06    0.291    
## herp.rich     0.7523     0.3274      0.3393    2.22    0.027 *  
## visitors      0.1841     0.0305      0.0316    5.83   &amp;lt;2e-16 ***
## logsize       0.7763     1.2689      1.3119    0.59    0.554    
## fish.rich     0.7784     0.7245      0.7512    1.04    0.300    
## stockedy     -0.7316     1.6009      1.6539    0.44    0.658    
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1 
## 
## Full model-averaged coefficients (with shrinkage): 
##  (Intercept)  cowsy herp.rich visitors logsize fish.rich stockedy
##       -0.542 -1.375     0.603    0.184   0.776     0.240   -0.155
## 
## Relative variable importance:
##      cows   logsize  visitors herp.rich fish.rich   stocked 
##      1.00      1.00      1.00      0.80      0.31      0.21&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now we know the relative variable importance, all of the avereged coefficents, etc, and can use the “predict” funciton to predict how many fishermen will be at the next lake. Graphing these are more difficult, so we’ll skip this for now. Ask me later if you really want to know.&lt;/p&gt;
&lt;p&gt;Model selection method #2: Use your brain We often can discard (or choose) some models a priori based on our knowlege of the system. It’s usually better to do it this way if you have several hundered possible combination of variables, or want to put in some interaction terms. I used this method for my frog data. load package bbmle&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;kw&quot;&gt;library&lt;/span&gt;(bbmle)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;load the data&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;fishlakes &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;read.csv&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;fishlakes.csv&amp;quot;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Decide on which set of models you want to use. This is hard. A statistician who knows a lot more than I do told me so. I spent a long time playing around with different transformations, predictor variables, and combinations before I came up with a set of hypotheses (models) that I was happy with.&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;m1 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(treatment ~&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt; +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;logveg +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;bank.slope, &lt;span class=&quot;dt&quot;&gt;family =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;binomial&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;logit&amp;quot;&lt;/span&gt;), &lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; fishlakes)
m2 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(treatment ~&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt; +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;logveg +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;silt.total +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;bank.slope, &lt;span class=&quot;dt&quot;&gt;family =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;binomial&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;logit&amp;quot;&lt;/span&gt;), 
    &lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; fishlakes)
m3 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(treatment ~&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt; +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;raca.basin +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;logveg +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;bank.slope, &lt;span class=&quot;dt&quot;&gt;family =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;binomial&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;logit&amp;quot;&lt;/span&gt;), 
    &lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; fishlakes)
m4 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(treatment ~&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt; +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;BUBO.breeding +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;logveg +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;bank.slope, &lt;span class=&quot;dt&quot;&gt;family =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;binomial&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;logit&amp;quot;&lt;/span&gt;), 
    &lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; fishlakes)
m5 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(treatment ~&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt; +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;BUBO.breeding +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;logveg +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;bank.slope +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;raca.basin, 
    &lt;span class=&quot;dt&quot;&gt;family =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;binomial&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;logit&amp;quot;&lt;/span&gt;), &lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; fishlakes)
m6 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(treatment ~&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt; +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;raca.basin *&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;BUBO.breeding, &lt;span class=&quot;dt&quot;&gt;family =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;binomial&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;logit&amp;quot;&lt;/span&gt;), 
    &lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; fishlakes)
m7 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(treatment ~&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt; +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;herbacious +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;raca.basin +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;lakes.basin, &lt;span class=&quot;dt&quot;&gt;family =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;binomial&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;logit&amp;quot;&lt;/span&gt;), 
    &lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; fishlakes)
m8 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(treatment ~&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt; +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;BUBO.breeding, &lt;span class=&quot;dt&quot;&gt;family =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;binomial&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;logit&amp;quot;&lt;/span&gt;), &lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; fishlakes)
m9 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(treatment ~&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;BUBO.breeding +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;herbacious +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;bank.slope +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;logveg, &lt;span class=&quot;dt&quot;&gt;family =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;binomial&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;logit&amp;quot;&lt;/span&gt;), 
    &lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; fishlakes)
m10 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(treatment ~&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;BUBO.breeding *&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;raca.basin +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;herbacious +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;lakes.basin, 
    &lt;span class=&quot;dt&quot;&gt;family =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;binomial&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;logit&amp;quot;&lt;/span&gt;), &lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; fishlakes)
m11 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(treatment ~&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt; +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;bank.slope +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;logveg +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;BUBO.breeding:raca.basin, &lt;span class=&quot;dt&quot;&gt;family =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;binomial&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;logit&amp;quot;&lt;/span&gt;), 
    &lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; fishlakes)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now let’s rank them via AICc&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;kw&quot;&gt;AICctab&lt;/span&gt;(m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, &lt;span class=&quot;dt&quot;&gt;base =&lt;/span&gt; T, &lt;span class=&quot;dt&quot;&gt;weights =&lt;/span&gt; T, 
    &lt;span class=&quot;dt&quot;&gt;nobs =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;length&lt;/span&gt;(fishlakes))&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;##     AICc df dAICc weight 
## m11 35.9 5   0.0  0.79445
## m4  40.5 4   4.6  0.08072
## m9  40.9 5   5.1  0.06336
## m1  42.9 3   7.0  0.02424
## m5  43.0 5   7.1  0.02275
## m2  45.3 4   9.4  0.00734
## m3  45.3 4   9.4  0.00708
## m8  56.6 2  20.7  &amp;lt; 0.001
## m10 57.1 6  21.2  &amp;lt; 0.001
## m6  57.3 4  21.4  &amp;lt; 0.001
## m7  62.1 4  26.2  &amp;lt; 0.001&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Model m11 comes out ahead by quite a bit, but we’ll average the top two models, just to show you how its done.&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;m.ave &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;model.avg&lt;/span&gt;(m4, m11)
&lt;span class=&quot;kw&quot;&gt;summary&lt;/span&gt;(m.ave)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;## 
## Call:
## model.avg.default(object = m4, m11)
## 
## Component models:
##     df logLik  AICc Delta Weight
## 134  5 -12.09 35.84  0.00   0.91
## 123  4 -15.68 40.43  4.59   0.09
## 
## Term codes:
##               bank.slope            BUBO.breeding                   logveg 
##                        1                        2                        3 
## BUBO.breeding:raca.basin 
##                        4 
## 
## Model-averaged coefficients: 
##                           Estimate Std. Error Adjusted SE z value Pr(&amp;gt;|z|)
## (Intercept)                 -1.356      3.575       3.694    0.37    0.714
## bank.slope                 -19.935      8.233       8.503    2.34    0.019
## logveg                       1.783      1.366       1.409    1.26    0.206
## BUBO.breedingn:raca.basin   -0.965      0.973       1.006    0.96    0.337
## BUBO.breedingy:raca.basin    1.313      0.699       0.722    1.82    0.069
## BUBO.breedingy               2.077      1.055       1.090    1.91    0.057
##                            
## (Intercept)                
## bank.slope                *
## logveg                     
## BUBO.breedingn:raca.basin  
## BUBO.breedingy:raca.basin .
## BUBO.breedingy            .
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1 
## 
## Full model-averaged coefficients (with shrinkage): 
##  (Intercept) bank.slope  logveg BUBO.breedingn:raca.basin
##       -1.356    -19.935   1.783                    -0.877
##  BUBO.breedingy:raca.basin BUBO.breedingy
##                      1.193          0.190
## 
## Relative variable importance:
##               bank.slope                   logveg BUBO.breeding:raca.basin 
##                     1.00                     1.00                     0.91 
##            BUBO.breeding 
##                     0.09&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;co&quot;&gt;# OK, there is a predictive model, but how good is it?&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let’s try cross-validation first. If this was a single model, we could try using the cv.glm function from the “boot” library like this:&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;kw&quot;&gt;library&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;boot&amp;quot;&lt;/span&gt;)
cost &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;function(r, &lt;span class=&quot;dt&quot;&gt;pi =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;kw&quot;&gt;mean&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;abs&lt;/span&gt;(r -&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;pi) &amp;gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fl&quot;&gt;0.5&lt;/span&gt;)  ## cost function necessary for binomial data
m11.cv &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;cv.glm&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; fishlakes, m11, cost, &lt;span class=&quot;dt&quot;&gt;K =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;42&lt;/span&gt;)  &lt;span class=&quot;co&quot;&gt;# use leave-one-out cross validation (can use K-fold cross validation for larger data sets)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now lets see what our error rate was:&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;m11.cv$delta&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;## [1] 0.2381 0.2438&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;That’s not too bad.&lt;/p&gt;
&lt;p&gt;IF we want to check the error rate of an averaged model, you need to get more creative. I’ve written some code to do this for averaged models that only have two component models. It shouldn’t be too hard to adapt this for more models.&lt;/p&gt;
&lt;p&gt;function for leave one out cross validation of averaged models&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;Cross &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;function(model1, model2, data, cost) {
    &lt;span class=&quot;kw&quot;&gt;library&lt;/span&gt;(MuMIn)
    nobs &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;nrow&lt;/span&gt;(data)
    model.ave &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;model.avg&lt;/span&gt;(model1, model2)
    values &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;matrix&lt;/span&gt;(&lt;span class=&quot;ot&quot;&gt;NA&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;nrow =&lt;/span&gt; nobs, &lt;span class=&quot;dt&quot;&gt;ncol =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;5&lt;/span&gt;)
    values[, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;] &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;data$treatment
    values[, &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;] &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;predict&lt;/span&gt;(model.ave, &lt;span class=&quot;dt&quot;&gt;type =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;response&amp;quot;&lt;/span&gt;)
    CV =&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;
    for (i in &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;:nobs) {
        data2 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;data[-i, ]  &lt;span class=&quot;co&quot;&gt;# leave out one observasion&lt;/span&gt;
        model12 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(model1$formula, &lt;span class=&quot;dt&quot;&gt;family =&lt;/span&gt; model1$family, &lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; data2)
        model22 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;glm&lt;/span&gt;(model2$formula, &lt;span class=&quot;dt&quot;&gt;family =&lt;/span&gt; model2$family, &lt;span class=&quot;dt&quot;&gt;data =&lt;/span&gt; data2)
        model.ave2 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;model.avg&lt;/span&gt;(model12, model22)
        values[i, &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;] &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;predict&lt;/span&gt;(model.ave2, &lt;span class=&quot;dt&quot;&gt;newdata =&lt;/span&gt; data[i, ], &lt;span class=&quot;dt&quot;&gt;type =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;response&amp;quot;&lt;/span&gt;)
        values[i, &lt;span class=&quot;dv&quot;&gt;4&lt;/span&gt;] &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;round&lt;/span&gt;(values[i, &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;])
        if (values[i, &lt;span class=&quot;dv&quot;&gt;4&lt;/span&gt;] ==&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;values[i, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;]) 
            (values[i, &lt;span class=&quot;dv&quot;&gt;5&lt;/span&gt;] =&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;) else values[i, &lt;span class=&quot;dv&quot;&gt;5&lt;/span&gt;] =&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;
        
    }
    cv =&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;mean&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;abs&lt;/span&gt;(values[, &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;] -&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;values[, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;]) &amp;gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;fl&quot;&gt;0.5&lt;/span&gt;)
    &lt;span class=&quot;kw&quot;&gt;return&lt;/span&gt;(cv)
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Use the function on the component models&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;kw&quot;&gt;Cross&lt;/span&gt;(m11, m4, fishlakes, cost)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## [1] 0.2381&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;That looks reasonable&lt;/p&gt;
&lt;p&gt;Another method to test model accurace is Area Under the Reciever Operater Curve (AUC) This is baisically a plot of true presences versus false presences in a presence-absense model.&lt;/p&gt;
&lt;p&gt;Load the library “pROC”&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;kw&quot;&gt;library&lt;/span&gt;(pROC)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Make your reciever-operater curve&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;m.roc &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;roc&lt;/span&gt;(fishlakes$treatment, &lt;span class=&quot;kw&quot;&gt;predict&lt;/span&gt;(m.ave, &lt;span class=&quot;dt&quot;&gt;backtransform =&lt;/span&gt; &lt;span class=&quot;ot&quot;&gt;TRUE&lt;/span&gt;))
&lt;span class=&quot;kw&quot;&gt;plot&lt;/span&gt;(m.roc)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/unnamed-chunk-22.png&quot; /&gt;
&lt;/div&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;## 
## Call:
## roc.default(response = fishlakes$treatment, predictor = predict(m.ave,     backtransform = TRUE))
## 
## Data: predict(m.ave, backtransform = TRUE) in 24 controls (fishlakes$treatment 0) &amp;lt; 18 cases (fishlakes$treatment 1).
## Area under the curve: 0.949&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Looks like a pretty good fit. Not too bad for the small size of the data set.&lt;/p&gt;
&lt;p&gt;And that’s all I got. Hopefully you will find it helpful. Let me know if there is anything else I have forgotton or done wrong.&lt;/p&gt;
&lt;p&gt;~ Rosemary&lt;/p&gt;
&lt;p&gt;rosehartman@gmail.com&lt;/p&gt;</content>
 </entry>
 
 <entry>
   <title>Mason Earles on interfacing R with the Forest Vegetation Simulator</title>
   <link href="http://www.noamross.net/blog/2013/2/13/mason-earles-on-interfacing-r-with-fvs.html"/>
   <updated>2013-02-13T15:06:42-08:00</updated>
   <id>hhttp://www.noamross.net/blog/2013/2/13/mason-earles-on-interfacing-r-with-fvs</id>
   <content type="html">&lt;head&gt;
  &lt;style type=&quot;text/css&quot;  media=&quot;all&quot;&gt;
    table tbody {border-top:2px; border-bottom:2px;}
    table thead {border-bottom:1px;}
  &lt;/style&gt;
&lt;/head&gt; &lt;p&gt;&lt;a href=&quot;http://jmearles.net/&quot;&gt;Mason Earles&lt;/a&gt; gave a great presentation this week at &lt;a href=&quot;http://www.noamross.net/davis-r-users-group.html&quot;&gt;Davis R Users’ Group&lt;/a&gt; about linking R with the &lt;a href=&quot;http://www.fs.fed.us/fmsc/fvs/&quot;&gt;Forest Vegetation Simulator (FVS)&lt;/a&gt;. FVS is a model developed by the US Forest Service to simulate forest growth over time. It’s written in FORTRAN and has been around since the 1970s.&lt;/p&gt;
&lt;p&gt;FVS has recently gone open-source (its &lt;a href=&quot;http://code.google.com/p/open-fvs/&quot;&gt;repository is on google code&lt;/a&gt;), and now has &lt;a href=&quot;http://code.google.com/p/open-fvs/wiki/rFVS&quot;&gt;an alpha-level API which can be called from R&lt;/a&gt;. Mason showed us how he used the API along with some text manipulation functions to make the programs work together. Then he showed us how he used this to do some Monte Carlo simulations to look at the effects of stochastic fire and drought events.&lt;/p&gt;
&lt;p&gt;Here are Mason’s slides:&lt;/p&gt;
&lt;iframe src=&quot;http://www.slideshare.net/slideshow/embed_code/16516293&quot; width=&quot;800&quot; height=&quot;600&quot; frameborder=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; scrolling=&quot;no&quot;&gt;&lt;/iframe&gt;</content>
 </entry>
 
 <entry>
   <title>Ryan Peek on using xts and ggplot for time-series data</title>
   <link href="http://www.noamross.net/blog/2013/2/6/xtsmarkdown.html"/>
   <updated>2013-02-06T15:44:25-08:00</updated>
   <id>hhttp://www.noamross.net/blog/2013/2/6/xtsmarkdown</id>
   <content type="html">&lt;head&gt;
  &lt;style type=&quot;text/css&quot;  media=&quot;all&quot;&gt;
    table tbody {border-top:2px; border-bottom:2px;}
    table thead {border-bottom:1px;}
  &lt;/style&gt;
&lt;/head&gt; &lt;p&gt;At &lt;a href=&quot;http://www.noamross.net/davis-r-users-group.html&quot;&gt;Davis R Users’ Group&lt;/a&gt; today, &lt;a href=&quot;http://watershed.ucdavis.edu/people/ryan-peek&quot;&gt;Ryan Peek&lt;/a&gt; gave a presentation on how he takes data from his field instruments and visualizes it in R. Here are his notes. The original *.Rmd file and data can be found &lt;a href=&quot;https://gist.github.com/noamross/4727029&quot;&gt;here&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;short-how-to-on-using-xts-and-ggplot-for-time-series-data&quot;&gt;SHORT HOW-TO ON USING XTS AND GGPLOT FOR TIME SERIES DATA&lt;/h2&gt;
&lt;p&gt;XTS is a very helpful package when working with time series data. I work with temperature and flow data frequently, so the ability to work with timeseries, and particularly to shift intervals (from 15 min to hourly or daily) can be very handy. Once data has been re-worked, &lt;strong&gt;ggplot2&lt;/strong&gt; is a great package to plot data of all types.&lt;/p&gt;
&lt;p&gt;First read in some data and format to POSIXlt. There are 2 types of time, POSIXlt and POSIXct. POSIXct is generally what ggplot uses and is based on seconds, while POSIXlt can be re-classed into individual components quite easily, but year zero is calculated from 1900 (so 2011 would be year 111).&lt;/p&gt;
&lt;h3 id=&quot;read-in-some-data&quot;&gt;Read in some data&lt;/h3&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;## READ IN FILE
inputfile &amp;lt;-&lt;span class=&quot;st&quot;&gt; &amp;quot;Air_Water_loggers_15min_example.csv&amp;quot;&lt;/span&gt;
file &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;read.csv&lt;/span&gt;(inputfile, &lt;span class=&quot;dt&quot;&gt;stringsAsFactors =&lt;/span&gt; &lt;span class=&quot;ot&quot;&gt;FALSE&lt;/span&gt;)
## FORMAT TIME COLUMN TO POSIXlt
file$time15 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;strptime&lt;/span&gt;(file$time15, &lt;span class=&quot;dt&quot;&gt;format =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;%m/%d/%Y %H:%M&amp;quot;&lt;/span&gt;)
## ROUND TO NEAREST HOUR
file$time15hr &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;round&lt;/span&gt;(file$time15, &lt;span class=&quot;st&quot;&gt;&amp;quot;hour&amp;quot;&lt;/span&gt;)

## TO VIEW TIME CLASSES USE &amp;#39;str&amp;#39;
&lt;span class=&quot;kw&quot;&gt;str&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;unclass&lt;/span&gt;(file$time15))&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;## List of 9
##  $ sec  : num [1:6096] 0 0 0 0 0 0 0 0 0 0 ...
##  $ min  : int [1:6096] 15 30 45 0 15 30 45 0 15 30 ...
##  $ hour : int [1:6096] 0 0 0 1 1 1 1 2 2 2 ...
##  $ mday : int [1:6096] 30 30 30 30 30 30 30 30 30 30 ...
##  $ mon  : int [1:6096] 3 3 3 3 3 3 3 3 3 3 ...
##  $ year : int [1:6096] 112 112 112 112 112 112 112 112 112 112 ...
##  $ wday : int [1:6096] 1 1 1 1 1 1 1 1 1 1 ...
##  $ yday : int [1:6096] 120 120 120 120 120 120 120 120 120 120 ...
##  $ isdst: int [1:6096] 1 1 1 1 1 1 1 1 1 1 ...&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Notice that the &lt;strong&gt;$time15&lt;/strong&gt; column classes exist for all values even though data only exists to minutes. Also years are “112” and “111” instead of 2011 and 2012. Month and hour (24 hour clock) start at zero.&lt;/p&gt;
&lt;h3 id=&quot;load-the-xts-package-and-make-into-an-xts-object&quot;&gt;Load the XTS package and make into an xts object&lt;/h3&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;kw&quot;&gt;library&lt;/span&gt;(xts)
## MAKE XTS

## make XTS format using time column for the data columns of interest
df.xts &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;xts&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;x =&lt;/span&gt; file[, &lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;:&lt;span class=&quot;dv&quot;&gt;7&lt;/span&gt;)], &lt;span class=&quot;dt&quot;&gt;order.by =&lt;/span&gt; file[, &lt;span class=&quot;st&quot;&gt;&amp;quot;time15&amp;quot;&lt;/span&gt;])
&lt;span class=&quot;kw&quot;&gt;head&lt;/span&gt;(df.xts)  &lt;span class=&quot;co&quot;&gt;# notice the row names are now the &amp;#39;time15&amp;#39; column&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;##                     RUB_sol MFA_sol NFA_sol NFY_sol SFY_baro_air
## 2012-04-30 00:15:00   11.93   12.69   11.26    8.19         9.43
## 2012-04-30 00:30:00   11.88   12.63   11.28    8.18         9.25
## 2012-04-30 00:45:00   11.83   12.57   11.26    8.21         9.03
## 2012-04-30 01:00:00   11.78   12.51   11.23    8.22         8.82
## 2012-04-30 01:15:00   11.73   12.46   11.17    8.23         8.60
## 2012-04-30 01:30:00   11.68   12.40   11.15    8.24         8.42
##                     NFA_baro_air
## 2012-04-30 00:15:00        13.13
## 2012-04-30 00:30:00        12.93
## 2012-04-30 00:45:00        12.74
## 2012-04-30 01:00:00        12.61
## 2012-04-30 01:15:00        12.46
## 2012-04-30 01:30:00        12.34&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Notice that the row names exist as the time series data from the &lt;em&gt;time15’&lt;/em&gt; column.&lt;/p&gt;
&lt;h4 id=&quot;then-run-any-function-along-a-given-time-interval-using-xts-functions&quot;&gt;Then run any function along a given time interval using XTS functions&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;apply.daily - makes daily data&lt;/li&gt;
&lt;li&gt;apply.monthly - monthly&lt;/li&gt;
&lt;li&gt;period.apply(data,endpoints(data,on=“interval”,1)) # Using interval of your choice&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;When using Rstudio, you can hit tab at any time to view potential options for a given command or function. Try &lt;em&gt;apply&lt;/em&gt;+TAB.&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;co&quot;&gt;# MAKE DAILY AVG, MEAN, AND MAX&lt;/span&gt;
dAvg &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;apply.daily&lt;/span&gt;(df.xts, function(x) &lt;span class=&quot;kw&quot;&gt;apply&lt;/span&gt;(x, &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;, mean))  &lt;span class=&quot;co&quot;&gt;# daily mean&lt;/span&gt;
dMin &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;apply.daily&lt;/span&gt;(df.xts, function(x) &lt;span class=&quot;kw&quot;&gt;apply&lt;/span&gt;(x, &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;, min))  &lt;span class=&quot;co&quot;&gt;# daily min&lt;/span&gt;
dMax &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;apply.daily&lt;/span&gt;(df.xts, function(x) &lt;span class=&quot;kw&quot;&gt;apply&lt;/span&gt;(x, &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;, max))  &lt;span class=&quot;co&quot;&gt;# daily max&lt;/span&gt;

&lt;span class=&quot;co&quot;&gt;# OR MAKE HOURLY (OR PREFERRED TIME INTERVAL)&lt;/span&gt;
hrAvg &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;period.apply&lt;/span&gt;(df.xts, &lt;span class=&quot;kw&quot;&gt;endpoints&lt;/span&gt;(df.xts, &lt;span class=&quot;dt&quot;&gt;on =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;hours&amp;quot;&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;), function(x) &lt;span class=&quot;kw&quot;&gt;apply&lt;/span&gt;(x, 
    &lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;, mean))  &lt;span class=&quot;co&quot;&gt;# avg over 1 hour period&lt;/span&gt;

&lt;span class=&quot;co&quot;&gt;# RENAME COLUMN NAMES TO MAKE RECOMBINING EASIER&lt;/span&gt;
&lt;span class=&quot;kw&quot;&gt;names&lt;/span&gt;(dAvg) &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;sub&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;_sol$&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;.avg&amp;quot;&lt;/span&gt;, &lt;span class=&quot;kw&quot;&gt;names&lt;/span&gt;(dAvg))
&lt;span class=&quot;kw&quot;&gt;names&lt;/span&gt;(dAvg) &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;sub&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;_air$&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;.avg&amp;quot;&lt;/span&gt;, &lt;span class=&quot;kw&quot;&gt;names&lt;/span&gt;(dAvg))
&lt;span class=&quot;kw&quot;&gt;names&lt;/span&gt;(dMax) &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;sub&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;_sol$&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;.max&amp;quot;&lt;/span&gt;, &lt;span class=&quot;kw&quot;&gt;names&lt;/span&gt;(dMax))
&lt;span class=&quot;kw&quot;&gt;names&lt;/span&gt;(dMax) &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;sub&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;_air$&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;.max&amp;quot;&lt;/span&gt;, &lt;span class=&quot;kw&quot;&gt;names&lt;/span&gt;(dMax))
&lt;span class=&quot;kw&quot;&gt;names&lt;/span&gt;(dMin) &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;sub&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;_sol$&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;.min&amp;quot;&lt;/span&gt;, &lt;span class=&quot;kw&quot;&gt;names&lt;/span&gt;(dMin))
&lt;span class=&quot;kw&quot;&gt;names&lt;/span&gt;(dMin) &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;sub&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;_air$&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;.min&amp;quot;&lt;/span&gt;, &lt;span class=&quot;kw&quot;&gt;names&lt;/span&gt;(dMin))

Day &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;data.frame&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;datetime =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;index&lt;/span&gt;(dAvg), dAvg[, &lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;:&lt;span class=&quot;dv&quot;&gt;6&lt;/span&gt;)], dMax[, &lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;:&lt;span class=&quot;dv&quot;&gt;6&lt;/span&gt;)], dMin[, 
    &lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;:&lt;span class=&quot;dv&quot;&gt;6&lt;/span&gt;)], &lt;span class=&quot;dt&quot;&gt;row.names =&lt;/span&gt; &lt;span class=&quot;ot&quot;&gt;NULL&lt;/span&gt;)

&lt;span class=&quot;co&quot;&gt;# WRITE NEW FILE TO A CSV write.csv(Hour,&lt;/span&gt;
&lt;span class=&quot;co&quot;&gt;# file=&amp;#39;Airwatertemps_hourly_example.csv&amp;#39;, row.names=FALSE)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;When making a dataframe from an xts object, important to note that you must use &lt;em&gt;index()&lt;/em&gt; instead of row.names to pull the time stamp/date into a new dataframe.&lt;/p&gt;
&lt;h4 id=&quot;make-a-ggplot-of-daily-temperatures-showing-a-max-and-min-using-geom_ribbon&quot;&gt;Make a ggplot of daily temperatures showing a max and min using &lt;em&gt;geom_ribbon&lt;/em&gt;&lt;/h4&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;kw&quot;&gt;library&lt;/span&gt;(scales)
&lt;span class=&quot;kw&quot;&gt;library&lt;/span&gt;(ggplot2)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This plot is complex, and code is provided to view as you like. Main components are: * &lt;strong&gt;ggplot&lt;/strong&gt;: this sets the data and x acess * &lt;strong&gt;geom_line&lt;/strong&gt;: this is to plot lines, custom colors are set by including color &lt;em&gt;within&lt;/em&gt; the aes call * &lt;strong&gt;geom_ribbon&lt;/strong&gt;: this is to plot the filled max and min ribbon in the background *&lt;strong&gt;scale_color/fill_manual&lt;/strong&gt;: this allows you to define custom colors for each geom, must match exactly with the color=“&amp;quot; or fill=”&amp;quot;&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;RUB &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;ggplot&lt;/span&gt;(Day, &lt;span class=&quot;kw&quot;&gt;aes&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;x =&lt;/span&gt; datetime)) +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;geom_line&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;aes&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;y =&lt;/span&gt; NFA_baro.avg, &lt;span class=&quot;dt&quot;&gt;color =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;AIR&amp;quot;&lt;/span&gt;), 
    &lt;span class=&quot;dt&quot;&gt;size =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;linetype =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;alpha =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;) +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;geom_ribbon&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;aes&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;ymax =&lt;/span&gt; NFA_baro.max, 
    &lt;span class=&quot;dt&quot;&gt;ymin =&lt;/span&gt; NFA_baro.min, &lt;span class=&quot;dt&quot;&gt;fill =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;AIR Max/Min&amp;quot;&lt;/span&gt;), &lt;span class=&quot;dt&quot;&gt;colour =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;darkorange&amp;quot;&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;linetype =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;, 
    &lt;span class=&quot;dt&quot;&gt;alpha =&lt;/span&gt; &lt;span class=&quot;fl&quot;&gt;0.4&lt;/span&gt;) +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;geom_ribbon&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;aes&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;ymax =&lt;/span&gt; RUB.max, &lt;span class=&quot;dt&quot;&gt;ymin =&lt;/span&gt; RUB.min, &lt;span class=&quot;dt&quot;&gt;fill =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;RUB Max/Min&amp;quot;&lt;/span&gt;), 
    &lt;span class=&quot;dt&quot;&gt;colour =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;darkgreen&amp;quot;&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;linetype =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;alpha =&lt;/span&gt; &lt;span class=&quot;fl&quot;&gt;0.7&lt;/span&gt;) +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;geom_line&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;aes&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;y =&lt;/span&gt; RUB.avg, 
    &lt;span class=&quot;dt&quot;&gt;color =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;RUB-Water&amp;quot;&lt;/span&gt;), &lt;span class=&quot;dt&quot;&gt;size =&lt;/span&gt; &lt;span class=&quot;fl&quot;&gt;0.9&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;linetype =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;alpha =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;) +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;geom_ribbon&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;aes&lt;/span&gt;(datetime, 
    &lt;span class=&quot;dt&quot;&gt;ymax =&lt;/span&gt; MFA.max, &lt;span class=&quot;dt&quot;&gt;ymin =&lt;/span&gt; MFA.min, &lt;span class=&quot;dt&quot;&gt;fill =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;MFA Max/Min&amp;quot;&lt;/span&gt;), &lt;span class=&quot;dt&quot;&gt;colour =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;gray40&amp;quot;&lt;/span&gt;, 
    &lt;span class=&quot;dt&quot;&gt;linetype =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;alpha =&lt;/span&gt; &lt;span class=&quot;fl&quot;&gt;0.5&lt;/span&gt;) +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;geom_line&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;aes&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;y =&lt;/span&gt; MFA.avg, &lt;span class=&quot;dt&quot;&gt;color =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;MFA-Water&amp;quot;&lt;/span&gt;), 
    &lt;span class=&quot;dt&quot;&gt;size =&lt;/span&gt; &lt;span class=&quot;fl&quot;&gt;0.9&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;linetype =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;alpha =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;) +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;ylab&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;expression&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;paste&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Daily Temperature ( &amp;quot;&lt;/span&gt;, 
    degree, &lt;span class=&quot;st&quot;&gt;&amp;quot;C)&amp;quot;&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;sep =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;))) +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;xlab&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;) +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;scale_x_datetime&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;limits =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;as.POSIXct&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;2012-05-10 12:00&amp;quot;&lt;/span&gt;), 
    &lt;span class=&quot;kw&quot;&gt;as.POSIXct&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;2012-05-30 12:00&amp;quot;&lt;/span&gt;)), &lt;span class=&quot;dt&quot;&gt;labels =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;date_format&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;%b-%d&amp;quot;&lt;/span&gt;), &lt;span class=&quot;dt&quot;&gt;breaks =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;date_breaks&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;7 days&amp;quot;&lt;/span&gt;)) +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;
&lt;span class=&quot;st&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;scale_y_continuous&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;breaks =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;seq&lt;/span&gt;(&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;42&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;by =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;4&lt;/span&gt;), &lt;span class=&quot;dt&quot;&gt;limits =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dv&quot;&gt;42&lt;/span&gt;), &lt;span class=&quot;dt&quot;&gt;labels =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;seq&lt;/span&gt;(&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, 
        &lt;span class=&quot;dv&quot;&gt;42&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;by =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;4&lt;/span&gt;)) +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;theme_bw&lt;/span&gt;() +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;labs&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;title =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;Daily Air and Water Temperature: Rubicon&amp;quot;&lt;/span&gt;) +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;
&lt;span class=&quot;st&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;scale_color_manual&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;Mean&amp;quot;&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;breaks =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;AIR&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;RUB-Water&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;MFA-Water&amp;quot;&lt;/span&gt;), 
        &lt;span class=&quot;dt&quot;&gt;values =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;RUB-Water&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;`&lt;/span&gt; =&lt;span class=&quot;st&quot;&gt; &amp;quot;darkgreen&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;MFA-Water&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;`&lt;/span&gt; =&lt;span class=&quot;st&quot;&gt; &amp;quot;darkmagenta&amp;quot;&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;AIR =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;orange&amp;quot;&lt;/span&gt;)) +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;
&lt;span class=&quot;st&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;scale_fill_manual&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot; Max/Min&amp;quot;&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;breaks =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;AIR Max/Min&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;RUB Max/Min&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;MFA Max/Min&amp;quot;&lt;/span&gt;), 
        &lt;span class=&quot;dt&quot;&gt;values =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;AIR Max/Min&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;`&lt;/span&gt; =&lt;span class=&quot;st&quot;&gt; &amp;quot;gold&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;MFA Max/Min&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;`&lt;/span&gt; =&lt;span class=&quot;st&quot;&gt; &amp;quot;darkmagenta&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;RUB Max/Min&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;`&lt;/span&gt; =&lt;span class=&quot;st&quot;&gt; &amp;quot;darkolivegreen3&amp;quot;&lt;/span&gt;)) +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;
&lt;span class=&quot;st&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;theme&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;legend.direction =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;horizontal&amp;quot;&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;legend.position =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;bottom&amp;quot;&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;legend.key =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;element_blank&lt;/span&gt;(), 
        &lt;span class=&quot;dt&quot;&gt;legend.background =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;element_rect&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;fill =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;white&amp;quot;&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;colour =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;gray30&amp;quot;&lt;/span&gt;)) +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;
&lt;span class=&quot;st&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;guides&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;fill =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;guide_legend&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;keywidth =&lt;/span&gt; &lt;span class=&quot;fl&quot;&gt;0.9&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;keyheight =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;))

RUB&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/unnamed-chunk-1.png&quot; /&gt;
&lt;/div&gt;</content>
 </entry>
 
 <entry>
   <title>A Draft Dissertation Proposal:  Forest Disease Dynamics and Management</title>
   <link href="http://www.noamross.net/blog/2013/1/27/dissertation-proposal.html"/>
   <updated>2013-01-27T19:37:16-08:00</updated>
   <id>hhttp://www.noamross.net/blog/2013/1/27/dissertation-proposal</id>
   <content type="html">&lt;head&gt;
  &lt;style type=&quot;text/css&quot;  media=&quot;all&quot;&gt;
    table tbody {border-top:2px; border-bottom:2px;}
    table thead {border-bottom:1px;}
  &lt;/style&gt;
&lt;/head&gt; &lt;p&gt;&lt;em&gt;A first draft, just out to my committee. Feedback welcome! A modifiable souce version can be found on github &lt;a href=&quot;https://github.com/noamross/openquals/blob/master/Dissertation%20Proposal.md&quot;&gt;here&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;h2 id=&quot;abstract&quot;&gt;Abstract&lt;/h2&gt;
&lt;p&gt;Forest disease spreads through plant communities structured by species composition, age distribution, and spatial arrangement. I propose to examine the consequences of the interaction of these components of population structure &lt;em&gt;Phytophthora ramorum&lt;/em&gt; invasion of California redwood forests. First, I will compare the dynamic behavior of a series of epidemiological models that include different combinations of population structure. Then I will fit these models to time-series data from a network of disease monitoring plots to determine what components of forest population structure are most important for prediction of disease spread. Using the most parsimoniuous models, I will determine optimal schedules of treatment to minimize the probability of precipitous decline of host populations.&lt;/p&gt;
&lt;h2 id=&quot;introduction-modeling-disease-in-complex-populations-for-management&quot;&gt;Introduction: Modeling Disease in Complex Populations for Management&lt;/h2&gt;
&lt;p&gt;Forest diseases can radically transform ecosystems. In North America, chestnut blight, Dutch elm disease and beech bark disease have caused precipitous declines in their hosts, leading to changes in the structure and function of forests. Changes from such diseases may be the dominant force changing the face of some forests in coming decades, overwhelming other forms of rapid environmental change such as climate change (Lovett et al. 2006).&lt;/p&gt;
&lt;p&gt;Even simple host-disease systems exhibit complex dynamics (Kermack and Mckendrick 1927). Forest disease dynamics include additional complexity driven by pathogen life cycles, variation in pathogen and host populations, spatial strucure, and demographic and environmental stochasticity (Hansen and Goheen 2000, Holdenrieder et al. 2004). These factors yield greater complexity in disease dynamics. This complexity, combined with limited monitoring data and the uncertainty of the parameters of emergent diseases, makes prediction of disease dynamics difficult. Yet such prediction is needed to allocate limited resources for treatment and prevention.&lt;/p&gt;
&lt;p&gt;One source of complexity in forest disease dynamics is structured variation in host populations. Host tree populations may consist of multiple species or genotypes, and consist of multiple sizes, each of which may interact with disease or each other differently (Gilbert and Hubbell 1996). All forest tree populations are spatially structured; non-motile individuals can not be “well-mixed” (Filipe and Maule 2003). Each of these forms of population structure have consequences for population dynamics that have been examined in theoretical models (Park et al. 2001, 2002, Dobson 2004, Klepac and Caswell 2010). However, dynamics resulting from these components of population structure &lt;em&gt;interacting&lt;/em&gt; are not well-characterized.&lt;/p&gt;
&lt;p&gt;Understanding modeled dynamics of disease in structured populations may provide insights useful for management. However, the ability to use such models for management planning depends requires confidence in their predictive power, particularly under novel management treatments. Recent developments in &lt;em&gt;particle filter&lt;/em&gt; techniques allow estimation of the likelihoods of complex dynamic models (Arulampalam et al. 2002, Ionides et al. 2006, Knape and de Valpine 2012), and subsequent comparison of models in out-of-sample predictive performance (Vehtari and Ojanen 2012). Fitting dynamic models direclty provides more confidence in the dynamic results than deriving madel parameters individually from data, because allows tests confidence in models’ emergent dynamics rather than separate components.&lt;/p&gt;
&lt;p&gt;Sudden oak death (SOD) is an emerging forest disease in California and Oregon that threatens populations of tanoak (&lt;em&gt;Notholithocarpus densiflorus&lt;/em&gt;) (Rizzo and Garbelotto 2003), has the potential to modify community structure (Metz et al. 2012), and cause significant economic damage (Kovacs et al. 2011). Silvicultural, chemical, and other control techniques can modify the progression of disease (Swiecki and Bernhardt 2013), but eradication of SOD is unlikely [@Cobb2013] even at local scales. Long and short- and long-term solutions to limit the damage of disease will require continuous treatment and monitoring regimes. Under budget constraints, planning for such treatment can be informed by dynamics models via optimal control techniques.&lt;/p&gt;
&lt;p&gt;I aim to answer the following overall questions:&lt;/p&gt;
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;How do interactions between community, size, and spatial structure affect disease dynamics in forests?&lt;/li&gt;
&lt;li&gt;What aspects of population structure are most important in determining the probability and size of forest disease outbreaks in theoretical models?&lt;/li&gt;
&lt;li&gt;What aspects of population structure are most important in &lt;em&gt;predicting&lt;/em&gt; the probability and size of SOD outbreaks?&lt;/li&gt;
&lt;li&gt;What control strategy minimizes the probability of SOD outbreaks at least cost?&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;background&quot;&gt;Background&lt;/h2&gt;
&lt;h3 id=&quot;sudden-oak-death&quot;&gt;Sudden Oak Death&lt;/h3&gt;
&lt;p&gt;Sudden Oak Death (SOD) is an emerging forest disease in California and Oregon that poses risks to forests across North America and Europe. First observed in California in the mid-1990s, SOD is caused by the water mold &lt;em&gt;Phytophthora ramorum&lt;/em&gt; (Rizzo et al. 2002). &lt;em&gt;P. ramorum&lt;/em&gt; often kills tanoak (&lt;em&gt;Notholithocarpus densiflorus&lt;/em&gt;), which provide habitat and food to many vertebrate species, and are the primary host of ectomycorrhizal fungi in redwood forests (Rizzo and Garbelotto 2003). Loss of this species may have cascading effects on other species. The disease has also caused significant economic damage through removal costs and property value reduction (Kovacs et al. 2011). It has the potential to spread to species in other regions, such as northern red oak (&lt;em&gt;Quercus rubra&lt;/em&gt;), one of the most important eastern timber species (Rizzo et al. 2002).&lt;/p&gt;
&lt;h3 id=&quot;population-structure-multiple-host-species&quot;&gt;Population Structure: Multiple Host Species&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;Phytophthora ramorum&lt;/em&gt; has over 100 host species in 40 genera, which fall into several functional types (Swiecki and Bernhardt 2013). In canker hosts, which are all members of &lt;em&gt;Fagaceae&lt;/em&gt; in California, pathogen produces cankers on the trunk. Few if any spores are produced from the cankers, and these hosts are generally dead ends. SOD is fatal to many canker costs. In foliar hosts, &lt;em&gt;P. ramorum&lt;/em&gt; resides and reproduces in leaves and twigs. Foliar hosts vary greatly in susceptibility to disease and spore production from diseased individuals. Some hosts are dead ends; others are major drivers of disease spread and survival.&lt;/p&gt;
&lt;p&gt;In Redwood forests in Northern California, the hosts of importance are tanoak and bay laurel (&lt;em&gt;Umbellularia californica&lt;/em&gt;). Tanoak has the dubious distinction of being the only species that is both a canker and foliar host, and the disease is generally lethal in these trees. Bay laurel is a foliar host in which &lt;em&gt;P. ramorum&lt;/em&gt; produces prolifically, and bay suffers no harm from the disease (DiLeo et al. 2009). Redwood and other species are unsusceptible or dead-end hosts where &lt;em&gt;P. ramorum&lt;/em&gt; has little detrimental effect. In forests of the redwood-tanoak-bay complex, bay Laurel acts as the primary disease reservoir [@Davidso2008]. Tanoak infection and mortality is dependent on bay density (Cobb et al. 2012), and removal of bay is a commonly suggested treatment to reduce risk of SOD outbreaks (@Filipe2013; Swiecki and Bernhardt 2013).&lt;/p&gt;
&lt;p&gt;Dobson (2004) examined a model of disease in multiple host species based on an the SIR (Kermack and Mckendrick 1927) framework. In it, species had density dependence but interacted only though disease transmission. Importantly, transmission between species was always equal or less than transmission between species. Dobson found that in when transmission was density-dependent, species had a complementary effect on the disease’s rate of reproduction &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline (R_0)&quot; alt=&quot;(R_0)&quot; /&gt;&lt;/span&gt;; that is, a mix of both species led to faster outbreaks. However, in the frequency-dependent case, &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline R_0&quot; alt=&quot;R_0&quot; /&gt;&lt;/span&gt; was greatest when one species dominated. Transmission between species dampens and synchronizes disease oscillations in each species, and at very high contact rates between species the most susceptible species are more like to go extinct. Craft and Hawthorne (2008) implemented a stochastic version of this model in a system of mamallian carnivores, finding that species with low intra-species contact rates acted as sinks for disease, and their contact with more social species increased spread disease within these low-contact species.&lt;/p&gt;
&lt;p&gt;SOD dynamics differ from these systems in a few important ways. First, the contact structure among species may not be symmetrical. Contact rates among trees are driven by differences in species transmissivity (amount of spore produced) and susceptibility (probability of infection per spore) than social grouping. Where one species with high transmissivity coexists with a species of high susceptibility, the probability of transmission may be higher between species than within. Also, the spatial structure of species, and the dispersal pattern of spores, may result in a hybrid between density and frequency-dependent disease transmissions.&lt;/p&gt;
&lt;h3 id=&quot;population-structure-sizestage-classes&quot;&gt;Population Structure: Size/Stage Classes&lt;/h3&gt;
&lt;p&gt;Within the tanoak population, epidemiological characteristics vary with tree size. Trees of larger size classes are more likely to be infected and die more quickly than smaller tree (Cobb et al. 2012), Possibly due to the vulnerability of cracked bark and the amount of bark tissue available for invasion (Swiecki and Bernhardt 2005). There is no evidence currently for variation in spore production or other physiological effects across tree sizes [@Davidson2008].&lt;/p&gt;
&lt;p&gt;When disease dynamics occur much faster than demographic processes, we can treat size classes similarly to different species, and examine the progression of disease in a constant population structure. However, when disease progression and growth occur at similar rates, these processes can interact to produce complex dynamics (Klepac and Caswell 2010). This is the case with SOD; infectious periods can last many years, during which trees may continue to grow.&lt;/p&gt;
&lt;p&gt;The effects of age-based population structure and contact rates have been studied extensively in the context of human disease and vaccination programs (Anderson and May 1985, Metcalf et al. 2012). Reducing in-class transmission rates at young ages increases the average age of infection, independent of the exact contact structure. When only the susceptibility, and not transmissivity, of each age class varies. Klepac and Caswell (2010) found that increases in within-class transmission increases both the infected and recovered population of those classes, and classes with high transissivity have higher equilibrium populations relative to low-transmissivity classes.&lt;/p&gt;
&lt;h3 id=&quot;population-structure-space&quot;&gt;Population Structure: Space&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;P. Ramorum&lt;/em&gt; dispersal interacts with host population structure at many scales. The pathogen spreads between trees via wind-blown rain and splash, limiting most spores to spread within 15m of host plants (Davidson et al. 2005). However, occaisional weather events, such as fog, can transport spores up to 3 km (Rizzo et al. 2005). Over longer distances, &lt;em&gt;P. ramorum&lt;/em&gt; can be transported in streams or spread via human-mediated vectors such as nursery plant trade [@Osterbauer2004]. Meentemeyer et al. (2011) found that the best fit kernel for a statewide model of &lt;em&gt;P. ramorum&lt;/em&gt; spread was the sum of two Cauchy kernels, one on the scale of tens of meters and another on the scale of tens of kilometers.&lt;/p&gt;
&lt;p&gt;Despite the ability to spread long distance, strong meter-scale gradients mean that individual trees in stands can not be considered “well mixed” in terms of contact rates between trees. Rather, contact patterns across space arise from the interaction of spatial clustering of trees and the dispersal kernel of the disease. Neither frequency- nor density-dependent transmission characterizes this arrangement.&lt;/p&gt;
&lt;p&gt;The effect of such spatial structure on development of epidemics has been studied with continuous populations in space [@Bolker1999], metapopulation models (Park et al. (2001); Park et al. (2002)), models of individuals on a lattice (Filipe and Maule 2003, 2004) and discrete individuals in continuous space (Brown and Bolker (2004)). These approaches have reached similar conclusions of the effect of spatial structure in non-mobile populations. In all cases, the threshold of disease growth for a global outbreak &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline (R_0)&quot; alt=&quot;(R_0)&quot; /&gt;&lt;/span&gt; is greater than the threshold for a local epidemic &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline (R_L)&quot; alt=&quot;(R_L)&quot; /&gt;&lt;/span&gt;. For instance, in metapopulations on a lattice, &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline R_0 = R_L (1 + z\varepsilon)&quot; alt=&quot;R_0 = R_L (1 + z\varepsilon)&quot; /&gt;&lt;/span&gt;, where &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline z&quot; alt=&quot;z&quot; /&gt;&lt;/span&gt; is the average number of connections between patches and &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \varepsilon&quot; alt=&quot;\varepsilon&quot; /&gt;&lt;/span&gt; is the inter-patch contact rates (Park et al. 2001). In models of discrete individuals in space, &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline R_0 = \lambda(1 + \bar{\mathcal{C}} SI)&quot; alt=&quot;R_0 = \lambda(1 + \bar{\mathcal{C}} SI)&quot; /&gt;&lt;/span&gt;, where &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \lambda&quot; alt=&quot;\lambda&quot; /&gt;&lt;/span&gt; would be the pathogen growth rate in a well-mixed population, and &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \bar{\mathcal{C}}&quot; alt=&quot;\bar{\mathcal{C}}&quot; /&gt;&lt;/span&gt; is the dispersal kernel-weighted spatial correlation between susceptible and infected individuals. &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \bar{\mathcal{C}}&quot; alt=&quot;\bar{\mathcal{C}}&quot; /&gt;&lt;/span&gt; evolves over time but reaches a minimum that represents the threshold required for a global epidemic (Brown and Bolker 2004). Also, both clustering and anti-clustering (oversdispersal) reduce the rate of increase of disease, except when clustering occurs at the scale of dispersal, in which case it can accellerate spread. Fat-tailed dispersal kernels accellerate spread, as well.&lt;/p&gt;
&lt;h2 id=&quot;study-approach&quot;&gt;Study Approach&lt;/h2&gt;
&lt;p&gt;I will examine the comparative effects of the above components of population structure on SOD epidemics by (1) characterizing the dynamic behavior of models that include each type of structure and their combinations and (2) identifying the model structure that best predicts data of disease spread over time in redwood-tanoak-bay forests. Using the best-fit model, I determine optimal control plans for stand protection efforts to minimize the risk of loss of host plants.&lt;/p&gt;
&lt;h3 id=&quot;determining-the-consequences-of-population-structure-via-comparative-dynamics&quot;&gt;Determining the Consequences of Population Structure via Comparative Dynamics&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;1. How do interactions between community, size, and spatial structure affect disease dynamics in forests?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2. What aspects of population structure are most important in determining the probability and size of forest disease outbreaks in theoretical models?&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;To characterize the effects of the population structure on disease dynamics, I will compare four models. All are extensions of the epidemiological model of Cobb et al. (2012).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Model A&lt;/strong&gt; is the simplest of the four models, only representing structure in the form of differences between species of trees. It is described by this system of stochastic difference equations:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
\boldsymbol{S}_{t+1} &amp;amp;\sim \boldsymbol{S_t} + \overbrace{  \text{Pois}\left[\boldsymbol{b(S_t+I_t)}\left(1-\sum_{i=1}^n w_i (S_{it} + I_{it}) \right) + \boldsymbol{rm_I I_t}\right]}^{\text{new recruits}} - \overbrace{\text{Binom}_1\left((\underbrace{1 - e^{-\boldsymbol{\beta I_t} - \boldsymbol{\lambda_{ex}}}}_{\text{force of infection}})\boldsymbol{S_t} \right)}^{\text{infections}} -\overbrace{\text{Binom}_2(\boldsymbol{m_S S_t})}^{\text{mortality}} \\
\boldsymbol{I}_{t+1} &amp;amp;\sim \boldsymbol{I_t} + \text{Binom}_1\left((1 - e^{-\boldsymbol{\beta I_t} - \boldsymbol{\lambda_{ex}}})\boldsymbol{S_t} \right) - \text{Binom}_3(\boldsymbol{m_I} \boldsymbol{S_t}) 
\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Here &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \boldsymbol{S}_t&quot; alt=&quot;\boldsymbol{S}_t&quot; /&gt;&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \boldsymbol{I}_t&quot; alt=&quot;\boldsymbol{I}_t&quot; /&gt;&lt;/span&gt; are vectors of the populations of susceptible and infected individuals of each species, and &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \boldsymbol{\beta}&quot; alt=&quot;\boldsymbol{\beta}&quot; /&gt;&lt;/span&gt; is the matrix of contact rates. Other parameters are listed below in Table 1.&lt;/p&gt;
&lt;table&gt;
&lt;caption&gt;Model A Parameters&lt;/caption&gt;
&lt;col width=&quot;45%&quot; /&gt;
&lt;col width=&quot;50%&quot; /&gt;
&lt;thead&gt;
&lt;tr class=&quot;header&quot;&gt;
&lt;th align=&quot;center&quot;&gt;Parameter Vector Symbol&lt;/th&gt;
&lt;th align=&quot;left&quot;&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td align=&quot;center&quot;&gt;&lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \boldsymbol m_{S,I}&quot; alt=&quot;\boldsymbol m_{S,I}&quot; /&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;Probability of death per year, for both susceptible and infectious trees&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td align=&quot;center&quot;&gt;&lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \boldsymbol b&quot; alt=&quot;\boldsymbol b&quot; /&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;Fecundity per individual per year.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td align=&quot;center&quot;&gt;&lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \boldsymbol r&quot; alt=&quot;\boldsymbol r&quot; /&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;Probability of resprouting after death by disease.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td align=&quot;center&quot;&gt;&lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \boldsymbol w&quot; alt=&quot;\boldsymbol w&quot; /&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;Competitive coefficient (relative contribution to density-dependent recruitment)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td align=&quot;center&quot;&gt;&lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \boldsymbol \lambda_{ex}&quot; alt=&quot;\boldsymbol \lambda_{ex}&quot; /&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;Rate of contact of each species with pathogen spores from outside the site&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;New susceptible trees enter the system via density-dependent seedling recruitment and resprouting from recently killed trees. Susceptible trees become infected at rates proportional to contact with infected trees (density-dependent), and pathogen migrating into the system. Both susceptible and infected trees die at constant, but different, rates.&lt;/p&gt;
&lt;p&gt;The model is modified from Cobb et al. (2012) in several ways: (1) inclusion of demographic stochasticity, (2) conversion from continuous to discrete time, (3) the inclusion of &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \lambda_{ex}&quot; alt=&quot;\lambda_{ex}&quot; /&gt;&lt;/span&gt;, the force of infection from areas outside the system, and (4) the exclusion of recovery of infected trees, which has not been observed in the field. Finally, the only population structure in Model A is the difference in species parameters. It excludes age structure and spatial structure, assuming a well-mixed population and frequency-dependent transmission (Following Diekmann et al. (1990))&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Model B&lt;/strong&gt; adds stage structure to Model A. In this case, the vectors &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \boldsymbol{S_t}&quot; alt=&quot;\boldsymbol{S_t}&quot; /&gt;&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \boldsymbol{I_t}&quot; alt=&quot;\boldsymbol{I_t}&quot; /&gt;&lt;/span&gt; represent the population divided by species and size class as follows&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
S&amp;#39;_t &amp;amp;\sim S_t - \text{Binom}_1\left((1 - e^{-\boldsymbol{\beta I_t} - \boldsymbol{\lambda_{ex}}})\boldsymbol{S_t} \right) \\
I&amp;#39;_t &amp;amp;\sim I_t + \text{Binom}_1\left((1 - e^{-\boldsymbol{\beta I_t} - \boldsymbol{\lambda_{ex}}})\boldsymbol{S_t} \right) \\
S_{t+1} &amp;amp;\sim \text{Multinom}(\boldsymbol{A_S(S&amp;#39;_t,I&amp;#39;_t)S&amp;#39;_t}) + \text{Pois}\left[\boldsymbol{b(S&amp;#39;_t+I&amp;#39;_t)}\left(1-\sum_{i=1}^n w_i (S&amp;#39;_{it} + I&amp;#39;_{it}) \right) + \boldsymbol{rm_I I&amp;#39;_t}\right] \\
I_{t+1} &amp;amp;\sim \text{Multinom}(\boldsymbol{A_I(S&amp;#39;_t,I&amp;#39;_t)I&amp;#39;_t})
\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Here &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \boldsymbol{A}&quot; alt=&quot;\boldsymbol{A}&quot; /&gt;&lt;/span&gt; is the matrix of demographic rates specifying transitions between classes and mortality. &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \boldsymbol{A}&quot; alt=&quot;\boldsymbol{A}&quot; /&gt;&lt;/span&gt; is a block-diagonal matrix of size transition matrices, with no transitions between species classes.&lt;/p&gt;
&lt;p&gt;Disease transitions are separated in time from demmographic transitions (Klepac and Caswell 2010). In California, &lt;em&gt;P. Ramorum&lt;/em&gt; reproduces and spreads during the winter rainy season while most tree growth occurs in the spring and fall.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Models 3 and 4&lt;/strong&gt; modify Models 1 and 2 by adding spatial structure in the form of a lattice metapopulation. &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \boldsymbol{S_t}&quot; alt=&quot;\boldsymbol{S_t}&quot; /&gt;&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \boldsymbol{I_t}&quot; alt=&quot;\boldsymbol{I_t}&quot; /&gt;&lt;/span&gt; become &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \boldsymbol{S_{jt}}&quot; alt=&quot;\boldsymbol{S_{jt}}&quot; /&gt;&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \boldsymbol{I_{jt}}&quot; alt=&quot;\boldsymbol{I_{jt}}&quot; /&gt;&lt;/span&gt;, matrices of each species and class at each location. Furthermore, the force of infection &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \left((1 - e^{-\boldsymbol{\beta I_t} - \boldsymbol{\lambda_{ex}}})\boldsymbol{S_t} \right)&quot; alt=&quot;\left((1 - e^{-\boldsymbol{\beta I_t} - \boldsymbol{\lambda_{ex}}})\boldsymbol{S_t} \right)&quot; /&gt;&lt;/span&gt; is replaced with an overall force of infection &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \Lambda_{jt}&quot; alt=&quot;\Lambda_{jt}&quot; /&gt;&lt;/span&gt; at each location&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;&lt;div style=&quot;text-align:center;&quot;&gt;&lt;img src=&quot;http://latex.codecogs.com/png.latex?\Lambda_{jt} =  \boldsymbol\beta \sum_{x=1}^J \phi (\boldsymbol I_{xt}, j, \boldsymbol{\theta}) + \lambda_{ex}&quot; alt=&quot;\Lambda_{jt} =  \boldsymbol\beta \sum_{x=1}^J \phi (\boldsymbol I_{xt}, j, \boldsymbol{\theta}) + \lambda_{ex}&quot; /&gt;&lt;/div&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Here &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline j&quot; alt=&quot;j&quot; /&gt;&lt;/span&gt; is the location, &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \phi&quot; alt=&quot;\phi&quot; /&gt;&lt;/span&gt; is the dispersal kernel of &lt;em&gt;P. ramorum&lt;/em&gt; from all locations &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline x&quot; alt=&quot;x&quot; /&gt;&lt;/span&gt; to &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline s&quot; alt=&quot;s&quot; /&gt;&lt;/span&gt;, and &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \theta&quot; alt=&quot;\theta&quot; /&gt;&lt;/span&gt; is a vector of parameters of the dispersal kernel. &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \boldsymbol{\beta}&quot; alt=&quot;\boldsymbol{\beta}&quot; /&gt;&lt;/span&gt; remains the contact matrix, representing physiological and vertical dispersal components of spore dispersal. I will test the models using normal, exponential, and power-law disperal kernels.&lt;/p&gt;
&lt;p&gt;Using these four models, I will determine:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;How global epidemic growth rate &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline R_0&quot; alt=&quot;R_0&quot; /&gt;&lt;/span&gt;, probability of global epidemic, the epidemic size, and time to extinction of both hosts and pathogens vary between the models&lt;/li&gt;
&lt;li&gt;How the presence of each form of population structure affect these values when global species densities and mean parameter values remain identical&lt;/li&gt;
&lt;li&gt;Whether the effects of population structure are additive or if they interact in a more complex way.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The model will be parameterized with three species: tanoak, bay, and redwood, (the latter representing all non-host species). Parameters and initial conditions will be drawn from Cobb et al. (2012) and @Filipe2013.&lt;/p&gt;
&lt;h3 id=&quot;selecting-the-model-that-best-repesents-observed-behavior&quot;&gt;Selecting the Model that Best Repesents Observed Behavior&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;3. What aspects of population structure are most important in &lt;em&gt;predicting&lt;/em&gt; the probability and size of SOD outbreaks?&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;To apply the understanding developed in exploring model structure to management, I must determine which model best represents observed dynamics of SOD in forests. I will fit the four models above to data of SOD spread in redwood-tanoak-bay forests in California and compare their ability to predict disease development&lt;/p&gt;
&lt;h4 id=&quot;data&quot;&gt;Data&lt;/h4&gt;
&lt;p&gt;Data to fit the models comes from a collaboration with the Rizzo lab’s disease monitoring plot network [@Ref; @Ref; 2012]. The data consist of observations tree size, alive/dead status, and disease status for trees greater than 1 cm diameter from the years 2002-2007. Trees were observed in 14 sites along the California coast from X (36.16°N) to Y (38.35°N), each of which contains an average of 8 500 m&lt;sup&gt;2&lt;/sup&gt;, seperated by minimium distances of 100m and arranged in a random linear sequence. All plots are in forests dominated by redwood, tanoak, and bay laurel.&lt;/p&gt;
&lt;p&gt;Size, health, and disease status of all trees were measured in 2002 and 2007, as well as for a random sample of 5 previously infected and 5 previously uninfected trees of each species per plot in the years 2003-2006.&lt;/p&gt;
&lt;p&gt;Since the time scale of the are not suffiently long to data to determine transition between size classes, the parameters of transition matrices will be drawn from other data from other sites and included as strong priors on these parameters.&lt;/p&gt;
&lt;h4 id=&quot;the-observation-model&quot;&gt;The Observation Model&lt;/h4&gt;
&lt;p&gt;The process generating the data above may be considered &lt;strong&gt;hidden Markov process&lt;/strong&gt; (Gimenez et al. 2012), that is, processes where the state of the system is dependent on its previous state, but where states are partially or imperfectly observed. Imperfect observation in this case is due to incomplete counting of trees and error in determination of tree disease status. Tree disease is determined by subjective examination of symptoms in the field, and then confirmed in the lab for those individuals with sufficiently suggestive symptoms. There are both false positives and false negatives:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
 p_{OI} &amp;amp;= p(\text{Observing that tree is diseased}|\text{tree is diseased}) \\
 p_{OS} &amp;amp;= p(\text{Observing that tree is healty}|\text{tree is healthy})
\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Then, for each sub-population (by species, size class, or location) observed in each time period, then, the observed number of susceptible and infected trees are:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
S_{obs} \sim \text{Binom}\left(p_{OS} S + (1-p_{OI}) I \right) \\
N_{obs} \sim \text{Binom}\left(p_{OI} I + (1-p_{OS}) S \right) 
\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;OMITTED HERE: OBSERVATION MODEL FOR PARTIAL CENSUS YEARS THAT I REALIZED WAS WRONG&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;Finally, for models with size-class structure, the observations omit the smallest size class (seeds and seedlings &amp;lt; 1 cm), as these were not measured.&lt;/p&gt;
&lt;h4 id=&quot;model-fitting&quot;&gt;Model Fitting&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;Particle filtering&lt;/strong&gt; determines the likelihood of a hidden Markov process by taking advantage of the fact that, at each time step, the likelihood of a system state is dependent on the previous state &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline (X_{t+1})&quot; alt=&quot;(X_{t+1})&quot; /&gt;&lt;/span&gt;, and the observation &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline (Y_t)&quot; alt=&quot;(Y_t)&quot; /&gt;&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;&lt;div style=&quot;text-align:center;&quot;&gt;&lt;img src=&quot;http://latex.codecogs.com/png.latex?p(X_t) = p(X_t | X_{t-1}, Y_t)&quot; alt=&quot;p(X_t) = p(X_t | X_{t-1}, Y_t)&quot; /&gt;&lt;/div&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;While &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline X_{1:t}&quot; alt=&quot;X_{1:t}&quot; /&gt;&lt;/span&gt; is hidden, &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline p(X_t|X_{t-1})&quot; alt=&quot;p(X_t|X_{t-1})&quot; /&gt;&lt;/span&gt; may be approximated by by simulation of the model process. Repeated simulations (&lt;em&gt;particles&lt;/em&gt;) provide a distribution of outcomes from which average likelihood are determined from the observation model &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline (p(X_t|Y_t))&quot; alt=&quot;(p(X_t|Y_t))&quot; /&gt;&lt;/span&gt;. For each time step, the particles are re-sampled according to their individual likelihoods, in order to prevent &lt;em&gt;particle degeneracy&lt;/em&gt; - most particles approaching zero likelihood. The product of all steps’ averaged particle likelihoods is an unbiased estimate of the model likeihood.(Arulampalam et al. 2002)&lt;/p&gt;
&lt;p&gt;With an estimate of likelihood available, one needs an approach to determine the maximum-likelihood estimate of the model parameters &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline (\theta)&quot; alt=&quot;(\theta)&quot; /&gt;&lt;/span&gt;. Several methods are available. &lt;strong&gt;Iterated filtering&lt;/strong&gt; (IF) estimates &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \theta&quot; alt=&quot;\theta&quot; /&gt;&lt;/span&gt; by replacing constant parameter values with a random walk &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \theta_t&quot; alt=&quot;\theta_t&quot; /&gt;&lt;/span&gt; of decreasing variance over time, and determining the “states” of this walk as the variance approaches zero. IF is computationally efficient but requires long time series.&lt;/p&gt;
&lt;p&gt;Alternatively, &lt;strong&gt;Particle Filter Markov Chain Monte Carlo&lt;/strong&gt; (PFMCMC) uses a Markov Chain sampler (e.g., Metropolis-Hastings), calculating the likelihood at each iteration using a particle filter. While computationally expensive, it does not require long time series and may be used with multiple time series. PFMCMC also integrates particle filtering into a Bayesian context, allowing the use of informative priors. I will used PFMCMC to determine maximum-likelihood parameterizations for all four models.&lt;/p&gt;
&lt;p&gt;When fitting models 1 and 2 to the data, populations from each plot in each site will be aggregated. For models 3 and 4, each plot will represent a single sub-population on a lattice spanning the site. Initial density, species, age and disease distributions for other sub-populations will be randomly generated from other points on the lattice using the proportions from the measured plots. Epidemiological parameters will remain constant across sites except for the external force of disease &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \lambda_{ex}&quot; alt=&quot;\lambda_{ex}&quot; /&gt;&lt;/span&gt;, which will be represented as a noramlly distributed random variable to account for site effects. varies.&lt;/p&gt;
&lt;h4 id=&quot;model-selection&quot;&gt;Model selection&lt;/h4&gt;
&lt;p&gt;Model selection criteria have multiple purposes: to determine which model best represents “true” processes, and to estimate the utility of models for the purposes of prediction. In this case, I am interested in both - determining which components population structure matter, and also providing an estimate of predictive stength of the best model. For these purposes, I will use the &lt;strong&gt;deviance information criterion&lt;/strong&gt; (Spiegelhalter et al. 2002, DIC). DIC has several advantages. Since it estimates the model complexity, or effective number of parameters, directly from the likelohood distribution, it makes it easy to incorporate random parameters such as &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \lambda_{ex}&quot; alt=&quot;\lambda_{ex}&quot; /&gt;&lt;/span&gt; that have non-integer contributions to model complexity. Secondly, it estimates the how priors on parameter values effect their contribution to model complexity.&lt;/p&gt;
&lt;p&gt;DIC is not suitable for model-averaging. However, model-averaged results will not likely be useful for the optimization analysis below. Using the best-DIC model for prediction is a compromise between predictive ability and tractable analysis of the model used for prediction. Use of DIC assumes that there is a “best” or “real” model within the comparison. While no models are “true” (Box 1976), this excercise is selecting a “best” or “most useful” model for scenario exploration.&lt;/p&gt;
&lt;h3 id=&quot;using-dynamic-optimization-to-determine-the-best-control-strategy&quot;&gt;Using Dynamic Optimization to Determine the Best Control Strategy&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;4. What control strategy minimizes the probability of SOD outbreaks at least cost?&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The best-fit model that captures essential aspects of the disease dynamics will be used to develop an optimal control solution to minimization of disease risk over time.&lt;/p&gt;
&lt;p&gt;While forest disease management can occur under multiple, conflicting and uncertain goals and priorities, here I consider the case where conservation of tanoak and its ecosystem services are the goal. This is approximately the case in Humboldt County, California, where large landowners have agreed to work in tandem to control the disease. In this situation, managers goals can be simplified to three components: (1) The minimum acceptable density of the species of interest &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline (N_{min})&quot; alt=&quot;(N_{min})&quot; /&gt;&lt;/span&gt;, (2) the cumulative acceptable probability that the species will fall below that density &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline (p_{acc})&quot; alt=&quot;(p_{acc})&quot; /&gt;&lt;/span&gt; during the management period, and (3) the cost of disease control &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline C&quot; alt=&quot;C&quot; /&gt;&lt;/span&gt;. Using acceptable probabilities avoids the challenge of defining and valuing the flows of ecosystem services as a function of the forest composition (Hartman 1976).&lt;/p&gt;
&lt;p&gt;Tools for SOD control can be categorized into two types. Silvicultural (“host-centric”) treatments change forest composition. “Pathogen-centric” treatments, such as quarantine, equipment cleaning and spraying, reduce the probability of spore arrival (Swiecki and Bernhardt 2013).&lt;/p&gt;
&lt;p&gt;I represent these two types of treatment with two control functions. Cutting is a periodic control treatment that can be imposed in any year. I define the cut as a reduction in species density to the levels that would minimize the probability of species densities falling below the acceptable level over a management period without further controls. This will be a value that balances stochastic risk of extinction with risk of diseae outbreak, bounded by the minimum acceptable species density. As tanoak and bay laurel trees have little timber value, each cut has a cost &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline (c_1)&quot; alt=&quot;(c_1)&quot; /&gt;&lt;/span&gt;. For the purpose of this model &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline c_1&quot; alt=&quot;c_1&quot; /&gt;&lt;/span&gt; is independent of the extent of density reduction (that is, the variable costs of cutting are negligible. Thus, the annual cost of cutting is &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline c_1 E_1&quot; alt=&quot;c_1 E_1&quot; /&gt;&lt;/span&gt;, where &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline E_1&quot; alt=&quot;E_1&quot; /&gt;&lt;/span&gt; is a zero-one control variable&lt;/p&gt;
&lt;p&gt;Spraying is an ongoing control treatment that represents the combined annual effort to reduce the arrival of new spores at the site. This modifies the external force of infection&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline \lambda_{ex} \equiv \lambda_0 \times (1 - e^{-a E_2 c_2})&quot; alt=&quot;\lambda_{ex} \equiv \lambda_0 \times (1 - e^{-a E_2 c_2})&quot; /&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline a&quot; alt=&quot;a&quot; /&gt;&lt;/span&gt; is the effectiveness of treatment, &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline E_2&quot; alt=&quot;E_2&quot; /&gt;&lt;/span&gt; is the effort spent at spraying and &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline c_2&quot; alt=&quot;c_2&quot; /&gt;&lt;/span&gt; is the annual cost per unit effort.&lt;/p&gt;
&lt;p&gt;The dynamic optimization problem is to determine the combination of treatment effort over time &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline (E_1t, E_2t)&quot; alt=&quot;(E_1t, E_2t)&quot; /&gt;&lt;/span&gt; that minimizes the cost of treatment while maintaining the probability of species loss at an acceptable level. That is,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;&lt;div style=&quot;text-align:center;&quot;&gt;&lt;img src=&quot;http://latex.codecogs.com/png.latex?\min \sum_{t=1}^T c_1(E_1)+ c_2(E_2) \text{ s.t. } p(N_t &amp;lt; N_{\min}) &amp;lt; p_{acc}&quot; alt=&quot;\min \sum_{t=1}^T c_1(E_1)+ c_2(E_2) \text{ s.t. } p(N_t &amp;lt; N_{\min}) &amp;lt; p_{acc}&quot; /&gt;&lt;/div&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;An alternative formulation, also useful to managers, is to minimize the probability of outbreak given budget constraints &lt;span class=&quot;math&quot;&gt;&lt;img style=&quot;vertical-align:middle&quot; src=&quot;http://latex.codecogs.com/png.latex?\inline (B)&quot; alt=&quot;(B)&quot; /&gt;&lt;/span&gt;. Budget constraints could be forumulated as total budgets for the entire mangement period, or annual limits on spending. That is&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;&lt;div style=&quot;text-align:center;&quot;&gt;&lt;img src=&quot;http://latex.codecogs.com/png.latex?\min \sum_{t=1}^T p_{(N_t &amp;lt; N_{\min})} \text{ s.t. } \sum_0^T c_1 (E_2) +  c_2(E_2) \leq B_T&quot; alt=&quot;\min \sum_{t=1}^T p_{(N_t &amp;lt; N_{\min})} \text{ s.t. } \sum_0^T c_1 (E_2) +  c_2(E_2) \leq B_T&quot; /&gt;&lt;/div&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;or&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;&lt;div style=&quot;text-align:center;&quot;&gt;&lt;img src=&quot;http://latex.codecogs.com/png.latex?\min \sum_{t=1}^T p_{(N_t &amp;lt; N_{\min})} \text{ s.t. } c_1(E_1) + c_2(E_2) \leq B_{ann} \forall \, T&quot; alt=&quot;\min \sum_{t=1}^T p_{(N_t &amp;lt; N_{\min})} \text{ s.t. } c_1(E_1) + c_2(E_2) \leq B_{ann} \forall \, T&quot; /&gt;&lt;/div&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h2 id=&quot;references&quot;&gt;References&lt;/h2&gt;
&lt;p&gt;Anderson, R. M., and R. M. May. 1985. Age-related changes in the rate of disease transmission: implications for the design of vaccination programmes. J. Hyg. Camb.&lt;/p&gt;
&lt;p&gt;Arulampalam, M. S., S. Maskell, N. Gordon, and T. Clapp. 2002. A tutorial on particle filters for online nonlinear/non-Gaussian Bayesian tracking. IEEE Transactions on Signal Processing 50:174–188.&lt;/p&gt;
&lt;p&gt;Box, G. E. P. 1976. Science and Statistics. Journal of the American Statistical Association 71:791–799.&lt;/p&gt;
&lt;p&gt;Brown, D. H., and B. M. Bolker. 2004. The effects of disease dispersal and host clustering on the epidemic threshold in plants. Bulletin of mathematical biology 66:341–71.&lt;/p&gt;
&lt;p&gt;Cobb, R. C., J. A. N. Filipe, R. K. Meentemeyer, C. A. Gilligan, and D. M. Rizzo. 2012. Ecosystem transformation by emerging infectious disease: loss of large tanoak from California forests. Journal of Ecology:no–no.&lt;/p&gt;
&lt;p&gt;Craft, M. E., and P. L. Hawthorne. 2008. Dynamics of a multihost pathogen in a carnivore community. Journal of Animal Ecology 77:1257–1264.&lt;/p&gt;
&lt;p&gt;Davidson, J. M., A. C. Wickland, H. A. Patterson, K. R. Falk, and D. M. Rizzo. 2005. Transmission of Phytophthora ramorum in Mixed-Evergreen Forest in California. Phytopathology 95:587–596.&lt;/p&gt;
&lt;p&gt;DiLeo, M. V., R. M. Bostock, and D. M. Rizzo. 2009. Phytophthora ramorum does not cause physiologically significant systemic injury to California bay laurel, its primary reservoir host.. Phytopathology 99:1307–11.&lt;/p&gt;
&lt;p&gt;Diekmann, O., J. A. P. Heesterbeek, and J. A. J. Metz. 1990. On the definition and the computation of the basic reproduction ratio R 0 in models for infectious diseases in heterogeneous populations. Journal of Mathematical Biology 28:365–382.&lt;/p&gt;
&lt;p&gt;Dobson, A. 2004. Population dynamics of pathogens with multiple host species.. The American Naturalist 164 Suppl:S64–78.&lt;/p&gt;
&lt;p&gt;Filipe, J. A. N., and M. M. Maule. 2003. Analytical methods for predicting the behaviour of population models with general spatial interactions. Mathematical Biosciences 183:15–35.&lt;/p&gt;
&lt;p&gt;Filipe, J. A. N., and M. M. Maule. 2004. Effects of dispersal mechanisms on spatio-temporal development of epidemics. Journal of Theoretical Biology 226:125–141.&lt;/p&gt;
&lt;p&gt;Gilbert, G. S., and S. P. Hubbell. 1996. Diseases and the Tropical of Conservation Forests. BioScience 46:98–106.&lt;/p&gt;
&lt;p&gt;Gimenez, O., J. D. Lebreton, J. M. Gaillard, R. Choquet, and R. Pradel. 2012. Estimating demographic parameters using hidden process dynamic models. Theoretical Population Biology 82:307–316.&lt;/p&gt;
&lt;p&gt;Hansen, E. M., and E. M. Goheen. 2000. Phellinus Weirii and other Native Root Pathogens as Determinants of Forest Structure and Process in Western North America. Annual review of phytopathology 38:515–539.&lt;/p&gt;
&lt;p&gt;Hartman, R. 1976. The Harvesting Decision when a Standing Forest has Value. Economic Inquiry 14:52–58.&lt;/p&gt;
&lt;p&gt;Holdenrieder, O., M. Pautasso, P. J. Weisberg, and D. Lonsdale. 2004. Tree diseases and landscape processes: the challenge of landscape pathology.. Trends in ecology &amp;amp; evolution (Personal edition) 19:446–52.&lt;/p&gt;
&lt;p&gt;Ionides, E. L., C. Bretó, and a a King. 2006. Inference for nonlinear dynamical systems. Proceedings of the National Academy of Sciences of the United States of America 103:18438–43.&lt;/p&gt;
&lt;p&gt;Kermack, W. O., and A. G. Mckendrick. 1927. A Contribution to the Mathematical Theory of Epidemics. Proceedings of the Royal Society of London. Series A: Mathematical and Physical Sciences 115:700–721.&lt;/p&gt;
&lt;p&gt;Klepac, P., and H. Caswell. 2010. The stage-structured epidemic: linking disease and demography with a multi-state matrix approach model. Theoretical Ecology 4:301–319.&lt;/p&gt;
&lt;p&gt;Knape, J., and P. de Valpine. 2012. Fitting complex population models by combining particle filters with Markov chain Monte Carlo.. Ecology 93:256–63.&lt;/p&gt;
&lt;p&gt;Kovacs, K., T. Václavík, R. G. Haight, A. Pang, N. J. Cunniffe, C. a Gilligan, and R. K. Meentemeyer. 2011. Predicting the economic costs and property value losses attributed to sudden oak death damage in California (2010-2020).. Journal of environmental management 92:1292–302.&lt;/p&gt;
&lt;p&gt;Lovett, G. M., C. D. Canham, M. A. Arthur, C. Kathleen, R. D. Fitzhugh, and K. C. Weathers. 2006. Forest Ecosystem Responses to Exotic Pests and Pathogens in Eastern North America. BioScience 56:395–405.&lt;/p&gt;
&lt;p&gt;Meentemeyer, R. K., N. J. Cunniffe, A. R. Cook, J. A. N. Filipe, R. D. Hunter, D. M. Rizzo, and C. a Gilligan. 2011. Epidemiological modeling of invasion in heterogeneous landscapes: spread of sudden oak death in California (1990–2030). Ecosphere 2:1–24.&lt;/p&gt;
&lt;p&gt;Metcalf, C. J. E., J. Lessler, P. Klepac, A. Morice, B. T. Grenfell, and O. N. Bjø rnstad. 2012. Structured models of infectious disease: Inference with discrete data. Theoretical population biology 82:275–282.&lt;/p&gt;
&lt;p&gt;Metz, M. R., K. M. Frangioso, A. C. Wickland, R. K. Meentemeyer, and D. M. Rizzo. 2012. An emergent disease causes directional changes in forest species composition in coastal California. Ecosphere 3:art86.&lt;/p&gt;
&lt;p&gt;Park, A. W., S. Gubbins, and C. A. Gilligan. 2002. Extinction times for closed epidemics: the effects of host spatial structure. Ecology Letters 5:747–755.&lt;/p&gt;
&lt;p&gt;Park, A. W., S. Gubbins, and C. a Gilligan. 2001. Invasion and persistence of plant parasites in a spatially structured host population. Oikos 94:162–174.&lt;/p&gt;
&lt;p&gt;Rizzo, D. M., M. Garbelotto, J. M. Davidson, G. W. Slaughter, and S. T. Koike. 2002. Phytophthora ramorum and sudden oak death in California: I. Host relationships. Pages 733–740 &lt;em&gt;in&lt;/em&gt; Fifth Symposium on Oak Woodlands: Oaks in California’s Changing Landscapes. . USDA Forest Service, San Diego, CA.&lt;/p&gt;
&lt;p&gt;Rizzo, D. M., M. Garbelotto, and E. M. Hansen. 2005. Phytophthora ramorum: integrative research and management of an emerging pathogen in California and Oregon forests. Annual review of phytopathology 43:309–35.&lt;/p&gt;
&lt;p&gt;Rizzo, D. M., and M. Garbelotto. 2003. Sudden oak death: endangering California and Oregon forest ecosystems. Frontiers in Ecology and the Environment 1:197–204.&lt;/p&gt;
&lt;p&gt;Spiegelhalter, D. J., N. G. Best, B. P. Carlin, and A. van der Linde. 2002. Bayesian measures of model complexity and fit. Journal of the Royal Statistical Society: Series B (Statistical Methodology) 64:583–639.&lt;/p&gt;
&lt;p&gt;Swiecki, T. J., and E. Bernhardt. 2005. Disease risk factors and disease progress in coast live oak and tanoak affected by Phytophthora ramorum canker (sudden oak death). Pages 383–411 &lt;em&gt;in&lt;/em&gt; Proceedings of Sudden Oak Death Science Symposium II. PJ Shea and M. Haverty, eds. Pacific Southwest Research Station, Forest Service, US Department of Agriculture, Albany, CA.&lt;/p&gt;
&lt;p&gt;Swiecki, T. J., and E. A. Bernhardt. 2013. Managing sudden oak death in California: before, during, and after Phytophthora ramorum invasion. . U.S. Department of Agriculture; Forest Service; Pacific Southwest Research Station.&lt;/p&gt;
&lt;p&gt;Vehtari, A., and J. Ojanen. 2012. A survey of Bayesian predictive methods for model assessment, selection and comparison. Statistics Surveys 6:142–228.&lt;/p&gt;</content>
 </entry>
 
 <entry>
   <title>I try to figure out when many trees will die together</title>
   <link href="http://www.noamross.net/blog/2013/1/17/upgoer5.html"/>
   <updated>2013-01-17T14:49:49-08:00</updated>
   <id>hhttp://www.noamross.net/blog/2013/1/17/upgoer5</id>
   <content type="html">&lt;head&gt;
  &lt;style type=&quot;text/css&quot;  media=&quot;all&quot;&gt;
    table tbody {border-top:2px; border-bottom:2px;}
    table thead {border-bottom:1px;}
  &lt;/style&gt;
&lt;/head&gt; &lt;p&gt;The amazing &lt;a href=&quot;http://splasho.com/upgoer5/&quot;&gt;UpGoer5 text editor&lt;/a&gt; only allows you to use the 1000 most commonly used words in the english language. Here is &lt;a href=&quot;http://splasho.com/upgoer5/?i=H29gMKEcoJImVT1uoaxtqUWyMKZtM2I0VUAcL2ftLJ5xVTEcMFO2MKW5VUS1nJAeoUxhVPOWVTkio2ftLKDtnT93VTEyLKEbVT1iqzImVTWyqUqyMJ4tMTyzMzIlMJ50VTgcozEmVT9zVUElMJImVTShMPObo3ptM3WiqKOmVT9zVTEcMzMypzIhqPO0pzIyplOwnTShM2HtnT93VTMup3DtMTIuqTttoJ92MKZhVPOWVUElrFO0olOznJq1pzHto3I0VUqbMJ4toJShrFO0pzIyplO3nJkfVTEcMFO0o2qyqTuypvjtLJ5xVUEbMFO0rKOyVT9zVUEbnJ5aplO3MFOhMJIxVUEiVTgho3ptnJ4to3WxMKVtqT8tMzyaqKWyVUEbnKZto3I0VTSbMJSxVT9zVUEcoJHhVPOHnTIhVRxtqUW5VUEiVTMcM3IlMFOiqKDtq2uuqPO0olOxolO0olO0nTHtqUWyMKZto3MypvO0nJ1yVUImnJ5aVUEbMFOfMJSmqPOgo25yrFNtp28tqTuuqPOxMJS0nPOjpz9vLJWfrFO3nJkfVT5iqPOwo21yYPOyqzIhVTyzVT91pvOcMTIuplOiMvObo3ptMTIuqTttoJ92MKZtoJyanUDtLzHtq3Wiozpto3Vto2MzVTRtLzy0Yt==&quot;&gt;my research described using only those words&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Sometimes many trees get sick and die very quickly. I look at how death moves between different kinds of trees and how groups of different trees change how fast death moves. I try to figure out when many trees will die together, and the type of things we need to know in order to figure this out ahead of time. Then I try to figure out what to do to the trees over time using the least money so that death probably will not come, even if our ideas of how death moves might be wrong or off a bit.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;You’ll find more amazing science descriptions if you check out the &lt;a href=&quot;https://twitter.com/search/realtime?q=%23upgoerfive&quot;&gt;#upgoer5&lt;/a&gt; tag on Twitter.&lt;/p&gt;</content>
 </entry>
 
 <entry>
   <title>Steve Culman on the `plyr` Package</title>
   <link href="http://www.noamross.net/blog/2013/1/17/steve-culman-on-plyr.html"/>
   <updated>2013-01-17T10:11:48-08:00</updated>
   <id>hhttp://www.noamross.net/blog/2013/1/17/steve-culman-on-plyr</id>
   <content type="html">&lt;head&gt;
  &lt;style type=&quot;text/css&quot;  media=&quot;all&quot;&gt;
    table tbody {border-top:2px; border-bottom:2px;}
    table thead {border-bottom:1px;}
  &lt;/style&gt;
&lt;/head&gt; &lt;p&gt;At &lt;a href=&quot;http://www.noamross.net/davis-r-users-group.html&quot;&gt;Davis R Users’ Group&lt;/a&gt; yesteray, &lt;a href=&quot;http://ucanr.edu/sites/Jackson_Lab/Steve_Culman_519/&quot;&gt;Steve Culman&lt;/a&gt; gave us an introduction to the &lt;code&gt;plyr&lt;/code&gt; package and how to use it to manipulate data. Here’s his presentation, and the accompanying demonstration script:&lt;/p&gt;
&lt;iframe src=&quot;http://www.slideshare.net/slideshow/embed_code/16043843&quot; width=&quot;427&quot; height=&quot;356&quot; frameborder=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; scrolling=&quot;no&quot; style=&quot;border:1px solid #CCC;border-width:1px 1px 0;margin-bottom:5px&quot; allowfullscreen webkitallowfullscreen mozallowfullscreen&gt; &lt;/iframe&gt; 

&lt;script src=&quot;https://gist.github.com/4558068.js&quot;&gt;&lt;/script&gt;

&lt;p&gt;Steve’s talk is based on &lt;a href=&quot;http://www.jstatsoft.org/v40/i01/paper&quot;&gt;this paper by Hadley Wickham in the Journal of Statistical Software&lt;/a&gt;. A lot of useful related resources are at &lt;a href=&quot;http://plyr.had.co.nz/&quot;&gt;Hadley Wickham’s &lt;code&gt;plyr&lt;/code&gt; website&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;We had a quick exchange about using &lt;code&gt;plyr&lt;/code&gt; for parallel processing. More on that was discussed on the listserv &lt;a href=&quot;https://groups.google.com/forum/#!msg/davis-rug/VLIXz5i3vZI/lWVNpRnr930J&quot;&gt;here&lt;/a&gt;&lt;/p&gt;</content>
 </entry>
 
 <entry>
   <title>Don't R alone! A guide to tools for collaboration with R</title>
   <link href="http://www.noamross.net/blog/2013/1/7/collaborating-with-r.html"/>
   <updated>2013-01-07T09:10:36-08:00</updated>
   <id>hhttp://www.noamross.net/blog/2013/1/7/collaborating-with-r</id>
   <content type="html">&lt;head&gt;
  &lt;style type=&quot;text/css&quot;  media=&quot;all&quot;&gt;
    table tbody {border-top:2px; border-bottom:2px;}
    table thead {border-bottom:1px;}
  &lt;/style&gt;
&lt;/head&gt; &lt;p&gt;This a brief guide to using R in collaborative, social ways. R is a powerful open-source programming language for data analysis, statistics, and visualization, but much of its power derives from a large, engaged &lt;em&gt;community&lt;/em&gt; of users. This is an introduction to tools for engaging the community to improve your R code and collaborate with others.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;(Am I missing anything? Let me know in the &lt;a href=&quot;#disqus_thread&quot;&gt;comments&lt;/a&gt; and I’ll update this guide.)&lt;/em&gt;&lt;/p&gt;
&lt;h2 id=&quot;topics&quot;&gt;Topics&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#asking-questions-via-e-mail-listservs-and-bulletin-boards&quot;&gt;Asking questions via e-mail, listservs and bulletin boards&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#sharing-r-scripts-with-gist.github.com&quot;&gt;Sharing R scripts with &lt;code&gt;gist.github.com&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#sharing-reports-of-code-and-results-with-knitr&quot;&gt;Sharing reports of code and results with &lt;code&gt;knitr&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#collaborating-and-version-control&quot;&gt;Collaborating and version control&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#dropbox&quot;&gt;Dropbox&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#git-and-github&quot;&gt;Git and Github&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#package-creation-and-sharing&quot;&gt;Package creation and sharing&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#rstudio&quot;&gt;RStudio&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#interactive-r-with-shiny&quot;&gt;Interactive R with Shiny&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#upcoming-tools-for-real-time-interactive-and-collaborative-programming&quot;&gt;Upcoming tools for real-time, interactive and collaborative programming&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#engaging-with-r-communities-online&quot;&gt;Engaging with R Communities Online&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;asking-questions-via-e-mail-listservs-and-bulletin-boards&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Asking questions via e-mail, listservs and bulletin boards&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;One of the best ways to tap into the knowledge of the R community is to use the listservs and websites devoted to answering questions about R. There are a large number of these online forums. Some of the most popular are the &lt;a href=&quot;https://stat.ethz.ch/mailman/listinfo/r-help&quot;&gt;R-help&lt;/a&gt; listserv, the progamming Q&amp;amp;A site &lt;a href=&quot;http://stackoverflow.com/questions/tagged/r&quot;&gt;Stack Overflow&lt;/a&gt;, and the statistics Q&amp;amp;A site &lt;a href=&quot;http://stats.stackexchange.com/&quot;&gt;Cross-Validated&lt;/a&gt;. (Be sure to look at the [R] tags on these two sites.) There are also &lt;a href=&quot;http://www.r-project.org/mail.html&quot;&gt;specialty listservs&lt;/a&gt; like &lt;a href=&quot;https://stat.ethz.ch/mailman/listinfo/r-sig-ecology&quot;&gt;R-sig-ecology&lt;/a&gt;, or &lt;a href=&quot;http://blog.revolutionanalytics.com/local-r-groups.html&quot;&gt;local forums&lt;/a&gt; like the &lt;a href=&quot;https://groups.google.com/forum/?fromgroups#!forum/davis-rug&quot;&gt;Davis R Users’ Group&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;These forums are great places to get help with your R questions. To get good answers, though its important to know how to ask good questions. Key to a good question is a &lt;strong&gt;minimal reproducible example&lt;/strong&gt; (MRE). An MRE is a bit of code that, when copy-and-pasted from an e-mail into R, will reproduce the results or problem you are asking about. Here is a &lt;a href=&quot;http://stackoverflow.com/a/5963610/1757441&quot;&gt;great guide to producing a reproducible example&lt;/a&gt;. A few important components:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;a minimal dataset, necessary to reproduce the error&lt;/li&gt;
&lt;li&gt;the minimal runnable code necessary to reproduce the error, which can be run on the given dataset.&lt;/li&gt;
&lt;li&gt;the necessary information on the used packages, R version and system it is run on.&lt;/li&gt;
&lt;li&gt;in case of random processes, a seed (set by set.seed()) for reproducibility&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;One useful trick for producing an MRE is the &lt;code&gt;dput()&lt;/code&gt; command. &lt;code&gt;dput&lt;/code&gt; takes any object in R and prints it in a form that can be copy-and-pasted. For instance, say you have a data frame like this:&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;df &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;data.frame&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;a =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;:&lt;span class=&quot;dv&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;b =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;6&lt;/span&gt;:&lt;span class=&quot;dv&quot;&gt;10&lt;/span&gt;)
df&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;##   a  b
## 1 1  6
## 2 2  7
## 3 3  8
## 4 4  9
## 5 5 10&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Running &lt;code&gt;dput&lt;/code&gt; creates text that can be entered into R make an identical structure&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;kw&quot;&gt;dput&lt;/span&gt;(df)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;## structure(list(a = 1:5, b = 6:10), .Names = c(&amp;quot;a&amp;quot;, &amp;quot;b&amp;quot;), row.names = c(NA, 
## -5L), class = &amp;quot;data.frame&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now you can insert this data into your MRE by typing:&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;df &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;structure&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;list&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;a =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;:&lt;span class=&quot;dv&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;b =&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;6&lt;/span&gt;:&lt;span class=&quot;dv&quot;&gt;10&lt;/span&gt;), &lt;span class=&quot;dt&quot;&gt;.Names =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;a&amp;quot;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;quot;b&amp;quot;&lt;/span&gt;), 
  &lt;span class=&quot;dt&quot;&gt;row.names =&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;ot&quot;&gt;NA&lt;/span&gt;, -5L), &lt;span class=&quot;dt&quot;&gt;class =&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;&amp;quot;data.frame&amp;quot;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Your real data is probably considerably larger and more complex, and could be in the form of a data frame, list, or any other number of objects. Try running &lt;code&gt;dput(mtcars)&lt;/code&gt; to see the results with a larger data set. It’s often shorter to use &lt;code&gt;dput&lt;/code&gt; on cleaned-up, manipulated data than including a lot of data-manipulation steps in your MRE. If your dataset is large, simply use &lt;code&gt;dput(head(mtcars))&lt;/code&gt; to share only the first few rows. &lt;a href=&quot;http://stackoverflow.com/questions/12647159/turning-a-data-frame-into-a-single-row&quot;&gt;Here&lt;/a&gt; is an example of how using this method yields useful responses.&lt;/p&gt;
&lt;p&gt;Similarly, it is easy to share more information about your set up using the &lt;code&gt;sessionInfo()&lt;/code&gt; function. It returns information about your R version, your platform, base, and loaded packages, all of which are really helpful for troubleshooting purposes. Simply copy and paste the output from the function alongside your question.&lt;/p&gt;
&lt;h2 id=&quot;sharing-r-scripts-with-gist.github.com&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Sharing R scripts with &lt;code&gt;gist.github.com&lt;/code&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Sometimes you want to share an R code that you’ve written. Creating a &lt;strong&gt;gist&lt;/strong&gt; is a great way to do so. Gists are have several advantages over sharing over e-mail:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;You can share the code just by sending a URL&lt;/li&gt;
&lt;li&gt;Syntax highlighting makes the code easier to read&lt;/li&gt;
&lt;li&gt;You can update the code and it will remember previous versions&lt;/li&gt;
&lt;li&gt;The gist can be public or private&lt;/li&gt;
&lt;li&gt;People can comment on the gist and have a conversation&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To post your code as a gist, go to &lt;a href=&quot;http://gist.github.com&quot;&gt;http://gist.github.com&lt;/a&gt;, and paste your code, and put in a brief description. You’ll get an easily sharable web page like this:&lt;/p&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/gistexample.png&quot; /&gt;
&lt;/div&gt;
&lt;p&gt;Signing up for the website is not neccessary, but it is needed if you want to revise your gist in the future.&lt;/p&gt;
&lt;p&gt;A gist can include multiple files, so sometimes its useful for to include both an R script and your source data file in one gist.&lt;/p&gt;
&lt;h2 id=&quot;sharing-reports-of-code-and-results-with-knitr&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Sharing reports of code and results with &lt;code&gt;knitr&lt;/code&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Often you want to share the results of analyses you perform in R with colleagues or the broader online community. A good way to do this is with a &lt;em&gt;report&lt;/em&gt; - a document of text, code, and results (often graphs). &lt;code&gt;knitr&lt;/code&gt; is an R package for making reports that can be printed or shared on the web.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;knitr&lt;/code&gt; takes documents that are a mixture of text and code, extracts the code and runs it, and then inserts the code and results back in. This has several advantages:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;If you change your code, all you have to do is re-run knitr, rather than run the code, copy-and-paste results, and then do re-formatting&lt;/li&gt;
&lt;li&gt;Colleagues who read your report can see exactly the steps you took to reach your results, and reproduce them if they want.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;knitr&lt;/code&gt; can work with a variety of different document types: HTML, LaTeX, etc., but most commonly people use &lt;strong&gt;markdown&lt;/strong&gt;, which is a simple syntax designed for producing web pages. Here’s what a short markdown document using &lt;code&gt;knitr&lt;/code&gt; looks like:&lt;/p&gt;
&lt;pre class=&quot;sourceCode markdown&quot;&gt;&lt;code&gt;Title
=====

This is an example document.  Here&amp;#39;s a summary of some data:

```{r}
summary(cars)
```

Here is a plot of that data:

```{r}
plot(cars)
```&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If you save this file as &lt;code&gt;example.Rmd&lt;/code&gt; (R-markdown), and run&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;&lt;span class=&quot;kw&quot;&gt;library&lt;/span&gt;(knitr)
&lt;span class=&quot;kw&quot;&gt;library&lt;/span&gt;(markdown)
&lt;span class=&quot;kw&quot;&gt;knit&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;example.Rmd&amp;quot;&lt;/span&gt;)
&lt;span class=&quot;kw&quot;&gt;markdownToHTML&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;example.md&amp;quot;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You get an HTML file called &lt;code&gt;example.HTML&lt;/code&gt;. Open it in a browser and it looks like this:&lt;/p&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/knitexample.png&quot; /&gt;
&lt;/div&gt;
&lt;p&gt;As you can see, your document has both your writing, code, and results, formatted in an easy-to-read way. You can e-mail these documents or post them online for easy sharing.&lt;/p&gt;
&lt;h2 id=&quot;collaborating-and-version-control&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Collaborating and version control&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;If you are working with a team on a project that involves multiple R analyses and data sets, you’ll want a more robust system for collaboration that just e-mailing files around. Here are two options.&lt;/p&gt;
&lt;h3 id=&quot;dropbox&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Dropbox&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;An easy way to share your R files and maintain version control is to use &lt;a href=&quot;https://www.dropbox.com/&quot;&gt;Dropbox&lt;/a&gt;. Dropbox is a service that syncs files across computers. If you and your collaborators share a Dropbox folder, changes will automatically stay up-to-date across all your computers. Importantly, Dropbox keeps previous versions of files and lets you revert to past versions, so you can go back if something in your code breaks:&lt;/p&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/dropboxexample.png&quot; /&gt;
&lt;/div&gt;
&lt;h3 id=&quot;git-and-github&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Git and Github&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://git-scm.com/&quot;&gt;Git&lt;/a&gt; is a version-control system widely used by programmers. It’s much more powerful than Dropbox version control, with features that include&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Fine-scale control of what files and folders change with each update&lt;/li&gt;
&lt;li&gt;Log messages to remind you of what changes were important with each version&lt;/li&gt;
&lt;li&gt;Creating parallel versions (branches) of projects&lt;/li&gt;
&lt;li&gt;Comparing different versions of files and folders&lt;/li&gt;
&lt;li&gt;Merging changes made on different branches or by different users.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Git has a bit of a learning curve, but if you do a lot of programming work in R or other languages, it is well worth it. To get started, see the documentation &lt;a href=&quot;https://github.com/hadley/devtools/wiki&quot;&gt;here&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Using Git alongside a web service like &lt;a href=&quot;https://github.com/&quot;&gt;Github&lt;/a&gt; or &lt;a href=&quot;https://bitbucket.org/&quot;&gt;Bitbucket&lt;/a&gt; lets you collaborate on projects in a very powerful way. Collaborators can work on code simultaneously, merge changes and resolve conflicts through the website. If you choose to make the project &lt;strong&gt;open-source&lt;/strong&gt;, your code can be public and you can tap into the expertise of many other collaborators.&lt;/p&gt;
&lt;p&gt;The R package &lt;code&gt;devtools&lt;/code&gt; lets you download and run files directly from these websites.&lt;/p&gt;
&lt;h2 id=&quot;package-creation-and-sharing&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Package creation and sharing&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;One of the great strengths of R is the collection of over 4,000 user created packages. You might want to create a package if you have developed a new method in R, or if you have a collection of helpful functions that would be useful to share. If you write a scientific publication using R for analysis, an accompanying package is a good way to make the data and methods accessible for other researchers to reproduce and build upon.&lt;/p&gt;
&lt;p&gt;Hadley Wickham has written a great guide to developing R packages, which can be found &lt;a href=&quot;https://github.com/hadley/devtools/wiki&quot;&gt;here&lt;/a&gt;. It accompanies his package &lt;code&gt;devtools&lt;/code&gt; which provides many useful tools for package development.&lt;/p&gt;
&lt;h2 id=&quot;rstudio&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;RStudio&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;If you want use the tools described above, it is helpful to use software that integrates them into your workflow. &lt;a href=&quot;http://www.rstudio.com/&quot;&gt;RStudio&lt;/a&gt; is a popular &lt;em&gt;integrated development environment&lt;/em&gt; (IDE). An IDE makes working in R easier by putting the R console, a text editor, file browser, help files, graphics and many other tools together into a cohesive interface. RStudio also integrates many of the collaborative tools described above. It is available for Mac, Windows, and Linux.&lt;/p&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/rstudio-windows.png&quot; /&gt;
&lt;/div&gt;
&lt;p&gt;If you use Rstudio, &lt;code&gt;knitr&lt;/code&gt; is automated for you. Just hit the “Knit HTML” button once you have written your R-markdown document, and it will generate the web page and show a preview:&lt;/p&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/knitbutton.png&quot; /&gt;
&lt;/div&gt;
&lt;p&gt;An additional benefit of using &lt;code&gt;knitr&lt;/code&gt; from Rstudio is that it will give you the option of automatically uploading the HTML document to their server at &lt;a href=&quot;http://rpubs.com/&quot;&gt;http://rpubs.com/&lt;/a&gt; so you can share it with anyone. Just hit the “Publish” in the preview window:&lt;/p&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/publish.png&quot; /&gt;
&lt;/div&gt;
&lt;p&gt;Like gists, documents at &lt;a href=&quot;http://rpubs.com/&quot;&gt;http://rpubs.com/&lt;/a&gt; can be updated and easily shared and accept comments.&lt;/p&gt;
&lt;p&gt;Git is also built into the Rstudio interface. Saving a version of your software is as easy as clicking a button. This makes the git learning curve a little easier:&lt;/p&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/gitexample.png&quot; /&gt;
&lt;/div&gt;
&lt;p&gt;Finally, the latest version of Rstudio has package creation tools based on the &lt;code&gt;devtools&lt;/code&gt; package, including tools for testing and documenting packages. Like its Git interface, RStudio’s package development tools make the process of package creation more intuitive:&lt;/p&gt;
&lt;div class=&quot;figure&quot;&gt;
&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/buildexample.png&quot; /&gt;
&lt;/div&gt;
&lt;h2 id=&quot;interactive-r-with-shiny&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Interactive R with Shiny&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;A relatively new and exciting way to use R to share data analysis is &lt;a href=&quot;http://www.rstudio.com/shiny/&quot;&gt;Shiny&lt;/a&gt;. Shiny is an R package that lets you create &lt;em&gt;interactive&lt;/em&gt; web pages that let users explore your data and analysis. Here’s an example. Click on it to go to the interactive version:&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.rstudio.com/shiny/&quot;&gt;&lt;img src=&quot;http://dl.dropbox.com/u/3356641/blogstuff/shinyexample.png&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;upcoming-tools-for-real-time-interactive-and-collaborative-programming&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Upcoming tools for real-time, interactive and collaborative programming&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In the next year or so we will likely see tools for live, interactive coding that allow you to collaborate in real time on R scripts the way Google Docs allows such collaboration with documents. &lt;a href=&quot;https://www.stypi.com&quot;&gt;https://www.stypi.com&lt;/a&gt; is one such tool, though it doesn’t have R-specific options yet. Yihui Xie, the creator of &lt;code&gt;knitr&lt;/code&gt; has created an &lt;a href=&quot;http://glimmer.rstudio.com/yihui/knitr/&quot;&gt;interactive notebook&lt;/a&gt; based on Shiny and &lt;code&gt;knitr&lt;/code&gt; which runs your knitr/R code on the web, but it is just a proof-of-concept. Look out for new developments!&lt;/p&gt;
&lt;h2 id=&quot;engaging-with-r-communities-online&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Engaging with R Communities Online&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;If you are looking for peers and collaborators in your work with R, there are a lot of places online to do so.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Listservs:&lt;/strong&gt;In addition the listservs mentioned above, there are many &lt;a href=&quot;http://www.r-project.org/mail.html&quot;&gt;specialty listservs&lt;/a&gt; for specific platforms and applications, and &lt;a href=&quot;http://blog.revolutionanalytics.com/local-r-groups.html&quot;&gt;local user groups&lt;/a&gt;. Many packages have listservs associated with them, too, where users can ask question and get information about the latest updates. If you are learning how to use a new package it’s helpful to sign up for these.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Blogs&lt;/strong&gt;: &lt;a href=&quot;r-bloggers.com&quot;&gt;R-bloggers&lt;/a&gt; is a great website that aggregates many blogs by people who use R. Blogs range from people writing &lt;em&gt;about&lt;/em&gt; R (e.g., tutorials), to people blogging &lt;em&gt;with&lt;/em&gt; R (e.g., &lt;code&gt;knitr&lt;/code&gt; documents of their latest analyses). Following the site feed will help you discover other people doing work similar to yours.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Twitter&lt;/strong&gt;: If you’re on twitter, the &lt;a href=&quot;https://twitter.com/search?q=%23rstats&quot;&gt;#rstats&lt;/a&gt; hashtag is commonly used to discuss R, and you can often get answers to short questions very quickly. Many of developers of R packages and software are on twitter, so you can get information straight from the source.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Code Hosting Sites&lt;/strong&gt;: Many R package developers host their projects on websites like &lt;a href=&quot;https://github.com/languages/R&quot;&gt;Github&lt;/a&gt; and &lt;a href=&quot;http://r-forge.r-project.org/&quot;&gt;R-forge&lt;/a&gt;. These sites have mechanisms for users to report bugs, make feature requests, and often find more information than is available in the documentation of a specific package. You can often find the site used by a developer by looking at it’s entry on &lt;a href=&quot;http://cran.r-project.org/web/packages/available_packages_by_name.html&quot;&gt;CRAN&lt;/a&gt; or the package revewing site &lt;a href=&quot;http://crantastic.org/&quot;&gt;crantastic&lt;/a&gt;.&lt;/p&gt;</content>
 </entry>
 
 <entry>
   <title>Quals Reading: Sudden Oak Death</title>
   <link href="http://www.noamross.net/blog/2013/1/7/sod-readings.html"/>
   <updated>2013-01-07T00:07:16-08:00</updated>
   <id>hhttp://www.noamross.net/blog/2013/1/7/sod-readings</id>
   <content type="html">&lt;head&gt;
  &lt;style type=&quot;text/css&quot;  media=&quot;all&quot;&gt;
    table tbody {border-top:2px; border-bottom:2px;}
    table thead {border-bottom:1px;}
  &lt;/style&gt;
&lt;/head&gt; &lt;p&gt;My study system is Sudden Oak Death (SOD) in California Forests, so my examiner [David Rizzo] has given me plenty of readings on the subject.&lt;/p&gt;
&lt;p&gt;There’s too much for a pithy summary here, but some highlights about the disease’s biology:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SOD is caused by &lt;em&gt;Phytophthora ramorum&lt;/em&gt;, a water mold in the same family as brown algae. It’s origin is unknown, but 3 lineages are known, two dominant in California and one in Europe. Each produces clonally; sexual reproduction appears pretty much nonfunctional, as each lineage has only one mating type. The original sexual population’s origin is unknown, and these lineages may be over 100,000 years old.&lt;/li&gt;
&lt;li&gt;SOD showed up in California in the 1980s or 1990s, originally in nursery stock, and has spread both through movement of nursery plants, and local spread by wind-blown rain and splash between trees. Now it ranges up and down the west coast.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Phytophthora ramorum&lt;/em&gt; infects many hosts. Some only in the leaves, some in the bark. The latter are mostly oaks, and it can kill these bark hosts, though it doesn’t spread from them. It doesn’t kill foliar hosts, but spreads from them, the most in Bay Laurel. Tanoak has the dubious distinction of being both a foliar and bark host, and is most threatened by the disease.&lt;/li&gt;
&lt;li&gt;Sporangia form in the leaves of foliar hosts in warm, wet conditions, then spread in water. The sporangia beget motile spores that can aggregate on a host and grow into the phloem, forming bleeding cankers and eventually weakening and killing the trees. &lt;em&gt;Phytophthora ramorum&lt;/em&gt; also produces chlamydospores that can live longer and travel longer distances.&lt;/li&gt;
&lt;li&gt;Individuals vary in susceptibility to the disease, but susceptibility is not correlated with tree health, and bigger trees are more vulnerable.&lt;/li&gt;
&lt;li&gt;Presence of Bay Laurel, and connectivity to other infected stands, are the biggest risk factor of the disease at the stand level.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;notes-on-readings&quot;&gt;Notes on Readings&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#swiecki2013&quot;&gt;Rizzo et al. (2005)&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#summary&quot;&gt;Summary&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#introduction&quot;&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#levels-and-complexity-of-management&quot;&gt;Levels and Complexity of Management&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#invaded-forests-of-california-and-oregon&quot;&gt;Invaded Forests of California and Oregon&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#pathogen-characterization&quot;&gt;Pathogen Characterization&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#p.-ramoroum-in-forests&quot;&gt;&lt;em&gt;P. Ramoroum&lt;/em&gt; in Forests&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#spatial-distribution&quot;&gt;Spatial Distribution&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#host-resistance&quot;&gt;Host Resistance&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#sporulation-and-survival-patterns&quot;&gt;Sporulation and Survival Patterns&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#determination-of-impacts&quot;&gt;Determination of Impacts&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#management-actions&quot;&gt;Management Actions&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#monitoring&quot;&gt;Monitoring&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#diagnosis&quot;&gt;Diagnosis&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#eradication&quot;&gt;Eradication&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#stand-manupulation&quot;&gt;Stand manupulation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#fire&quot;&gt;Fire&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#fungicides&quot;&gt;Fungicides&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#prevention-of-human-spread&quot;&gt;Prevention of Human Spread&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#restoration&quot;&gt;Restoration&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#conculusions&quot;&gt;Conculusions&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#ellis2010---spatial-pattern-and-connectivity&quot;&gt;Ellis et al. (2010) - Spatial Pattern and Connectivity&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#summary-1&quot;&gt;Summary&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#introduction-1&quot;&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#methods&quot;&gt;Methods&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#results&quot;&gt;Results&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#grunwald2012---emergence-of-sod&quot;&gt;Grünwald et al. (2012) - Emergence of SOD&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#summary-2&quot;&gt;Summary&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#biology&quot;&gt;Biology&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#repeated-emergence&quot;&gt;Repeated emergence&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#genetics&quot;&gt;Genetics&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#other-phytophthora-species&quot;&gt;Other &lt;em&gt;Phytophthora&lt;/em&gt; species&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#swiecki2013&quot;&gt;Swiecki and Bernhardt (2013)&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#sod-overview&quot;&gt;SOD Overview&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#biology-1&quot;&gt;Biology&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#life-cycle-in-forests&quot;&gt;Life Cycle in Forests&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#factors-influencing-sod-variability&quot;&gt;Factors influencing SOD variability&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#development-in-hosts&quot;&gt;Development in hosts&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#managing-stands&quot;&gt;Managing Stands&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#prioritiation&quot;&gt;Prioritiation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#technical-guidelines&quot;&gt;Technical Guidelines&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#reducing-disease-risk&quot;&gt;Reducing disease risk:&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#monitoring-diseased-stands&quot;&gt;Monitoring Diseased Stands&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#restoration-1&quot;&gt;Restoration&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;rizzo-et-al.-2005&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Rizzo et al. (2005)&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;summary&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Summary&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;SOD management occurs at many scales, but the stand/landscape scale is the most complex&lt;/li&gt;
&lt;li&gt;It occurs in a wide range of forests that include coast live oak and tanoak&lt;/li&gt;
&lt;li&gt;It has a mostly clonal population structure, with some differences between NA and Europe&lt;/li&gt;
&lt;li&gt;Bay Laurel presence, historic path of infection, and stand structure affect probability of disease&lt;/li&gt;
&lt;li&gt;Dispersal is wind driven, mostly from leaves of canopy trees. Occurs in rainy season&lt;/li&gt;
&lt;li&gt;Major mortality impacts on oak and tanoak, but variation in susceptibility at individual level&lt;/li&gt;
&lt;li&gt;Management span, monitoring, diagnosis, eradication, stand manipulation, fungicides, quarantine and restoration.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;introduction&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Introduction&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Sudden oak death first observed as causing bleeding stem cankers and death in tanoak and coast live oak in 1990s&lt;/li&gt;
&lt;li&gt;Found in N. America, Europe, hosts in 40+ genera, though mortality limited to &lt;em&gt;Fagaceae&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;levels-and-complexity-of-management&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Levels and Complexity of Management&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Tree, stand/landscaoe, and regional/international levels&lt;/li&gt;
&lt;li&gt;At individual level, focus is on chemical control, lowering inoculum pressure
&lt;ul&gt;
&lt;li&gt;Homeowners, arborists, urban-wildland interface and aesthetic/historic value&lt;/li&gt;
&lt;li&gt;Phosphate treatments (injection and spray) best if preventative&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Regional/international management aimed to prevent further spread
&lt;ul&gt;
&lt;li&gt;Quarantine on nursery industries&lt;/li&gt;
&lt;li&gt;Wide host range makes difficult&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Stand/landscape mgmt most difficult
&lt;ul&gt;
&lt;li&gt;Previous atttempts removing host material in in chestnut blight, white pine blister rust, dutch elm, &lt;em&gt;Phytophthori cinnamomi&lt;/em&gt; and &lt;em&gt;P. lateralis&lt;/em&gt;. Results mixed&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Decision-making is complex. SOD exists in highly varied socio-ecological landscape.&lt;/li&gt;
&lt;li&gt;Need to determine management goals in absence of SOD first. Timber is often not priority.&lt;/li&gt;
&lt;li&gt;Prevention, treatment, restoration, and convervation must be integrated&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;invaded-forests-of-california-and-oregon&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Invaded Forests of California and Oregon&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;SOD found in forests that include oak and tonoak as structural component:&lt;/li&gt;
&lt;li&gt;With and without Douglas-fir&lt;/li&gt;
&lt;li&gt;Many evergreen broad-leaved sclerophyllus (thick-leaved) trees and shrubs&lt;/li&gt;
&lt;li&gt;Hardwood associates include Bay Laurel, Pacific madrone, bigleaf maple&lt;/li&gt;
&lt;li&gt;Often in redwood forests with shrubs like rhododendron, huckleberry&lt;/li&gt;
&lt;li&gt;Fire and logging affect forest structure. Tanoak and Coast live oak sprout from roots following logging/fire, are often overtopped in later succession. Horizonal structure is often very fine-scaled.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;pathogen-characterization&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Pathogen Characterization&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Geographic origin unknown, exotic to Europe and N. America&lt;/li&gt;
&lt;li&gt;Monophyletic group, with distinct European and American clades
&lt;ul&gt;
&lt;li&gt;N. American versions seem to be primarily one clonal lineage, European many closly related types&lt;/li&gt;
&lt;li&gt;Some evidence of continued exchange between European and American (A1 and A2) populations&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Not sexually generated pop. genetic structure - mostly mutation and mitotic recombination&lt;/li&gt;
&lt;li&gt;High variation in virulence, both between and within genotypes, indicating plasticity. Virulence level correlated across hosts. Most virulent populations are A2 isolates from wild&lt;/li&gt;
&lt;li&gt;Variation in resistnace to fungicides. European strains developing resistance to Metalaxyl, common in nursery settings&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;p.-ramoroum-in-forests&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;&lt;em&gt;P. Ramoroum&lt;/em&gt; in Forests&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id=&quot;spatial-distribution&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Spatial Distribution&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Found from Big Sur to Curry County, OR. Mostly within 30km of coast or SF Bay.&lt;/li&gt;
&lt;li&gt;Patchy at many scales. Similarity of sites with different diease status suggest historical rather than environmental driver of patchiness.&lt;/li&gt;
&lt;li&gt;Bay laurel the greatest predictor of disease across forests, esp. in mixed-evergreen forest dominated by coast live oak.&lt;/li&gt;
&lt;li&gt;Foliar hosts (e.g. Bay Laurel) precede oak bark infection, but not in tanoak forests, where tanoak twigs/eaves can be infected. Little Bay Laurel in OR infected forests.&lt;/li&gt;
&lt;li&gt;Density, slope, etc. not good predictors of disease. Canopy exposure, edge effects more important. Positive disease association with water status, tree drought stress not important.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;host-resistance&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Host Resistance&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Trees display variation in susceptibility at individal level at all aptial scales.&lt;/li&gt;
&lt;li&gt;More population-level patterns in Bay Laurel than oak species&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;sporulation-and-survival-patterns&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Sporulation and Survival Patterns&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Sporangia produced on leaves (and small twigs on Tanoak) following rainfall. No sporulation directly from bleeding cankers.&lt;/li&gt;
&lt;li&gt;Sporulation/infection restricted to rainy season in Mediterranean climates. Temp/moisture relationships complex. Sporulation commencement relative to start of rainy season varies across forests, perhaps due to level of dessication in dry months. Significant inter-annual variation.&lt;/li&gt;
&lt;li&gt;Propugules travel ~10-20m from infected tree, depending on height. More infection of oaks in less-dense stands, possibly due to lower wind speed.&lt;/li&gt;
&lt;li&gt;No evidence of lateral spread in understory&lt;/li&gt;
&lt;li&gt;Dispersal is long-tailed, sugesting occaisional long-distance dispersal&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;determination-of-impacts&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Determination of Impacts&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Doubles mortality of Coast Live Oak, quadruples tanoak.&lt;/li&gt;
&lt;li&gt;Spreads very quickly within a stand&lt;/li&gt;
&lt;li&gt;Cascading ecological effects
&lt;ul&gt;
&lt;li&gt;Altered competition between plant species&lt;/li&gt;
&lt;li&gt;Syngergism with other fungal (decay) pathogens and wind-driven mortality.&lt;/li&gt;
&lt;li&gt;Increased woody debris, change in nutrient cycling&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;management-actions&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Management Actions&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;See Table 2 in paper for research finding-management actions links&lt;/p&gt;
&lt;h4 id=&quot;monitoring&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Monitoring&lt;/a&gt;&lt;/h4&gt;
&lt;h4 id=&quot;diagnosis&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Diagnosis&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Culture-based diagnosis dependent on environment, leads to false negatives&lt;/li&gt;
&lt;li&gt;Molecular assys better, but depends on part of plant tested&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;eradication&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Eradication&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Possible at early stages of invasion
&lt;ul&gt;
&lt;li&gt;Requires intensive survey, quaratine, cut, burning stump treatment&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Adaptive management to adjust buffer area, pre-emptive removal of hosts&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;stand-manupulation&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Stand manupulation&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Removal of infected plants&lt;/li&gt;
&lt;li&gt;Increasing interhost distance (but lower density may lead to more wind disperal)&lt;/li&gt;
&lt;li&gt;Pruning branches may lessen load without major ecological community effects&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;fire&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Fire&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Historical fire regimes in these forest highly variable and uncertain&lt;/li&gt;
&lt;li&gt;Both understory and stand-replacing fires may increase tanoak&lt;/li&gt;
&lt;li&gt;Smoke may kill foliar SOD&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;fungicides&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Fungicides&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Phosphites injected, or applied to bark and leaves are effective. Soil treatments not&lt;/li&gt;
&lt;li&gt;Large-scale treatment very expensive, difficult to target the patchy distribution of disease&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;prevention-of-human-spread&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Prevention of Human Spread&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Surveillance and quarantine of ornamental nursery stock&lt;/li&gt;
&lt;li&gt;Possibilities in soil, waste, stream water&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;restoration&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Restoration&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Possibility of introducing less-vulnerable tree variants&lt;/li&gt;
&lt;li&gt;Historic baseline often unknown&lt;/li&gt;
&lt;li&gt;Decadal restoration process&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;conculusions&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Conculusions&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Forests with hosts may be vulnerable in British Columbia, other parts of world. Actual risk depend on climate, species composition and forest structure&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;ellis-et-al.-2010---spatial-pattern-and-connectivity&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Ellis et al. (2010) - Spatial Pattern and Connectivity&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;summary-1&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Summary&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;SOD severity is best predicted by a combination of environmental (biotic/abiotic) variables and connectivity to other areas of disease. Connectivity is not based strictly on physical dispersal distance, but on the effective distance based on the difficulty of the disease moving through patches of different host density or presence.&lt;/p&gt;
&lt;p&gt;The effective dispersal distance calculation depends a lot on the scale of dispersal and the scale of examination here.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Personal note: You need a table to compare model structures and results. Text description is terrible&lt;/em&gt;&lt;/p&gt;
&lt;h3 id=&quot;introduction-1&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Introduction&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Three types of connectivity
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Structural&lt;/em&gt; - physical aspects of landscape&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Potential&lt;/em&gt; - landscape + dispersal ability&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Actual&lt;/em&gt; - empirically derivd=ed&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Key question: When is connectivity important in dynamics and when can it be ignored?
&lt;ul&gt;
&lt;li&gt;Can be evaluated by relative importance of environmental and connectivity variables&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Study tests relative importance of connectivity in determining spatial distribution of SOD
&lt;ul&gt;
&lt;li&gt;Also test whether results are sensitive to method of measurement&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Hypothesis 1&lt;/em&gt;: Potntial connectivity is important in determining spatial distribution of SOD&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Hypothesis 2&lt;/em&gt;: Connectivity is better characterized when it includes landscape structure&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Hypotesis 3&lt;/em&gt;: Connectivity and environmental variables equal in influence&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;methods&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Methods&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Data from 86 Plots in Sonoma County in 2005. Randonly established in host woodlands. Forest info and disease severity meaured in each. Map of land cover generated from aerial imagery.&lt;/li&gt;
&lt;li&gt;Compared models of spread though simple Euclidean distance to effective distance (least-cost path based on friction assigned to each land cover type)&lt;/li&gt;
&lt;li&gt;Model structure was&lt;br /&gt; &lt;em&gt;Y&lt;/em&gt;&lt;sub&gt;&lt;em&gt;i&lt;/em&gt;&lt;/sub&gt; = &lt;em&gt;β&lt;/em&gt;&lt;sub&gt;0&lt;/sub&gt; + ∑ &lt;em&gt;β&lt;/em&gt;&lt;sub&gt;&lt;em&gt;j&lt;/em&gt;&lt;/sub&gt;&lt;em&gt;X&lt;/em&gt;&lt;sub&gt;&lt;em&gt;j&lt;/em&gt;&lt;/sub&gt; + &lt;em&gt;β&lt;/em&gt;&lt;sub&gt;9&lt;/sub&gt;&lt;em&gt;λ&lt;/em&gt;&lt;sub&gt;&lt;em&gt;i&lt;/em&gt;&lt;/sub&gt;&lt;br /&gt; Where &lt;em&gt;Y&lt;/em&gt;&lt;sub&gt;&lt;em&gt;i&lt;/em&gt;&lt;/sub&gt; was disease incidence (sympotomatic leaves/stem), &lt;em&gt;X&lt;/em&gt; are environmental variables and &lt;em&gt;λ&lt;/em&gt; is the spore burden based on a negative-expotential dispersal kernel from all other points, via Euclidean or effective distance, weighted by disease level at other sites.&lt;/li&gt;
&lt;li&gt;Environmental variables were canopy cover, precipitation, ave. daily hours at optimal temp and humidity for pathogen growth, potenital irraadiation, moisture index, bay laurel total DBH, total host DBH&lt;/li&gt;
&lt;li&gt;Friction was 1 for cells with hosts, tested varied scenarios for non-host cells&lt;/li&gt;
&lt;li&gt;Stepwise regression: First fit dispersal kernel for each friction scenario, then fit rest of model&lt;/li&gt;
&lt;li&gt;Determined best fit using 9 selection methods in SAS. Picked top models that were selected consistently and compared via BIC/AIC&lt;/li&gt;
&lt;li&gt;Calculated standardized regression coeffficients&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;results&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Results&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Models with both connectivity and environment peformed best&lt;/li&gt;
&lt;li&gt;Models with effective distance performed better than Euclidean&lt;/li&gt;
&lt;li&gt;Best fit models had connectivity of mid-level importance among environmental variables of varying importance&lt;/li&gt;
&lt;li&gt;Best fit model had mid-level friction values for non-host landscapes, indicating that non-host environments sometimes did carry disease&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;grünwald-et-al.-2012---emergence-of-sod&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Grünwald et al. (2012) - Emergence of SOD&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;summary-2&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Summary&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;P. ramorum&lt;/em&gt; is a water mold that causes SOD, has a wide host range, and spreads by wind-blown rain&lt;/li&gt;
&lt;li&gt;It’s population consists of three major clonal lineages, two in NA and one in Europe&lt;/li&gt;
&lt;li&gt;The lineages descended from a sexual population but sexual reproduction is effectively non-functional in them. The origin of the populations is unknown.&lt;/li&gt;
&lt;li&gt;Emergence of the disease is driven by novel host-pathogen combinations, rather than evolution of the pathogen. This pattern is common to &lt;em&gt;Phytophthora&lt;/em&gt; species. It is possible that &lt;em&gt;P. Ramorum&lt;/em&gt; may hybridize with other species.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;biology&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Biology&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;P. ramorum&lt;/em&gt; is a water mold, most closely related to brown algae (e.g. kelp) and diatoms&lt;/li&gt;
&lt;li&gt;Has both asexual and sexual phase. Asexual spores are chlamydospres (dormant, resistant to adverse conditions), and sporangia (can germinate or go motile)&lt;/li&gt;
&lt;li&gt;Sexual reproduction rare, mating types do not often interact&lt;/li&gt;
&lt;li&gt;Sporangia splash-disperse from leaves and twigs. Zoospores released from sporangia, then germinate and penetrate host. Rapid life cycling under good conditions. Many chlamydospres produced, too.&lt;/li&gt;
&lt;li&gt;Hosts in &amp;gt; 100 species, 40 genera&lt;/li&gt;
&lt;li&gt;Symptoms: necrotic foliar leisions, shhot dieback, or bleeding cankers on stem (discolored phloem and xylem, declining sap/hydraulic flow). Both sympoms in tanoak&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;repeated-emergence&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Repeated emergence&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Three clonal lineages, EU1, NA1, NA2, with all three present in N. America and only the first in Europe.&lt;/li&gt;
&lt;li&gt;NA1 introduced in nursery plants in Scotts Valley, CA, in late 20th century, probably had human-assisted dispersal to local wld forest. Spread through the nursery trade across the U.S.&lt;/li&gt;
&lt;li&gt;EU1 site of origin in Europe unclear, but found mostly in nurseries/gardens and in UK larch plantations. Later introduced to Pacific Northwest, reached CA.&lt;/li&gt;
&lt;li&gt;NA2 first found in BC or Washington, unknown source.&lt;/li&gt;
&lt;li&gt;Strains are diverging and evolving, but no evidence of selection&lt;/li&gt;
&lt;li&gt;Eradication unlikely&lt;/li&gt;
&lt;li&gt;Repeated emergence due to wide host range, favorable nursery environment&lt;/li&gt;
&lt;li&gt;Clonal lines likely descended from sexual population (have high heterozygosity), that co-evolved with hosts for a long time. Location unknown&lt;/li&gt;
&lt;li&gt;Mutations indicate that clonal lines are &amp;gt;100,000 yrs old. Clonal lines are poorly compatible, probably were separate before their introduction, come from separate source populations&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;genetics&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Genetics&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;All clonal lines are of one mating type (~gender), so no sexual production. A few of other mater type of EU1 found, but eradicated.&lt;/li&gt;
&lt;li&gt;No natural recombinants detected, artifically induced ones have reduced pathogenicity, reduced chromosome number, and reduced growth rates. This is consistent with &lt;em&gt;Phytophthora cinnamomi&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;other-phytophthora-species&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Other &lt;em&gt;Phytophthora&lt;/em&gt; species&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Other &lt;em&gt;Phytophthora&lt;/em&gt; species are pathogenic. Many more species have been discovered in recent years.&lt;/li&gt;
&lt;li&gt;Among pathogenic species, most are clonal lines with little diversity, suggesting introduction to new hosts is what causes disease emergence, rather than recombination&lt;/li&gt;
&lt;li&gt;However, species hybrids have been found and some have expanded host ranges.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;swiecki-and-bernhardt-2013&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Swiecki and Bernhardt (2013)&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;sod-overview&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;SOD Overview&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id=&quot;biology-1&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Biology&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Trunk canker hosts of SOD are oaks (&lt;em&gt;Quercus&lt;/em&gt;) species, and tanoak (&lt;em&gt;Nolithocarpus&lt;/em&gt;). White oaks have not been found infected in the field.&lt;/li&gt;
&lt;li&gt;Many more species are foliar hosts, which are not killed by SOD&lt;/li&gt;
&lt;li&gt;Foliar hosts can have any combination of high or low suceptibility and high or low sporulation. Pacific madrone is susceptible but doesn’t produce many spores. Bay laurel is high in both.&lt;/li&gt;
&lt;li&gt;Zoospores, produced by sporangia, can swim and aggregate towards chemical released by hosts, staging mass hyphal attacks&lt;/li&gt;
&lt;li&gt;The EU1 strain is more aggressive than the NA strains&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;life-cycle-in-forests&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Life Cycle in Forests&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;More spores form in wetter conditions&lt;/li&gt;
&lt;li&gt;On tanoak, canopy infections moves down to the stem via rainwater flowing down the stem. Trees near California Bay are the first to develop cankers&lt;/li&gt;
&lt;li&gt;Other oaks may be infected by bay or tanoak, but are dead-end hosts&lt;/li&gt;
&lt;li&gt;On bay, forms dark leisions on downward-hanging leaf tips and edges, with yellowish border. Leaves turn yellow and typically drop in dry season. Few infected leaves remain for first rains of year, but repeated rains grow population.&lt;/li&gt;
&lt;li&gt;Lower trunks of canker hosts remain wet after rain, allowing infection&lt;/li&gt;
&lt;li&gt;Spread is influenced by relative height of bay and oaks, wind direction, oak canopy size (can intercept more spores), and screening by nonsusceptible species&lt;/li&gt;
&lt;li&gt;Non-bay foliar hosts do not increase risk of disease, except possibly climbing poison oak when bay is also present. This may be due to leaf shedding.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;factors-influencing-sod-variability&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Factors influencing SOD variability&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Climate&lt;/strong&gt;: 12 hours of warm, wet conditions needed for sporgangga formation. Similar conditions for infection. Thus, infction greatest in late spring rains, shady sites, lower canopy.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Hosts&lt;/strong&gt;: Species variability. Cankers form on trunks &amp;gt;10 cm diameter, more on larger trunks (SOD infects the bark, which is thicker). No effect of tree vigor.&lt;/li&gt;
&lt;li&gt;Genetic variation, but this may be a small factor.&lt;/li&gt;
&lt;li&gt;Transport mechanisms: Human, wind, watrcourses, possibly animals&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;development-in-hosts&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Development in hosts&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Infects the phloem tissue, mostly on lower trunk. Can reach vasular cambium, out xylem and sometimes spread vertically.&lt;/li&gt;
&lt;li&gt;Cankes appear as brownish leisons on inner bark. Appear similar to other &lt;em&gt;Phytophthora&lt;/em&gt; sp. leisons&lt;/li&gt;
&lt;li&gt;Cankers usually bleed thick, dark fluid in 6mo-2yr after infection. Bleeding can stop after time.&lt;/li&gt;
&lt;li&gt;Beetles and rot fungi infect late-stage hosts (~1 year after canker development. In tanoak, secondary disease may be first visible symptom.&lt;/li&gt;
&lt;li&gt;Decline may be sudden (due to girdling by cankers), but this follows at least 6 mo of ingection. Progressive decline may take years (8-11 in coast live oak), may die out or break due to weakness.&lt;/li&gt;
&lt;li&gt;Diagnosis is either circumstanial or requires molecular methods&lt;/li&gt;
&lt;li&gt;Stand-level develpment depends on time since disease arrival, weather, host arrangement. In favorable conidtions most susceptible trees can be killed in a few years.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;managing-stands&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Managing Stands&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Most SOD-susceptible CA forests not managed for timber, provide various ecosystem services&lt;/li&gt;
&lt;li&gt;Management plan is needed in many cases. Based on needs/wants and available resources, should include strategies/actions and monitoring/evaluation components.&lt;/li&gt;
&lt;li&gt;Plan varies between pre-, during-, and post-disease stages, which may be different over small distances.&lt;/li&gt;
&lt;li&gt;Key questions for &lt;em&gt;before&lt;/em&gt;: Is &lt;em&gt;Phytophthora ramorum&lt;/em&gt; present? How far away are infections? What are consequences/risks with introduction?&lt;/li&gt;
&lt;li&gt;Actions for &lt;em&gt;before&lt;/em&gt;: Exclusion, Bay Removal, Chemical control. Relative usefulness depends on risk and proximity of disease&lt;/li&gt;
&lt;li&gt;Key questions for &lt;em&gt;during&lt;/em&gt;: What is incidence of SOD? How to minimie infection, but also hazards associated with infected trees.&lt;/li&gt;
&lt;li&gt;Key questions for &lt;em&gt;after&lt;/em&gt;: How long will affected trees survive? What is their failure potential? What fuels have accumulated and how distributed? How to increase survival, reduce hazard (incl. from fire), and restore? What are restoration needs? What species are regenerating?&lt;/li&gt;
&lt;li&gt;Action for &lt;em&gt;after&lt;/em&gt;: Cut or leave? Actively manage gaps for invasives, fire.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;prioritiation&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Prioritiation&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Prioritization especially important in large forest tracts.&lt;/li&gt;
&lt;li&gt;Which, how, and whn to treat?&lt;/li&gt;
&lt;li&gt;Base on ease of treatment, disease risk, potential resource loss, and potential hazards&lt;/li&gt;
&lt;li&gt;Formal numeric ranking is one way to combine these assessments.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;technical-guidelines&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Technical Guidelines&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Exclusion: Avoid nursery stock near forests, do not move pruned host material, clean equipment/tools (spray disinfectant not effective). Wood may be burned, but drying also adequate.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;reducing-disease-risk&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Reducing disease risk:&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Exposed wood increases risk; limit pruning to early dry season&lt;/li&gt;
&lt;li&gt;When removing California Bay, consider the total loss of canopy that may occur with removal + mortality. Understory Bay most likely to acquire novel infection. If removing only some, create local bay clearings to protect high value oaks. Avoid rainy season. Ideally leave on ground if can be kept away from oak. Sprout regrowth may be repressed with herbicides. Cut climbing poison oak, too.&lt;/li&gt;
&lt;li&gt;Fungicides should be combined with Bay Removal, but best suited to high value trees. Phosphotases are effective, selective, and low-toxic to non targets. Best applied before infection. Stem injection and bark spray most effective, applied each 1-2 yrs 4-6 weeks before rainy season.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;monitoring-diseased-stands&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Monitoring Diseased Stands&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Annual monitoring for potential for stem failure recommended if fall hazard is source of concern. Additive risk factors in Tables 3-2 to 3-4.&lt;/li&gt;
&lt;li&gt;Oaks in various levels of disease and decay have varying contribution to fire risk&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;restoration-1&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Restoration&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Consider costs, long-term sustainability, nontarget effects&lt;/li&gt;
&lt;li&gt;Oaks may be replaced (or recruited) in stands where bay is removd&lt;/li&gt;
&lt;li&gt;Consider non-host replacement hardwoods [David Rizzo]: http://ucanr.edu/sites/rizzolab/&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Ellis, A. M., T. Václavík, and R. K. Meentemeyer. 2010. When is connectivity important? A case study of the spatial pattern of sudden oak death. Oikos 119:485–94.&lt;/p&gt;
&lt;p&gt;Grünwald, N. J., M. Garbelotto, E. M. Goss, K. Heungens, and S. Prospero. 2012. Emergence of the sudden oak death pathogen Phytophthora ramorum. Trends in microbiology 20:131–8.&lt;/p&gt;
&lt;p&gt;Rizzo, D. M., M. Garbelotto, and E. M. Hansen. 2005. Phytophthora ramorum: integrative research and management of an emerging pathogen in California and Oregon forests. Annual review of phytopathology 43:309–35.&lt;/p&gt;
&lt;p&gt;Swiecki, T. J., and E. A. Bernhardt. 2013. Managing sudden oak death in California: before, during, and after Phytophthora ramorum invasion. . U.S. Department of Agriculture; Forest Service; Pacific Southwest Research Station.&lt;/p&gt;</content>
 </entry>
 
 <entry>
   <title>Quals Reading: Modeling Philosophy</title>
   <link href="http://www.noamross.net/blog/2012/12/23/modeling-philosophy.html"/>
   <updated>2012-12-23T07:44:27-08:00</updated>
   <id>hhttp://www.noamross.net/blog/2012/12/23/modeling-philosophy</id>
   <content type="html">&lt;head&gt;
  &lt;style type=&quot;text/css&quot;  media=&quot;all&quot;&gt;
    table tbody {border-top:2px; border-bottom:2px;}
    table thead {border-bottom:1px;}
  &lt;/style&gt;
&lt;/head&gt; &lt;p&gt;My examiner on theoretical ecology, &lt;a href=&quot;http://www.des.ucdavis.edu/faculty/baskett/&quot;&gt;Marissa Baskett&lt;/a&gt;, suggested that I return to some basic literature on the &lt;em&gt;why&lt;/em&gt; of mathematical modeling in ecology. Here are notes on three papers:&lt;/p&gt;
&lt;h2 id=&quot;summary&quot;&gt;Summary&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Modeling &lt;em&gt;purpose&lt;/em&gt; must be clearly defined, as this determines whether to focus on generality, realisms, and/or precision&lt;/li&gt;
&lt;li&gt;Complexity is as often obfuscating as illuminating&lt;/li&gt;
&lt;li&gt;When prediction is a desired goal, separating calibration from validation is essential&lt;/li&gt;
&lt;li&gt;Must test robustness of models against different mathematical assumptions, structures, and parameters&lt;/li&gt;
&lt;li&gt;Many of these assumptions relate to the need to model at a simpler level than reality&lt;/li&gt;
&lt;li&gt;Disclosure, clarity, and reproducibility in publication are required to justify model use for prediction and policy&lt;/li&gt;
&lt;li&gt;Model precision is irrelevant if the model fails to address a question of relevance.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;notes-on-readings&quot;&gt;Notes on Readings&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#levins1966---modeling-strategies&quot;&gt;Levins (1966) - Modeling Strategies&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#summary-1&quot;&gt;Summary&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#strategies&quot;&gt;Strategies&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#robust-and-non-robust-theorems&quot;&gt;Robust and Non-robust Theorems&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#sufficient-parameters&quot;&gt;Sufficient parameters&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#clusters-of-models&quot;&gt;Clusters of models&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#aber1997---whydont-we-believe-the-models&quot;&gt;Aber (1997) - WhyDon’t We Believe the Models?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#may2004---uses-and-abuses-of-mathematics-in-biology&quot;&gt;May (2004) - Uses and Abuses of Mathematics in Biology&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#some-notes-on-my-approach&quot;&gt;Some Notes on My Approach&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#references&quot;&gt;References&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;levins-1966---modeling-strategies&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Levins (1966) - Modeling Strategies&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;summary-1&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Summary&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Need to sacrifice at least one of generality, realism, and precision in a model, usually choosing as a results of goals of prediction, inference, and management&lt;/li&gt;
&lt;li&gt;All models have hidden assumptions and testing different structures is neccessary to establish robustness of results&lt;/li&gt;
&lt;li&gt;Models are simplifications of many-parameter systems, which introduces precision through loss of information and unknown relations between the finer-scale processes&lt;/li&gt;
&lt;li&gt;Models are not hypotheses or theories. A theory is supported by a group of related models that cover different phenomena and approaches.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;strategies&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Strategies&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Population biology models complex systems, but truly accurate models of these process would have too many parameters, be intractable, computationally infeasible, and lack easily interpretable parameters&lt;/li&gt;
&lt;li&gt;One cannot maximize generality, realism, and precision simultaneously, as they aim towards different goals of understanding, prediction, and management. As such, three strategies:
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&lt;p&gt;Sacrifice generality, reducing parameters to those relevant for short-term prediction, solve numerically, and then test predictions in narrow situations. (e.g. fisheries models)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Sacrifice realism, expect many unrealistic assumptions will cancel each other out, and build in realism piece by piece to understand relevant complicatons (e.g., Lotka-Volterra)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Sacrifice precision. Focus on qualitative over quantitative and comparative results. Use abstract, general mathematical forms. (e.g. MacArthur and Levins)&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;li&gt;It’s important to remember which parts of the model are thought to be realistic, and which are not&lt;/li&gt;
&lt;li&gt;Test model robustness to changes in assumptions, keeping essential components&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;robust-and-non-robust-theorems&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Robust and Non-robust Theorems&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;The MacArthur and Levins (1962) paper on optimal fitness in heterogenous environments is an example of strategy 3.&lt;/li&gt;
&lt;li&gt;Three versions of the model have very different assumptions but arrive at similar results, contributing to its robustness.&lt;/li&gt;
&lt;li&gt;On the other hand, the proposition that increased rate of growth leads to lower populations size (as in the logistic and L-V models), is not robust to the addition of extraneous predation, or different growth and decline rates. Thus, it is non-robust&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;sufficient-parameters&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Sufficient parameters&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;The many parameters of a real system are generally abstracted to a few, but this does not mean that the underlying fine-grained parameters are independent or additive&lt;/li&gt;
&lt;li&gt;These may or may not have intuitive biological interpretations&lt;/li&gt;
&lt;li&gt;They may be formalizations of ecological concepts, such as measures of niche breadth, diversity, etc. These may not have “true” forms and should be tested for robustness&lt;/li&gt;
&lt;li&gt;They may represent variables found to be important in other studies&lt;/li&gt;
&lt;li&gt;The generalization of parameters leads to imprecision in three ways:
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;Omit factors with small or rare efects&lt;/li&gt;
&lt;li&gt;Are only qualitative because the exact form of functions is unknown&lt;/li&gt;
&lt;li&gt;Information is lost in generalization&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;clusters-of-models&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Clusters of models&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Models are not hypotheses, in that they are not verifiable or falsifiable in a meaningful way&lt;/li&gt;
&lt;li&gt;Models are limited in scope and complexity&lt;/li&gt;
&lt;li&gt;A satisfactory theory is a cluster of inter-related models&lt;/li&gt;
&lt;li&gt;Multiplicity of models is inevitable and primarily due to a conflict of methods and goals.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;aber-1997---whydont-we-believe-the-models&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Aber (1997) - WhyDon’t We Believe the Models?&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Modeling papers aren’t usually held to a set of standards, and as such are usually doubted. They should contain the following:&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;The structure of the model with both equations and a schematic, with a literature review justifying all the structure&lt;/li&gt;
&lt;li&gt;All parameters and their values, their method of selection.&lt;/li&gt;
&lt;li&gt;Even when the model is theoretical, empirically-justified parameters&lt;/li&gt;
&lt;li&gt;Validation against &lt;em&gt;independent&lt;/em&gt; data. This is distinct from calibration, and this must be clear.&lt;/li&gt;
&lt;li&gt;Sensitivity to parameters, as well as comparison to other (simpler, null) model structures. This justifies the complexity of the model&lt;/li&gt;
&lt;li&gt;Prediction (though this isn’t always the point)&lt;/li&gt;
&lt;li&gt;Calibration process is important because it reveals over-fitting&lt;/li&gt;
&lt;li&gt;&lt;p&gt;“Failed” models that do not validate well are useful in illuminating areas for future research&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;may-2004---uses-and-abuses-of-mathematics-in-biology&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;May (2004) - Uses and Abuses of Mathematics in Biology&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Mathematics plays different roles at different stages of the development of scientific knowledge. Statistical models are more common at observational stages, theoretical models at stages when patterns are being explained&lt;/li&gt;
&lt;li&gt;At the latter stages, theoretical models are meant to force clarity on thinking, and in many cases “less is more”. The relationship between inuitive understanding and the models should be preserved.&lt;/li&gt;
&lt;li&gt;Complex computer simulation may give us less understanding than analytical toy models. In the case of May’s work on HIV, a simple SIR model has outperformed a much more demographically detailed one.&lt;/li&gt;
&lt;li&gt;Confidence intervals and probibalistic values lend credence to results from aribitray assumptions/parameters, or ignore other important factors. In the case of Mad Cow disease, a model suggested banning T-bone stake because it could save a life, despite the fact that 100,000 cases would be due to other factors.&lt;/li&gt;
&lt;li&gt;Mathematical models in ecology only took off when authors such as Hutchison and MacArthur started asking testable, general questions in the line of physics, e.g., “How can similar species persist?”&lt;/li&gt;
&lt;li&gt;Most common, but difficult to idenity, abuses of mathematics “are situations where mathematical models are constructed with an excruciating abundance of detail in some aspects, whilst other important facets of the problem are misty or a vital parameter is uncertain”&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;some-notes-on-my-approach&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Some Notes on My Approach&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Interested in prediction and inference, but generality only as much as required for scenario-building.&lt;/li&gt;
&lt;li&gt;Best to mix model structure that improves prediction and allows for inference with non-parametric components (splines, S-maps)&lt;/li&gt;
&lt;li&gt;Choose structural components based on (a) inferential question, (b) management options, (c) data availability. e.g., include population structure when this is what managers can modify. Exclude genetic information because of inability to collect.&lt;/li&gt;
&lt;li&gt;Test nonparametric components against pure stochasticity&lt;/li&gt;
&lt;li&gt;Include observation as a model component&lt;/li&gt;
&lt;li&gt;Parse out sources of uncertainty when possible&lt;/li&gt;
&lt;li&gt;(More to come on this after reading the model selection literature provided by &lt;a href=&quot;http://www.plantsciences.ucdavis.edu/faculty/latimer/index.htm&quot;&gt;Andrew Latimer&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;references&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;References&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Aber, J. D. 1997. Why Don’t We Believe the Models?. Bulletin of the Ecological Society of America 78:232–233.&lt;/p&gt;
&lt;p&gt;Levins, R. 1966. The strategy of model building in population biology. American Scientist 54:421–431.&lt;/p&gt;
&lt;p&gt;May, R. M. 2004. Uses and abuses of mathematics in biology. Science 303:790–3.&lt;/p&gt;</content>
 </entry>
 
 <entry>
   <title>Quals Reading: Modeling Philosophy</title>
   <link href="http://www.noamross.net/blog/2012/12/23/modeling-philosophy.html"/>
   <updated>2012-12-23T07:44:27-08:00</updated>
   <id>hhttp://www.noamross.net/blog/2012/12/23/modeling-philosophy</id>
   <content type="html">&lt;head&gt;
  &lt;style type=&quot;text/css&quot;  media=&quot;all&quot;&gt;
    table tbody {border-top:2px; border-bottom:2px;}
    table thead {border-bottom:1px;}
  &lt;/style&gt;
&lt;/head&gt; &lt;p&gt;My examiner on theoretical ecology, &lt;a href=&quot;http://www.des.ucdavis.edu/faculty/baskett/&quot;&gt;Marissa Baskett&lt;/a&gt;, suggested that I return to some basic literature on the &lt;em&gt;why&lt;/em&gt; of mathematical modeling in ecology. Here are notes on three papers:&lt;/p&gt;
&lt;h2 id=&quot;summary&quot;&gt;Summary&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Modeling &lt;em&gt;purpose&lt;/em&gt; must be clearly defined, as this determines whether to focus on generality, realisms, and/or precision&lt;/li&gt;
&lt;li&gt;Complexity is as often obfuscating as illuminating&lt;/li&gt;
&lt;li&gt;When prediction is a desired goal, separating calibration from validation is essential&lt;/li&gt;
&lt;li&gt;Must test robustness of models against different mathematical assumptions, structures, and parameters&lt;/li&gt;
&lt;li&gt;Many of these assumptions relate to the need to model at a simpler level than reality&lt;/li&gt;
&lt;li&gt;Disclosure, clarity, and reproducibility in publication are required to justify model use for prediction and policy&lt;/li&gt;
&lt;li&gt;Model precision is irrelevant if the model fails to address a question of relevance.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;notes-on-readings&quot;&gt;Notes on Readings&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#levins1966---modeling-strategies&quot;&gt;Levins (1966) - Modeling Strategies&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#summary-1&quot;&gt;Summary&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#strategies&quot;&gt;Strategies&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#robust-and-non-robust-theorems&quot;&gt;Robust and Non-robust Theorems&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#sufficient-parameters&quot;&gt;Sufficient parameters&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#clusters-of-models&quot;&gt;Clusters of models&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#aber1997---whydont-we-believe-the-models&quot;&gt;Aber (1997) - WhyDon’t We Believe the Models?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#may2004---uses-and-abuses-of-mathematics-in-biology&quot;&gt;May (2004) - Uses and Abuses of Mathematics in Biology&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#some-notes-on-my-approach&quot;&gt;Some Notes on My Approach&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#references&quot;&gt;References&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;levins-1966---modeling-strategies&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Levins (1966) - Modeling Strategies&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;summary-1&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Summary&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Need to sacrifice at least one of generality, realism, and precision in a model, usually choosing as a results of goals of prediction, inference, and management&lt;/li&gt;
&lt;li&gt;All models have hidden assumptions and testing different structures is neccessary to establish robustness of results&lt;/li&gt;
&lt;li&gt;Models are simplifications of many-parameter systems, which introduces precision through loss of information and unknown relations between the finer-scale processes&lt;/li&gt;
&lt;li&gt;Models are not hypotheses or theories. A theory is supported by a group of related models that cover different phenomena and approaches.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;strategies&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Strategies&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Population biology models complex systems, but truly accurate models of these process would have too many parameters, be intractable, computationally infeasible, and lack easily interpretable parameters&lt;/li&gt;
&lt;li&gt;One cannot maximize generality, realism, and precision simultaneously, as they aim towards different goals of understanding, prediction, and management. As such, three strategies:
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;&lt;p&gt;Sacrifice generality, reducing parameters to those relevant for short-term prediction, solve numerically, and then test predictions in narrow situations. (e.g. fisheries models)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Sacrifice realism, expect many unrealistic assumptions will cancel each other out, and build in realism piece by piece to understand relevant complicatons (e.g., Lotka-Volterra)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Sacrifice precision. Focus on qualitative over quantitative and comparative results. Use abstract, general mathematical forms. (e.g. MacArthur and Levins)&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;li&gt;It’s important to remember which parts of the model are thought to be realistic, and which are not&lt;/li&gt;
&lt;li&gt;Test model robustness to changes in assumptions, keeping essential components&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;robust-and-non-robust-theorems&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Robust and Non-robust Theorems&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;The MacArthur and Levins (1962) paper on optimal fitness in heterogenous environments is an example of strategy 3.&lt;/li&gt;
&lt;li&gt;Three versions of the model have very different assumptions but arrive at similar results, contributing to its robustness.&lt;/li&gt;
&lt;li&gt;On the other hand, the proposition that increased rate of growth leads to lower populations size (as in the logistic and L-V models), is not robust to the addition of extraneous predation, or different growth and decline rates. Thus, it is non-robust&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;sufficient-parameters&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Sufficient parameters&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;The many parameters of a real system are generally abstracted to a few, but this does not mean that the underlying fine-grained parameters are independent or additive&lt;/li&gt;
&lt;li&gt;These may or may not have intuitive biological interpretations&lt;/li&gt;
&lt;li&gt;They may be formalizations of ecological concepts, such as measures of niche breadth, diversity, etc. These may not have “true” forms and should be tested for robustness&lt;/li&gt;
&lt;li&gt;They may represent variables found to be important in other studies&lt;/li&gt;
&lt;li&gt;The generalization of parameters leads to imprecision in three ways:
&lt;ol style=&quot;list-style-type: decimal&quot;&gt;
&lt;li&gt;Omit factors with small or rare efects&lt;/li&gt;
&lt;li&gt;Are only qualitative because the exact form of functions is unknown&lt;/li&gt;
&lt;li&gt;Information is lost in generalization&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;clusters-of-models&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Clusters of models&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Models are not hypotheses, in that they are not verifiable or falsifiable in a meaningful way&lt;/li&gt;
&lt;li&gt;Models are limited in scope and complexity&lt;/li&gt;
&lt;li&gt;A satisfactory theory is a cluster of inter-related models&lt;/li&gt;
&lt;li&gt;Multiplicity of models is inevitable and primarily due to a conflict of methods and goals.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;aber-1997---whydont-we-believe-the-models&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Aber (1997) - WhyDon’t We Believe the Models?&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Modeling papers aren’t usually held to a set of standards, and as such are usually doubted. They should contain the following:&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;The structure of the model with both equations and a schematic, with a literature review justifying all the structure&lt;/li&gt;
&lt;li&gt;All parameters and their values, their method of selection.&lt;/li&gt;
&lt;li&gt;Even when the model is theoretical, empirically-justified parameters&lt;/li&gt;
&lt;li&gt;Validation against &lt;em&gt;independent&lt;/em&gt; data. This is distinct from calibration, and this must be clear.&lt;/li&gt;
&lt;li&gt;Sensitivity to parameters, as well as comparison to other (simpler, null) model structures. This justifies the complexity of the model&lt;/li&gt;
&lt;li&gt;Prediction (though this isn’t always the point)&lt;/li&gt;
&lt;li&gt;Calibration process is important because it reveals over-fitting&lt;/li&gt;
&lt;li&gt;&lt;p&gt;“Failed” models that do not validate well are useful in illuminating areas for future research&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;may-2004---uses-and-abuses-of-mathematics-in-biology&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;May (2004) - Uses and Abuses of Mathematics in Biology&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Mathematics plays different roles at different stages of the development of scientific knowledge. Statistical models are more common at observational stages, theoretical models at stages when patterns are being explained&lt;/li&gt;
&lt;li&gt;At the latter stages, theoretical models are meant to force clarity on thinking, and in many cases “less is more”. The relationship between inuitive understanding and the models should be preserved.&lt;/li&gt;
&lt;li&gt;Complex computer simulation may give us less understanding than analytical toy models. In the case of May’s work on HIV, a simple SIR model has outperformed a much more demographically detailed one.&lt;/li&gt;
&lt;li&gt;Confidence intervals and probibalistic values lend credence to results from aribitray assumptions/parameters, or ignore other important factors. In the case of Mad Cow disease, a model suggested banning T-bone stake because it could save a life, despite the fact that 100,000 cases would be due to other factors.&lt;/li&gt;
&lt;li&gt;Mathematical models in ecology only took off when authors such as Hutchison and MacArthur started asking testable, general questions in the line of physics, e.g., “How can similar species persist?”&lt;/li&gt;
&lt;li&gt;Most common, but difficult to idenity, abuses of mathematics “are situations where mathematical models are constructed with an excruciating abundance of detail in some aspects, whilst other important facets of the problem are misty or a vital parameter is uncertain”&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;some-notes-on-my-approach&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;Some Notes on My Approach&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Interested in prediction and inference, but generality only as much as required for scenario-building.&lt;/li&gt;
&lt;li&gt;Best to mix model structure that improves prediction and allows for inference with non-parametric components (splines, S-maps)&lt;/li&gt;
&lt;li&gt;Choose structural components based on (a) inferential question, (b) management options, (c) data availability. e.g., include population structure when this is what managers can modify. Exclude genetic information because of inability to collect.&lt;/li&gt;
&lt;li&gt;Test nonparametric components against pure stochasticity&lt;/li&gt;
&lt;li&gt;Include observation as a model component&lt;/li&gt;
&lt;li&gt;Parse out sources of uncertainty when possible&lt;/li&gt;
&lt;li&gt;(More to come on this after reading the model selection literature provided by &lt;a href=&quot;http://www.plantsciences.ucdavis.edu/faculty/latimer/index.htm&quot;&gt;Andrew Latimer&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;references&quot;&gt;&lt;a href=&quot;#TOC&quot;&gt;References&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Aber, J. D. 1997. Why Don’t We Believe the Models?. Bulletin of the Ecological Society of America 78:232–233.&lt;/p&gt;
&lt;p&gt;Levins, R. 1966. The strategy of model building in population biology. American Scientist 54:421–431.&lt;/p&gt;
&lt;p&gt;May, R. M. 2004. Uses and abuses of mathematics in biology. Science 303:790–3.&lt;/p&gt;</content>
 </entry>
 
 
</feed>